<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>PrettyPrint</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            PrettyPrint 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/Users/fschumac/_rvm/src/ruby-1_9_3-p0/lib/prettyprint_rb.html">/Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>This class implements a pretty printing algorithm. It finds line breaks and
nice indentations for grouped structure.</p>

<p>By default, the class assumes that primitive elements are strings and each
byte in the strings have single column in width. But it can be used for
other situations by giving suitable arguments for some methods:</p>
<ul><li>
<p>newline object and space generation block for <a
href="PrettyPrint.html#method-c-new">::new</a></p>
</li><li>
<p>optional width argument for <a
href="PrettyPrint.html#method-i-text">#text</a></p>
</li><li>
<p><a href="PrettyPrint.html#method-i-breakable">#breakable</a></p>
</li></ul>

<p>There are several candidate uses:</p>
<ul><li>
<p>text formatting using proportional fonts</p>
</li><li>
<p>multibyte characters which has columns different to number of bytes</p>
</li><li>
<p>non-string formatting</p>
</li></ul>

<h2 id="label-Bugs">Bugs</h2>
<ul><li>
<p>Box based formatting?</p>
</li><li>
<p>Other (better) model/algorithm?</p>
</li></ul>

<h2 id="label-References">References</h2>

<p>Christian Lindig, Strictly Pretty, March 2000, <a
href="http://www.st.cs.uni-sb.de/~lindig/papers/#pretty">www.st.cs.uni-sb.de/~lindig/papers/#pretty</a></p>

<p>Philip Wadler, A prettier printer, March 1998, <a
href="http://homepages.inf.ed.ac.uk/wadler/topics/language-design.html#prettier">homepages.inf.ed.ac.uk/wadler/topics/language-design.html#prettier</a></p>

<h2 id="label-Author">Author</h2>

<p>Tanaka Akira &lt;akr@m17n.org&gt;</p>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">CLASS</span>
          <a href="PrettyPrint/Breakable.html">PrettyPrint::Breakable</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="PrettyPrint/Group.html">PrettyPrint::Group</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="PrettyPrint/GroupQueue.html">PrettyPrint::GroupQueue</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="PrettyPrint/SingleLine.html">PrettyPrint::SingleLine</a>
        </li>
      
        <li>
          <span class="type">CLASS</span>
          <a href="PrettyPrint/Text.html">PrettyPrint::Text</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-break_outmost_groups">break_outmost_groups</a>,
              </li>
            
              
              <li>
                <a href="#method-i-breakable">breakable</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-current_group">current_group</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-fill_breakable">fill_breakable</a>,
              </li>
            
              
              <li>
                <a href="#method-i-first-3F">first?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-flush">flush</a>,
              </li>
            
              
              <li>
                <a href="#method-c-format">format</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-group">group</a>,
              </li>
            
              
              <li>
                <a href="#method-i-group_sub">group_sub</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-nest">nest</a>,
              </li>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-singleline_format">singleline_format</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-text">text</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>genspace</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>group_queue</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>indent</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>maxwidth</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>newline</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>output</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-format">
            
              <a name="method-c-format"></a><b>format</b>(output='', maxwidth=79, newline=&quot;\n&quot;, genspace=lambda {|n| ' ' * n})
            
          </div>
          
          
            <div class="description">
              <p>This is a convenience method which is same as follows:</p>

<pre>begin
  q = PrettyPrint.new(output, maxwidth, newline, &amp;genspace)
  ...
  q.flush
  output
end</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-format_source')" id="l_method-c-format_source">show</a>
                
              </p>
              <div id="method-c-format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 41</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">PrettyPrint</span>.<span class="ruby-identifier">format</span>(<span class="ruby-identifier">output</span>=<span class="ruby-string">''</span>, <span class="ruby-identifier">maxwidth</span>=<span class="ruby-number">79</span>, <span class="ruby-identifier">newline</span>=<span class="ruby-string">&quot;\n&quot;</span>, <span class="ruby-identifier">genspace</span>=<span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-string">' '</span> * <span class="ruby-identifier">n</span>})
  <span class="ruby-identifier">q</span> = <span class="ruby-constant">PrettyPrint</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">output</span>, <span class="ruby-identifier">maxwidth</span>, <span class="ruby-identifier">newline</span>, &amp;<span class="ruby-identifier">genspace</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">q</span>
  <span class="ruby-identifier">q</span>.<span class="ruby-identifier">flush</span>
  <span class="ruby-identifier">output</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(output='', maxwidth=79, newline=&quot;\n&quot;, &amp;genspace)
            
          </div>
          
          
            <div class="description">
              <p>Creates a buffer for pretty printing.</p>

<p><code>output</code> is an output target. If it is not specified, ” is
assumed. It should have a &lt;&lt; method which accepts the first argument
<code>obj</code> of <a href="PrettyPrint.html#method-i-text">#text</a>, the
first argument <code>sep</code> of <a
href="PrettyPrint.html#method-i-breakable">#breakable</a>, the first
argument <code>newline</code> of <a
href="PrettyPrint.html#method-c-new">::new</a>, and the result of a given
block for <a href="PrettyPrint.html#method-c-new">::new</a>.</p>

<p><code>maxwidth</code> specifies maximum line length. If it is not
specified, 79 is assumed. However actual outputs may overflow
<code>maxwidth</code> if long non-breakable texts are provided.</p>

<p><code>newline</code> is used for line breaks. “n” is used if it is not
specified.</p>

<p>The block is used to generate spaces. {|width| ‘ ’ * width} is used if it
is not given.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>(<span class="ruby-identifier">output</span>=<span class="ruby-string">''</span>, <span class="ruby-identifier">maxwidth</span>=<span class="ruby-number">79</span>, <span class="ruby-identifier">newline</span>=<span class="ruby-string">&quot;\n&quot;</span>, &amp;<span class="ruby-identifier">genspace</span>)
  <span class="ruby-ivar">@output</span> = <span class="ruby-identifier">output</span>
  <span class="ruby-ivar">@maxwidth</span> = <span class="ruby-identifier">maxwidth</span>
  <span class="ruby-ivar">@newline</span> = <span class="ruby-identifier">newline</span>
  <span class="ruby-ivar">@genspace</span> = <span class="ruby-identifier">genspace</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-string">' '</span> * <span class="ruby-identifier">n</span>}

  <span class="ruby-ivar">@output_width</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@buffer_width</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@buffer</span> = []

  <span class="ruby-identifier">root_group</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">new</span>(<span class="ruby-number">0</span>)
  <span class="ruby-ivar">@group_stack</span> = [<span class="ruby-identifier">root_group</span>]
  <span class="ruby-ivar">@group_queue</span> = <span class="ruby-constant">GroupQueue</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">root_group</span>)
  <span class="ruby-ivar">@indent</span> = <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-singleline_format">
            
              <a name="method-c-singleline_format"></a><b>singleline_format</b>(output='', maxwidth=nil, newline=nil, genspace=nil)
            
          </div>
          
          
            <div class="description">
              <p>This is similar to <a href="PrettyPrint.html#method-c-format">::format</a>
but the result has no breaks.</p>

<p><code>maxwidth</code>, <code>newline</code> and <code>genspace</code> are
ignored.</p>

<p>The invocation of <code>breakable</code> in the block doesn’t break a line
and is treated as just an invocation of <code>text</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-singleline_format_source')" id="l_method-c-singleline_format_source">show</a>
                
              </p>
              <div id="method-c-singleline_format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">PrettyPrint</span>.<span class="ruby-identifier">singleline_format</span>(<span class="ruby-identifier">output</span>=<span class="ruby-string">''</span>, <span class="ruby-identifier">maxwidth</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">newline</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">genspace</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">q</span> = <span class="ruby-constant">SingleLine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">output</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">q</span>
  <span class="ruby-identifier">output</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-break_outmost_groups">
            
              <a name="method-i-break_outmost_groups"></a><b>break_outmost_groups</b>()
            
          </div>
          
          
            <div class="description">
              <p>Breaks the buffer into lines that are shorter than <a
href="PrettyPrint.html#attribute-i-maxwidth">maxwidth</a></p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-break_outmost_groups_source')" id="l_method-i-break_outmost_groups_source">show</a>
                
              </p>
              <div id="method-i-break_outmost_groups_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 124</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">break_outmost_groups</span>
  <span class="ruby-keyword">while</span> <span class="ruby-ivar">@maxwidth</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@output_width</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@buffer_width</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">group</span> = <span class="ruby-ivar">@group_queue</span>.<span class="ruby-identifier">deq</span>
    <span class="ruby-keyword">until</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">breakables</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">data</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">shift</span>
      <span class="ruby-ivar">@output_width</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">output</span>(<span class="ruby-ivar">@output</span>, <span class="ruby-ivar">@output_width</span>)
      <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">width</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">while</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Text</span> <span class="ruby-operator">===</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">first</span>
      <span class="ruby-identifier">text</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">shift</span>
      <span class="ruby-ivar">@output_width</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">output</span>(<span class="ruby-ivar">@output</span>, <span class="ruby-ivar">@output_width</span>)
      <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">width</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-breakable">
            
              <a name="method-i-breakable"></a><b>breakable</b>(sep=' ', width=sep.length)
            
          </div>
          
          
            <div class="description">
              <p>This says “you can break a line here if necessary”, and a
<code>width</code>-column text <code>sep</code> is inserted if a line is
not broken at the point.</p>

<p>If <code>sep</code> is not specified, “ ” is used.</p>

<p>If <code>width</code> is not specified, <code>sep.length</code> is used.
You will have to specify this when <code>sep</code> is a multibyte
character, for example.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-breakable_source')" id="l_method-i-breakable_source">show</a>
                
              </p>
              <div id="method-i-breakable_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 188</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">breakable</span>(<span class="ruby-identifier">sep</span>=<span class="ruby-string">' '</span>, <span class="ruby-identifier">width</span>=<span class="ruby-identifier">sep</span>.<span class="ruby-identifier">length</span>)
  <span class="ruby-identifier">group</span> = <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">last</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">break?</span>
    <span class="ruby-identifier">flush</span>
    <span class="ruby-ivar">@output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@newline</span>
    <span class="ruby-ivar">@output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@genspace</span>.<span class="ruby-identifier">call</span>(<span class="ruby-ivar">@indent</span>)
    <span class="ruby-ivar">@output_width</span> = <span class="ruby-ivar">@indent</span>
    <span class="ruby-ivar">@buffer_width</span> = <span class="ruby-number">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Breakable</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sep</span>, <span class="ruby-identifier">width</span>, <span class="ruby-keyword">self</span>)
    <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">width</span>
    <span class="ruby-identifier">break_outmost_groups</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-current_group">
            
              <a name="method-i-current_group"></a><b>current_group</b>()
            
          </div>
          
          
            <div class="description">
              <p>Returns the group most recently added to the stack.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-current_group_source')" id="l_method-i-current_group_source">show</a>
                
              </p>
              <div id="method-i-current_group_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">current_group</span>
  <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">last</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fill_breakable">
            
              <a name="method-i-fill_breakable"></a><b>fill_breakable</b>(sep=' ', width=sep.length)
            
          </div>
          
          
            <div class="description">
              <p>This is similar to <a
href="PrettyPrint.html#method-i-breakable">breakable</a> except the
decision to break or not is determined individually.</p>

<p>Two <a href="PrettyPrint.html#method-i-fill_breakable">fill_breakable</a>
under a group may cause 4 results: (break,break), (break,non-break),
(non-break,break), (non-break,non-break). This is different to <a
href="PrettyPrint.html#method-i-breakable">breakable</a> because two <a
href="PrettyPrint.html#method-i-breakable">breakable</a> under a group may
cause 2 results: (break,break), (non-break,non-break).</p>

<p>The text sep+ is inserted if a line is not broken at this point.</p>

<p>If <code>sep</code> is not specified, “ ” is used.</p>

<p>If <code>width</code> is not specified, <code>sep.length</code> is used.
You will have to specify this when <code>sep</code> is a multibyte
character, for example.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-fill_breakable_source')" id="l_method-i-fill_breakable_source">show</a>
                
              </p>
              <div id="method-i-fill_breakable_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 176</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">fill_breakable</span>(<span class="ruby-identifier">sep</span>=<span class="ruby-string">' '</span>, <span class="ruby-identifier">width</span>=<span class="ruby-identifier">sep</span>.<span class="ruby-identifier">length</span>)
  <span class="ruby-identifier">group</span> { <span class="ruby-identifier">breakable</span> <span class="ruby-identifier">sep</span>, <span class="ruby-identifier">width</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-first-3F">
            
              <a name="method-i-first-3F"></a><b>first?</b>()
            
          </div>
          
          
            <div class="description">
              <p>first? is a predicate to test the call is a first call to first? with
current group.</p>

<p>It is useful to format comma separated values as:</p>

<pre class="ruby"><span class="ruby-identifier">q</span>.<span class="ruby-identifier">group</span>(<span class="ruby-value">1</span>, <span class="ruby-string">'['</span>, <span class="ruby-string">']'</span>) {
  <span class="ruby-identifier">xxx</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">yyy</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">q</span>.<span class="ruby-identifier">first?</span>
      <span class="ruby-identifier">q</span>.<span class="ruby-identifier">text</span> <span class="ruby-string">','</span>
      <span class="ruby-identifier">q</span>.<span class="ruby-identifier">breakable</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-operator">...</span> <span class="ruby-identifier">pretty</span> <span class="ruby-identifier">printing</span> <span class="ruby-identifier">yyy</span> <span class="ruby-operator">...</span>
  }
}
</pre>

<p>first? is obsoleted in 1.8.2.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-first-3F_source')" id="l_method-i-first-3F_source">show</a>
                
              </p>
              <div id="method-i-first-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 118</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">first?</span>
  <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;PrettyPrint#first? is obsoleted at 1.8.2.&quot;</span>
  <span class="ruby-identifier">current_group</span>.<span class="ruby-identifier">first?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-flush">
            
              <a name="method-i-flush"></a><b>flush</b>()
            
          </div>
          
          
            <div class="description">
              <p>outputs buffered data.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-flush_source')" id="l_method-i-flush_source">show</a>
                
              </p>
              <div id="method-i-flush_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 251</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">flush</span>
  <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">data</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@output_width</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">output</span>(<span class="ruby-ivar">@output</span>, <span class="ruby-ivar">@output_width</span>)
  }
  <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-ivar">@buffer_width</span> = <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-group">
            
              <a name="method-i-group"></a><b>group</b>(indent=0, open_obj='', close_obj='', open_width=open_obj.length, close_width=close_obj.length)
            
          </div>
          
          
            <div class="description">
              <p>Groups line break hints added in the block. The line break hints are all to
be used or not.</p>

<p>If <code>indent</code> is specified, the method call is regarded as nested
by nest(indent) { … }.</p>

<p>If <code>open_obj</code> is specified, <code>text open_obj,
open_width</code> is called before grouping. If <code>close_obj</code> is
specified, <code>text close_obj, close_width</code> is called after
grouping.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-group_source')" id="l_method-i-group_source">show</a>
                
              </p>
              <div id="method-i-group_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 213</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">group</span>(<span class="ruby-identifier">indent</span>=<span class="ruby-number">0</span>, <span class="ruby-identifier">open_obj</span>=<span class="ruby-string">''</span>, <span class="ruby-identifier">close_obj</span>=<span class="ruby-string">''</span>, <span class="ruby-identifier">open_width</span>=<span class="ruby-identifier">open_obj</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">close_width</span>=<span class="ruby-identifier">close_obj</span>.<span class="ruby-identifier">length</span>)
  <span class="ruby-identifier">text</span> <span class="ruby-identifier">open_obj</span>, <span class="ruby-identifier">open_width</span>
  <span class="ruby-identifier">group_sub</span> {
    <span class="ruby-identifier">nest</span>(<span class="ruby-identifier">indent</span>) {
      <span class="ruby-keyword">yield</span>
    }
  }
  <span class="ruby-identifier">text</span> <span class="ruby-identifier">close_obj</span>, <span class="ruby-identifier">close_width</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-group_sub">
            
              <a name="method-i-group_sub"></a><b>group_sub</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-group_sub_source')" id="l_method-i-group_sub_source">show</a>
                
              </p>
              <div id="method-i-group_sub_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 223</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">group_sub</span>
  <span class="ruby-identifier">group</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">depth</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)
  <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">group</span>
  <span class="ruby-ivar">@group_queue</span>.<span class="ruby-identifier">enq</span> <span class="ruby-identifier">group</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">pop</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">breakables</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-ivar">@group_queue</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">group</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-nest">
            
              <a name="method-i-nest"></a><b>nest</b>(indent)
            
          </div>
          
          
            <div class="description">
              <p>Increases left margin after newline with <code>indent</code> for line
breaks added in the block.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-nest_source')" id="l_method-i-nest_source">show</a>
                
              </p>
              <div id="method-i-nest_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">nest</span>(<span class="ruby-identifier">indent</span>)
  <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">indent</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">indent</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-text">
            
              <a name="method-i-text"></a><b>text</b>(obj, width=obj.length)
            
          </div>
          
          
            <div class="description">
              <p>This adds <code>obj</code> as a text of <code>width</code> columns in
width.</p>

<p>If <code>width</code> is not specified, obj.length is used.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-text_source')" id="l_method-i-text_source">show</a>
                
              </p>
              <div id="method-i-text_source" class="dyn-source">
                <pre><span class="ruby-comment"># File /Users/fschumac/.rvm/src/ruby-1.9.3-p0/lib/prettyprint.rb, line 144</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">text</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">width</span>=<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">length</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-ivar">@output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>
    <span class="ruby-ivar">@output_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">width</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">text</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-constant">Text</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">text</span>
      <span class="ruby-identifier">text</span> = <span class="ruby-constant">Text</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">text</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">text</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">width</span>)
    <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">width</span>
    <span class="ruby-identifier">break_outmost_groups</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    