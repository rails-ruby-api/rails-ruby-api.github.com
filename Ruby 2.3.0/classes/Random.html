<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Random</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Random 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/lib/securerandom_rb.html">lib/securerandom.rb</a></li>
            
            <li><a href="../files/random_c.html">random.c</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p><a href="Random.html">Random</a> provides an interface to Ruby&#39;s
pseudo-random number generator, or PRNG.  The PRNG produces a deterministic
sequence of bits which approximate true randomness. The sequence may be
represented by integers, floats, or binary strings.</p>

<p>The generator may be initialized with either a system-generated or
user-supplied seed value by using <a
href="Random.html#method-c-srand">::srand</a>.</p>

<p>The class method <a href="Random.html#method-i-rand">#rand</a> provides the
base functionality of <a href="Kernel.html#method-i-rand">Kernel#rand</a>
along with better handling of floating point values. These are both
interfaces to Random::DEFAULT, the Ruby system PRNG.</p>

<p><a href="Random.html#method-c-new">::new</a> will create a new PRNG with a
state independent of Random::DEFAULT, allowing multiple generators with
different seed values or sequence positions to exist simultaneously. <a
href="Random.html">Random</a> objects can be marshaled, allowing sequences
to be saved and resumed.</p>

<p>PRNGs are currently implemented as a modified Mersenne Twister with a
period of 2**19937-1.</p>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">MODULE</span>
          <a href="Random/Formatter.html">Random::Formatter</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-3D-3D">==</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-bytes">bytes</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>,
              </li>
            
              
              <li>
                <a href="#method-c-new_seed">new_seed</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-rand">rand</a>,
              </li>
            
              
              <li>
                <a href="#method-c-rand">rand</a>,
              </li>
            
              
              <li>
                <a href="#method-c-raw_seed">raw_seed</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-seed">seed</a>,
              </li>
            
              
              <li>
                <a href="#method-c-srand">srand</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="Random/Formatter.html">
              Random::Formatter
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <b>Random.new(seed = Random.new_seed) &rarr; prng
</b>
            
            <a href="../classes/Random.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Creates a new PRNG using <code>seed</code> to set the initial state. If
<code>seed</code> is omitted, the generator is initialized with <a
href="Random.html#method-c-new_seed">::new_seed</a>.</p>

<p>See <a href="Random.html#method-c-srand">::srand</a> for more information
on the use of seed values.</p>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre>static VALUE
random_init(int argc, VALUE *argv, VALUE obj)
{
    VALUE vseed;
    rb_random_t *rnd = get_rnd(obj);

    if (argc == 0) {
        rb_check_frozen(obj);
        vseed = random_seed();
    }
    else {
        rb_scan_args(argc, argv, &quot;01&quot;, &amp;vseed);
        rb_check_copyable(obj, vseed);
    }
    rnd-&gt;seed = rand_init(&amp;rnd-&gt;mt, vseed);
    return obj;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-new_seed">
            
              <b>Random.new_seed &rarr; integer
</b>
            
            <a href="../classes/Random.html#method-c-new_seed" name="method-c-new_seed" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns an arbitrary seed value. This is used by <a
href="Random.html#method-c-new">::new</a> when no seed value is specified
as an argument.</p>

<pre><code>Random.new_seed  #=&gt; 115032730400174366788466674494640623225
</code></pre>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_seed_source')" id="l_method-c-new_seed_source">show</a>
                
              </p>
              <div id="method-c-new_seed_source" class="dyn-source">
                <pre>static VALUE
random_seed(void)
{
    uint32_t buf[DEFAULT_SEED_CNT];
    fill_random_seed(buf);
    return make_seed_value(buf);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-rand">
            
              <b>Random.rand &rarr; float
Random.rand(max) &rarr; number
</b>
            
            <a href="../classes/Random.html#method-c-rand" name="method-c-rand" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Alias of Random::DEFAULT.rand.</p>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-rand_source')" id="l_method-c-rand_source">show</a>
                
              </p>
              <div id="method-c-rand_source" class="dyn-source">
                <pre>static VALUE
random_s_rand(int argc, VALUE *argv, VALUE obj)
{
    VALUE v = rand_random(argc, argv, Qnil, rand_start(&amp;default_rand));
    check_random_number(v, argv);
    return v;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-raw_seed">
            
              <b>Random.raw_seed(size) &rarr; string
</b>
            
            <a href="../classes/Random.html#method-c-raw_seed" name="method-c-raw_seed" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns a raw seed string, using platform providing features.</p>

<pre><code>Random.raw_seed(8)  #=&gt; &quot;\x78\x41\xBA\xAF\x7D\xEA\xD8\xEA&quot;
</code></pre>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-raw_seed_source')" id="l_method-c-raw_seed_source">show</a>
                
              </p>
              <div id="method-c-raw_seed_source" class="dyn-source">
                <pre>static VALUE
random_raw_seed(VALUE self, VALUE size)
{
    long n = NUM2ULONG(size);
    VALUE buf = rb_str_new(0, n);
    if (n == 0) return buf;
    if (fill_random_bytes(RSTRING_PTR(buf), n, FALSE)) return Qnil;
    return buf;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-srand">
            
              <b>srand(number = Random.new_seed) &rarr; old_seed
</b>
            
            <a href="../classes/Random.html#method-c-srand" name="method-c-srand" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Seeds the system pseudo-random number generator, Random::DEFAULT, with
<code>number</code>.  The previous seed value is returned.</p>

<p>If <code>number</code> is omitted, seeds the generator using a source of
entropy provided by the operating system, if available (/dev/urandom on
Unix systems or the RSA cryptographic provider on Windows), which is then
combined with the time, the process id, and a sequence number.</p>

<p>srand may be used to ensure repeatable sequences of pseudo-random numbers
between different runs of the program. By setting the seed to a known
value, programs can be made deterministic during testing.</p>

<pre><code>srand 1234               # =&gt; 268519324636777531569100071560086917274
[ rand, rand ]           # =&gt; [0.1915194503788923, 0.6221087710398319]
[ rand(10), rand(1000) ] # =&gt; [4, 664]
srand 1234               # =&gt; 1234
[ rand, rand ]           # =&gt; [0.1915194503788923, 0.6221087710398319]
</code></pre>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-srand_source')" id="l_method-c-srand_source">show</a>
                
              </p>
              <div id="method-c-srand_source" class="dyn-source">
                <pre>static VALUE
rb_f_srand(int argc, VALUE *argv, VALUE obj)
{
    VALUE seed, old;
    rb_random_t *r = &amp;default_rand;

    if (argc == 0) {
        seed = random_seed();
    }
    else {
        rb_scan_args(argc, argv, &quot;01&quot;, &amp;seed);
    }
    old = r-&gt;seed;
    r-&gt;seed = rand_init(&amp;r-&gt;mt, seed);

    return old;
}</pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-3D-3D">
            
              <b>prng1 == prng2 &rarr; true or false
</b>
            
            <a href="../classes/Random.html#method-i-3D-3D" name="method-i-3D-3D" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns true if the two generators have the same internal state, otherwise
false.  Equivalent generators will return the same sequence of
pseudo-random numbers.  Two generators will generally have the same state
only if they were initialized with the same seed</p>

<pre><code>Random.new == Random.new             # =&gt; false
Random.new(1234) == Random.new(1234) # =&gt; true
</code></pre>

<p>and have the same invocation history.</p>

<pre><code>prng1 = Random.new(1234)
prng2 = Random.new(1234)
prng1 == prng2 # =&gt; true

prng1.rand     # =&gt; 0.1915194503788923
prng1 == prng2 # =&gt; false

prng2.rand     # =&gt; 0.1915194503788923
prng1 == prng2 # =&gt; true
</code></pre>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-3D-3D_source')" id="l_method-i-3D-3D_source">show</a>
                
              </p>
              <div id="method-i-3D-3D_source" class="dyn-source">
                <pre>static VALUE
random_equal(VALUE self, VALUE other)
{
    rb_random_t *r1, *r2;
    if (rb_obj_class(self) != rb_obj_class(other)) return Qfalse;
    r1 = get_rnd(self);
    r2 = get_rnd(other);
    if (!RTEST(rb_funcall2(r1-&gt;seed, rb_intern(&quot;==&quot;), 1, &amp;r2-&gt;seed))) return Qfalse;
    if (memcmp(r1-&gt;mt.state, r2-&gt;mt.state, sizeof(r1-&gt;mt.state))) return Qfalse;
    if ((r1-&gt;mt.next - r1-&gt;mt.state) != (r2-&gt;mt.next - r2-&gt;mt.state)) return Qfalse;
    if (r1-&gt;mt.left != r2-&gt;mt.left) return Qfalse;
    return Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-bytes">
            
              <b>prng.bytes(size) &rarr; a_string
</b>
            
            <a href="../classes/Random.html#method-i-bytes" name="method-i-bytes" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns a random binary string containing <code>size</code> bytes.</p>

<pre><code>random_string = Random.new.bytes(10) # =&gt; &quot;\xD7:R\xAB?\x83\xCE\xFAkO&quot;
random_string.size                   # =&gt; 10
</code></pre>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-bytes_source')" id="l_method-i-bytes_source">show</a>
                
              </p>
              <div id="method-i-bytes_source" class="dyn-source">
                <pre>static VALUE
random_bytes(VALUE obj, VALUE len)
{
    return genrand_bytes(get_rnd(obj), NUM2LONG(rb_to_int(len)));
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-rand">
            
              <b>prng.rand &rarr; float
prng.rand(max) &rarr; number
</b>
            
            <a href="../classes/Random.html#method-i-rand" name="method-i-rand" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>When <code>max</code> is an <a href="Integer.html">Integer</a>,
<code>rand</code> returns a random integer greater than or equal to zero
and less than <code>max</code>. Unlike <a
href="Kernel.html#method-i-rand">Kernel#rand</a>, when <code>max</code> is
a negative integer or zero, <code>rand</code> raises an <a
href="ArgumentError.html">ArgumentError</a>.</p>

<pre><code>prng = Random.new
prng.rand(100)       # =&gt; 42
</code></pre>

<p>When <code>max</code> is a <a href="Float.html">Float</a>,
<code>rand</code> returns a random floating point number between 0.0 and
<code>max</code>, including 0.0 and excluding <code>max</code>.</p>

<pre><code>prng.rand(1.5)       # =&gt; 1.4600282860034115
</code></pre>

<p>When <code>max</code> is a <a href="Range.html">Range</a>,
<code>rand</code> returns a random number where range.member?(number) ==
true.</p>

<pre><code>prng.rand(5..9)      # =&gt; one of [5, 6, 7, 8, 9]
prng.rand(5...9)     # =&gt; one of [5, 6, 7, 8]
prng.rand(5.0..9.0)  # =&gt; between 5.0 and 9.0, including 9.0
prng.rand(5.0...9.0) # =&gt; between 5.0 and 9.0, excluding 9.0
</code></pre>

<p>Both the beginning and ending values of the range must respond to subtract
(<code>-</code>) and add (<code>+</code>)methods, or rand will raise an <a
href="ArgumentError.html">ArgumentError</a>.</p>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-rand_source')" id="l_method-i-rand_source">show</a>
                
              </p>
              <div id="method-i-rand_source" class="dyn-source">
                <pre>static VALUE
random_rand(int argc, VALUE *argv, VALUE obj)
{
    VALUE v = rand_random(argc, argv, obj, get_rnd(obj));
    check_random_number(v, argv);
    return v;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-seed">
            
              <b>prng.seed &rarr; integer
</b>
            
            <a href="../classes/Random.html#method-i-seed" name="method-i-seed" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Returns the seed value used to initialize the generator. This may be used
to initialize another generator with the same state at a later time,
causing it to produce the same sequence of numbers.</p>

<pre><code>prng1 = Random.new(1234)
prng1.seed       #=&gt; 1234
prng1.rand(100)  #=&gt; 47

prng2 = Random.new(prng1.seed)
prng2.rand(100)  #=&gt; 47
</code></pre>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-seed_source')" id="l_method-i-seed_source">show</a>
                
              </p>
              <div id="method-i-seed_source" class="dyn-source">
                <pre>static VALUE
random_get_seed(VALUE obj)
{
    return get_rnd(obj)-&gt;seed;
}</pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    