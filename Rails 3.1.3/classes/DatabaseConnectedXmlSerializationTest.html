<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>DatabaseConnectedXmlSerializationTest</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            DatabaseConnectedXmlSerializationTest 
            
                <span class="parent">&lt; 
                    
                    ActiveRecord::TestCase
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/activerecord/test/cases/xml_serialization_test_rb.html">activerecord/test/cases/xml_serialization_test.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-test_dual_arity_procs_are_called_on_object">test_dual_arity_procs_are_called_on_object</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_include_uses_association_name">test_include_uses_association_name</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_included_associations_should_skip_types">test_included_associations_should_skip_types</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_methods_are_called_on_object">test_methods_are_called_on_object</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_modules">test_modules</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_passing_hash_shouldnt_reuse_builder">test_passing_hash_shouldnt_reuse_builder</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_procs_are_called_on_object">test_procs_are_called_on_object</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_procs_on_included_associations_are_called">test_procs_on_included_associations_are_called</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value">test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_should_include_empty_has_many_as_empty_array">test_should_include_empty_has_many_as_empty_array</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_should_not_call_methods_on_associations_that_dont_respond">test_should_not_call_methods_on_associations_that_dont_respond</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_should_produce_xml_for_methods_returning_array">test_should_produce_xml_for_methods_returning_array</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_should_support_aliased_attributes">test_should_support_aliased_attributes</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_top_level_procs_arent_applied_to_associations">test_top_level_procs_arent_applied_to_associations</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
        
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-test_dual_arity_procs_are_called_on_object">
            
              <a name="method-i-test_dual_arity_procs_are_called_on_object"></a><b>test_dual_arity_procs_are_called_on_object</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_dual_arity_procs_are_called_on_object_source')" id="l_method-i-test_dual_arity_procs_are_called_on_object_source">show</a>
                
              </p>
              <div id="method-i-test_dual_arity_procs_are_called_on_object_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 205</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_dual_arity_procs_are_called_on_object</span>
  <span class="ruby-identifier">proc</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">options</span>, <span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:builder</span>].<span class="ruby-identifier">tag!</span>(<span class="ruby-string">'name-reverse'</span>, <span class="ruby-identifier">record</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">reverse</span>) }
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span>(<span class="ruby-value">:procs</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-identifier">proc</span> ])
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;name-reverse&gt;divaD&lt;/name-reverse&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_include_uses_association_name">
            
              <a name="method-i-test_include_uses_association_name"></a><b>test_include_uses_association_name</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_include_uses_association_name_source')" id="l_method-i-test_include_uses_association_name_source">show</a>
                
              </p>
              <div id="method-i-test_include_uses_association_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 173</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_include_uses_association_name</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span> <span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:hello_posts</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;hello-posts type=&quot;array&quot;&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;hello-post type=&quot;Post&quot;&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;hello-post type=&quot;StiPost&quot;&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_included_associations_should_skip_types">
            
              <a name="method-i-test_included_associations_should_skip_types"></a><b>test_included_associations_should_skip_types</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_included_associations_should_skip_types_source')" id="l_method-i-test_included_associations_should_skip_types_source">show</a>
                
              </p>
              <div id="method-i-test_included_associations_should_skip_types_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 180</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_included_associations_should_skip_types</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span> <span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:hello_posts</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>, <span class="ruby-value">:skip_types</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;hello-posts&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;hello-post&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;hello-post&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_methods_are_called_on_object">
            
              <a name="method-i-test_methods_are_called_on_object"></a><b>test_methods_are_called_on_object</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_methods_are_called_on_object_source')" id="l_method-i-test_methods_are_called_on_object_source">show</a>
                
              </p>
              <div id="method-i-test_methods_are_called_on_object_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_methods_are_called_on_object</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span> <span class="ruby-value">:methods</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:label</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;label&gt;.*&lt;/label&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_modules">
            
              <a name="method-i-test_modules"></a><b>test_modules</b>()
            
          </div>
          
          
            <div class="description">
              <p>to_xml used to mess with the hash the user provided which caused the
builder to be reused.  This meant the document kept getting appended to.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_modules_source')" id="l_method-i-test_modules_source">show</a>
                
              </p>
              <div id="method-i-test_modules_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 157</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_modules</span>
  <span class="ruby-identifier">projects</span> = <span class="ruby-constant">MyApplication</span><span class="ruby-operator">::</span><span class="ruby-constant">Business</span><span class="ruby-operator">::</span><span class="ruby-constant">Project</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">projects</span>.<span class="ruby-identifier">to_xml</span>
  <span class="ruby-identifier">root</span> = <span class="ruby-identifier">projects</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">underscore</span>.<span class="ruby-identifier">pluralize</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-string">'/'</span>,<span class="ruby-string">'_'</span>).<span class="ruby-identifier">dasherize</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-node">&quot;&lt;#{root} type=\&quot;array\&quot;&gt;&quot;</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-node">&quot;&lt;/#{root}&gt;&quot;</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_passing_hash_shouldnt_reuse_builder">
            
              <a name="method-i-test_passing_hash_shouldnt_reuse_builder"></a><b>test_passing_hash_shouldnt_reuse_builder</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_passing_hash_shouldnt_reuse_builder_source')" id="l_method-i-test_passing_hash_shouldnt_reuse_builder_source">show</a>
                
              </p>
              <div id="method-i-test_passing_hash_shouldnt_reuse_builder_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_passing_hash_shouldnt_reuse_builder</span>
  <span class="ruby-identifier">options</span> = {<span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:posts</span>}
  <span class="ruby-identifier">david</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>)
  <span class="ruby-identifier">first_xml_size</span> = <span class="ruby-identifier">david</span>.<span class="ruby-identifier">to_xml</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">second_xml_size</span> = <span class="ruby-identifier">david</span>.<span class="ruby-identifier">to_xml</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">first_xml_size</span>, <span class="ruby-identifier">second_xml_size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_procs_are_called_on_object">
            
              <a name="method-i-test_procs_are_called_on_object"></a><b>test_procs_are_called_on_object</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_procs_are_called_on_object_source')" id="l_method-i-test_procs_are_called_on_object_source">show</a>
                
              </p>
              <div id="method-i-test_procs_are_called_on_object_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 199</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_procs_are_called_on_object</span>
  <span class="ruby-identifier">proc</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">options</span><span class="ruby-operator">|</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:builder</span>].<span class="ruby-identifier">tag!</span>(<span class="ruby-string">'nationality'</span>, <span class="ruby-string">'Danish'</span>) }
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span>(<span class="ruby-value">:procs</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-identifier">proc</span> ])
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{&lt;nationality&gt;Danish&lt;/nationality&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_procs_on_included_associations_are_called">
            
              <a name="method-i-test_procs_on_included_associations_are_called"></a><b>test_procs_on_included_associations_are_called</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_procs_on_included_associations_are_called_source')" id="l_method-i-test_procs_on_included_associations_are_called_source">show</a>
                
              </p>
              <div id="method-i-test_procs_on_included_associations_are_called_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 219</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_procs_on_included_associations_are_called</span>
  <span class="ruby-identifier">posts_proc</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">options</span><span class="ruby-operator">|</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:builder</span>].<span class="ruby-identifier">tag!</span>(<span class="ruby-string">'copyright'</span>, <span class="ruby-string">'DHH'</span>) }
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span>(
    <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>,
    <span class="ruby-value">:include</span> =<span class="ruby-operator">&gt;</span> {
      <span class="ruby-value">:posts</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-value">:procs</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-identifier">posts_proc</span> ] }
    }
  )

  <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp">%r{^  &lt;copyright&gt;DHH&lt;/copyright&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^ {6}&lt;copyright&gt;DHH&lt;/copyright&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value">
            
              <a name="method-i-test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value"></a><b>test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value_source')" id="l_method-i-test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value_source">show</a>
                
              </p>
              <div id="method-i-test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_should_has_many_array_elements_should_include_type_when_different_from_guessed_value</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span> <span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:posts_with_comments</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">from_xml</span>(<span class="ruby-identifier">xml</span>)
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^  &lt;posts-with-comments type=&quot;array&quot;&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^    &lt;posts-with-comment type=&quot;Post&quot;&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^    &lt;posts-with-comment type=&quot;StiPost&quot;&gt;}</span>, <span class="ruby-identifier">xml</span>

  <span class="ruby-identifier">types</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">from_xml</span>(<span class="ruby-identifier">xml</span>)[<span class="ruby-string">'author'</span>][<span class="ruby-string">'posts_with_comments'</span>].<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>[<span class="ruby-string">'type'</span>] }
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">types</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'SpecialPost'</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">types</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'Post'</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">types</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'StiPost'</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_should_include_empty_has_many_as_empty_array">
            
              <a name="method-i-test_should_include_empty_has_many_as_empty_array"></a><b>test_should_include_empty_has_many_as_empty_array</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_should_include_empty_has_many_as_empty_array_source')" id="l_method-i-test_should_include_empty_has_many_as_empty_array_source">show</a>
                
              </p>
              <div id="method-i-test_should_include_empty_has_many_as_empty_array_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 232</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_should_include_empty_has_many_as_empty_array</span>
  <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">delete_all</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span> <span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:posts</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>

  <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">from_xml</span>(<span class="ruby-identifier">xml</span>)[<span class="ruby-string">'author'</span>][<span class="ruby-string">'posts'</span>]
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^  &lt;posts type=&quot;array&quot;/&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_should_not_call_methods_on_associations_that_dont_respond">
            
              <a name="method-i-test_should_not_call_methods_on_associations_that_dont_respond"></a><b>test_should_not_call_methods_on_associations_that_dont_respond</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_should_not_call_methods_on_associations_that_dont_respond_source')" id="l_method-i-test_should_not_call_methods_on_associations_that_dont_respond_source">show</a>
                
              </p>
              <div id="method-i-test_should_not_call_methods_on_associations_that_dont_respond_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 192</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_should_not_call_methods_on_associations_that_dont_respond</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span> <span class="ruby-value">:include=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">:hello_posts</span>, <span class="ruby-value">:methods</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:label</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">hello_posts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:label</span>)
  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^  &lt;label&gt;.*&lt;/label&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp">%r{^      &lt;label&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_should_produce_xml_for_methods_returning_array">
            
              <a name="method-i-test_should_produce_xml_for_methods_returning_array"></a><b>test_should_produce_xml_for_methods_returning_array</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_should_produce_xml_for_methods_returning_array_source')" id="l_method-i-test_should_produce_xml_for_methods_returning_array_source">show</a>
                
              </p>
              <div id="method-i-test_should_produce_xml_for_methods_returning_array_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_should_produce_xml_for_methods_returning_array</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span>(<span class="ruby-value">:methods</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:social</span>)
  <span class="ruby-identifier">array</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">from_xml</span>(<span class="ruby-identifier">xml</span>)[<span class="ruby-string">'author'</span>][<span class="ruby-string">'social'</span>]
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">array</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">include?</span> <span class="ruby-string">'twitter'</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">include?</span> <span class="ruby-string">'github'</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_should_support_aliased_attributes">
            
              <a name="method-i-test_should_support_aliased_attributes"></a><b>test_should_support_aliased_attributes</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_should_support_aliased_attributes_source')" id="l_method-i-test_should_support_aliased_attributes_source">show</a>
                
              </p>
              <div id="method-i-test_should_support_aliased_attributes_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 262</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_should_support_aliased_attributes</span>
  <span class="ruby-identifier">xml</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">select</span>(<span class="ruby-string">&quot;name as firstname&quot;</span>).<span class="ruby-identifier">to_xml</span>
  <span class="ruby-identifier">array</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">from_xml</span>(<span class="ruby-identifier">xml</span>)[<span class="ruby-string">'authors'</span>]
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">size</span>, <span class="ruby-identifier">array</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">author</span><span class="ruby-operator">|</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">has_key?</span> <span class="ruby-string">'firstname'</span> }.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_top_level_procs_arent_applied_to_associations">
            
              <a name="method-i-test_top_level_procs_arent_applied_to_associations"></a><b>test_top_level_procs_arent_applied_to_associations</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_top_level_procs_arent_applied_to_associations_source')" id="l_method-i-test_top_level_procs_arent_applied_to_associations_source">show</a>
                
              </p>
              <div id="method-i-test_top_level_procs_arent_applied_to_associations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/xml_serialization_test.rb, line 211</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_top_level_procs_arent_applied_to_associations</span>
  <span class="ruby-identifier">author_proc</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">options</span><span class="ruby-operator">|</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:builder</span>].<span class="ruby-identifier">tag!</span>(<span class="ruby-string">'nationality'</span>, <span class="ruby-string">'Danish'</span>) }
  <span class="ruby-identifier">xml</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">to_xml</span>(<span class="ruby-value">:procs</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-identifier">author_proc</span> ], <span class="ruby-value">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:posts</span>, <span class="ruby-value">:indent</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>)

  <span class="ruby-identifier">assert_match</span> <span class="ruby-regexp">%r{^  &lt;nationality&gt;Danish&lt;/nationality&gt;}</span>, <span class="ruby-identifier">xml</span>
  <span class="ruby-identifier">assert_no_match</span> <span class="ruby-regexp">%r{^ {6}&lt;nationality&gt;Danish&lt;/nationality&gt;}</span>, <span class="ruby-identifier">xml</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    