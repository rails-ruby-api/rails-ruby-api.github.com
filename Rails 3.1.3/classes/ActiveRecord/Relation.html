<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ActiveRecord::Relation</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            ActiveRecord::Relation 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/activerecord/lib/active_record/relation_rb.html">activerecord/lib/active_record/relation.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="label-Active+Record+Relation">Active Record <a href="Relation.html">Relation</a></h1>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-3D-3D">==</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-any-3F">any?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-build">build</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-create">create</a>,
              </li>
            
              
              <li>
                <a href="#method-i-create-21">create!</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-delete">delete</a>,
              </li>
            
              
              <li>
                <a href="#method-i-delete_all">delete_all</a>,
              </li>
            
              
              <li>
                <a href="#method-i-destroy">destroy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-destroy_all">destroy_all</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-eager_loading-3F">eager_loading?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-empty-3F">empty?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-initialize_copy">initialize_copy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-insert">insert</a>,
              </li>
            
              
              <li>
                <a href="#method-i-inspect">inspect</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>J</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-joined_includes_values">joined_includes_values</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-many-3F">many?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-method_missing">method_missing</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-new">new</a>,
              </li>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-reload">reload</a>,
              </li>
            
              
              <li>
                <a href="#method-i-reset">reset</a>,
              </li>
            
              
              <li>
                <a href="#method-i-respond_to-3F">respond_to?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-scope_for_create">scope_for_create</a>,
              </li>
            
              
              <li>
                <a href="#method-i-scoping">scoping</a>,
              </li>
            
              
              <li>
                <a href="#method-i-size">size</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-to_a">to_a</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_sql">to_sql</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-update">update</a>,
              </li>
            
              
              <li>
                <a href="#method-i-update_all">update_all</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>W</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-where_values_hash">where_values_hash</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="FinderMethods.html">
              ActiveRecord::FinderMethods
            </a>
          
        </li>
      
        <li>
          
            <a href="Calculations.html">
              ActiveRecord::Calculations
            </a>
          
        </li>
      
        <li>
          
            <a href="SpawnMethods.html">
              ActiveRecord::SpawnMethods
            </a>
          
        </li>
      
        <li>
          
            <a href="QueryMethods.html">
              ActiveRecord::QueryMethods
            </a>
          
        </li>
      
        <li>
          
            <a href="Batches.html">
              ActiveRecord::Batches
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">JoinOperation</td>
            <td>=</td>
            <td class="attr-value">Struct.new(:relation, :join_class, :on)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">ASSOCIATION_METHODS</td>
            <td>=</td>
            <td class="attr-value">[:includes, :eager_load, :preload]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">MULTI_VALUE_METHODS</td>
            <td>=</td>
            <td class="attr-value">[:select, :group, :order, :joins, :where, :having, :bind]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">SINGLE_VALUE_METHODS</td>
            <td>=</td>
            <td class="attr-value">[:limit, :offset, :lock, :readonly, :from, :reorder, :reverse_order]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>default_scoped</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>default_scoped?</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>extensions</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>klass</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>loaded</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>loaded?</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>table</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(klass, table)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 23</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>(<span class="ruby-identifier">klass</span>, <span class="ruby-identifier">table</span>)
  <span class="ruby-ivar">@klass</span>, <span class="ruby-ivar">@table</span> = <span class="ruby-identifier">klass</span>, <span class="ruby-identifier">table</span>

  <span class="ruby-ivar">@implicit_readonly</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@loaded</span>            = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@default_scoped</span>    = <span class="ruby-keyword">false</span>

  <span class="ruby-constant">SINGLE_VALUE_METHODS</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value">:&quot;@#{v}_value&quot;</span>, <span class="ruby-keyword">nil</span>)}
  (<span class="ruby-constant">ASSOCIATION_METHODS</span> <span class="ruby-operator">+</span> <span class="ruby-constant">MULTI_VALUE_METHODS</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value">:&quot;@#{v}_values&quot;</span>, [])}
  <span class="ruby-ivar">@extensions</span> = []
  <span class="ruby-ivar">@create_with_value</span> = {}
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-3D-3D">
            
              <a name="method-i-3D-3D"></a><b>==</b>(other)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-3D-3D_source')" id="l_method-i-3D-3D_source">show</a>
                
              </p>
              <div id="method-i-3D-3D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 426</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-keyword ruby-title">other</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Relation</span>
    <span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_sql</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">to_sql</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
    <span class="ruby-identifier">to_a</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-any-3F">
            
              <a name="method-i-any-3F"></a><b>any?</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-any-3F_source')" id="l_method-i-any-3F_source">show</a>
                
              </p>
              <div id="method-i-any-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">any?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">block_args</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>(*<span class="ruby-identifier">block_args</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-operator">!</span><span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-build">
            
              <a name="method-i-build"></a><b>build</b>(*args, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-create">
            
              <a name="method-i-create"></a><b>create</b>(*args, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-create_source')" id="l_method-i-create_source">show</a>
                
              </p>
              <div id="method-i-create_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 89</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">create</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">create</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-create-21">
            
              <a name="method-i-create-21"></a><b>create!</b>(*args, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-create-21_source')" id="l_method-i-create-21_source">show</a>
                
              </p>
              <div id="method-i-create-21_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 93</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">create!</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">create!</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delete">
            
              <a name="method-i-delete"></a><b>delete</b>(id_or_array)
            
          </div>
          
          
            <div class="description">
              <p>Deletes the row with a primary key matching the <code>id</code> argument,
using a SQL <code>DELETE</code> statement, and returns the number of rows
deleted. Active Record objects are not instantiated, so the object’s
callbacks are not executed, including any <code>:dependent</code>
association options or <a href="Observer.html">Observer</a> methods.</p>

<p>You can delete multiple rows at once by passing an <a
href="../Array.html">Array</a> of <code>id</code>s.</p>

<p>Note: Although it is often much faster than the alternative,
<code>#destroy</code>, skipping callbacks might bypass business logic in
your application that ensures referential integrity or performs other
essential jobs.</p>

<h4 id="method-i-delete-label-Examples">Examples</h4>

<pre># Delete a single row
Todo.delete(1)

# Delete multiple rows
Todo.delete([2,3,4])</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-delete_source')" id="l_method-i-delete_source">show</a>
                
              </p>
              <div id="method-i-delete_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 378</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">delete</span>(<span class="ruby-identifier">id_or_array</span>)
  <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">remove_by_id</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">symbolized_base_class</span>, <span class="ruby-identifier">id_or_array</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">enabled?</span>
  <span class="ruby-identifier">where</span>(<span class="ruby-identifier">primary_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">id_or_array</span>).<span class="ruby-identifier">delete_all</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delete_all">
            
              <a name="method-i-delete_all"></a><b>delete_all</b>(conditions = nil)
            
          </div>
          
          
            <div class="description">
              <p>Deletes the records matching <code>conditions</code> without instantiating
the records first, and hence not calling the <code>destroy</code> method
nor invoking callbacks. This is a single SQL DELETE statement that goes
straight to the database, much more efficient than
<code>destroy_all</code>. Be careful with relations though, in particular
<code>:dependent</code> rules defined on associations are not honored. 
Returns the number of rows affected.</p>

<h4 id="method-i-delete_all-label-Parameters">Parameters</h4>
<ul><li>
<p><code>conditions</code> - Conditions are specified the same way as with
<code>find</code> method.</p>
</li></ul>

<h4 id="method-i-delete_all-label-Example">Example</h4>

<pre class="ruby"><span class="ruby-constant">Post</span>.<span class="ruby-identifier">delete_all</span>(<span class="ruby-string">&quot;person_id = 5 AND (category = 'Something' OR category = 'Else')&quot;</span>)
<span class="ruby-constant">Post</span>.<span class="ruby-identifier">delete_all</span>([<span class="ruby-string">&quot;person_id = ? AND (category = ? OR category = ?)&quot;</span>, <span class="ruby-value">5</span>, <span class="ruby-string">'Something'</span>, <span class="ruby-string">'Else'</span>])
<span class="ruby-constant">Post</span>.<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">person_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>).<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">category</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">'Something'</span>, <span class="ruby-string">'Else'</span>]).<span class="ruby-identifier">delete_all</span>
</pre>

<p>Both calls delete the affected posts all at once with a single DELETE
statement. If you need to destroy dependent associations or call your
<code>before_*</code> or <code>after_destroy</code> callbacks, use the
<code>destroy_all</code> method instead.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-delete_all_source')" id="l_method-i-delete_all_source">show</a>
                
              </p>
              <div id="method-i-delete_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 345</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">delete_all</span>(<span class="ruby-identifier">conditions</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">repository</span>[<span class="ruby-identifier">symbolized_base_class</span>] = {} <span class="ruby-keyword">if</span> <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">enabled?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">conditions</span>
    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">delete_all</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">statement</span> = <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">compile_delete</span>
    <span class="ruby-identifier">affected</span> = <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">statement</span>, <span class="ruby-string">'SQL'</span>, <span class="ruby-identifier">bind_values</span>)

    <span class="ruby-identifier">reset</span>
    <span class="ruby-identifier">affected</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-destroy">
            
              <a name="method-i-destroy"></a><b>destroy</b>(id)
            
          </div>
          
          
            <div class="description">
              <p>Destroy an object (or multiple objects) that has the given id, the object
is instantiated first, therefore all callbacks and filters are fired off
before the object is deleted.  This method is less efficient than
ActiveRecord#delete but allows cleanup methods and other actions to be run.</p>

<p>This essentially finds the object (or multiple objects) with the given id,
creates a new object from the attributes, and then calls destroy on it.</p>

<h4 id="method-i-destroy-label-Parameters">Parameters</h4>
<ul><li>
<p><code>id</code> - Can be either an <a href="../Integer.html">Integer</a> or
an <a href="../Array.html">Array</a> of Integers.</p>
</li></ul>

<h4 id="method-i-destroy-label-Examples">Examples</h4>

<pre># Destroy a single object
Todo.destroy(1)

# Destroy multiple objects
todos = [1,2,3]
Todo.destroy(todos)</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-destroy_source')" id="l_method-i-destroy_source">show</a>
                
              </p>
              <div id="method-i-destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 318</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">destroy</span>(<span class="ruby-identifier">id</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">id</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">one_id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">one_id</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">find</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-destroy_all">
            
              <a name="method-i-destroy_all"></a><b>destroy_all</b>(conditions = nil)
            
          </div>
          
          
            <div class="description">
              <p>Destroys the records matching <code>conditions</code> by instantiating each
record and calling its <code>destroy</code> method. Each object’s callbacks
are executed (including <code>:dependent</code> association options and
<code>before_destroy</code>/<code>after_destroy</code> <a
href="Observer.html">Observer</a> methods). Returns the collection of
objects that were destroyed; each will be frozen, to reflect that no
changes should be made (since they can’t be persisted).</p>

<p>Note: Instantiation, callback execution, and deletion of each record can be
time consuming when you’re removing many records at once. It generates at
least one SQL <code>DELETE</code> query per record (or possibly more, to
enforce your callbacks). If you want to delete many rows quickly, without
concern for their associations or callbacks, use <code>delete_all</code>
instead.</p>

<h4 id="method-i-destroy_all-label-Parameters">Parameters</h4>
<ul><li>
<p><code>conditions</code> - <a href="../A.html">A</a> string, array, or hash
that specifies which records to destroy. If omitted, all records are
destroyed. See the Conditions section in the introduction to <a
href="Base.html">ActiveRecord::Base</a> for more information.</p>
</li></ul>

<h4 id="method-i-destroy_all-label-Examples">Examples</h4>

<pre class="ruby"><span class="ruby-constant">Person</span>.<span class="ruby-identifier">destroy_all</span>(<span class="ruby-string">&quot;last_login &lt; '2004-04-04'&quot;</span>)
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">destroy_all</span>(:<span class="ruby-identifier">status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;inactive&quot;</span>)
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">age</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">18</span>).<span class="ruby-identifier">destroy_all</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-destroy_all_source')" id="l_method-i-destroy_all_source">show</a>
                
              </p>
              <div id="method-i-destroy_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">destroy_all</span>(<span class="ruby-identifier">conditions</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">conditions</span>
    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">destroy_all</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">object</span><span class="ruby-operator">|</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">destroy</span> }.<span class="ruby-identifier">tap</span> { <span class="ruby-identifier">reset</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-eager_loading-3F">
            
              <a name="method-i-eager_loading-3F"></a><b>eager_loading?</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-eager_loading-3F_source')" id="l_method-i-eager_loading-3F_source">show</a>
                
              </p>
              <div id="method-i-eager_loading-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 412</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">eager_loading?</span>
  <span class="ruby-ivar">@should_eager_load</span> <span class="ruby-operator">||=</span>
    <span class="ruby-ivar">@eager_load_values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">||</span>
    <span class="ruby-ivar">@includes_values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">joined_includes_values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">references_eager_loaded_tables?</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty-3F">
            
              <a name="method-i-empty-3F"></a><b>empty?</b>()
            
          </div>
          
          
            <div class="description">
              <p>Returns true if there are no records.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty-3F_source')" id="l_method-i-empty-3F_source">show</a>
                
              </p>
              <div id="method-i-empty-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 146</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@records</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>

  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">count</span>
  <span class="ruby-identifier">c</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:zero?</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">zero?</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-initialize_copy">
            
              <a name="method-i-initialize_copy"></a><b>initialize_copy</b>(other)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-initialize_copy_source')" id="l_method-i-initialize_copy_source">show</a>
                
              </p>
              <div id="method-i-initialize_copy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 83</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize_copy</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-identifier">reset</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-insert">
            
              <a name="method-i-insert"></a><b>insert</b>(values)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-insert_source')" id="l_method-i-insert_source">show</a>
                
              </p>
              <div id="method-i-insert_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">insert</span>(<span class="ruby-identifier">values</span>)
  <span class="ruby-identifier">primary_key_value</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">primary_key</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Hash</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">values</span>
    <span class="ruby-identifier">primary_key_value</span> = <span class="ruby-identifier">values</span>[<span class="ruby-identifier">values</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">k</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">primary_key</span>
    }]

    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">primary_key_value</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">prefetch_primary_key?</span>(<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">table_name</span>)
      <span class="ruby-identifier">primary_key_value</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">next_sequence_value</span>(<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">sequence_name</span>)
      <span class="ruby-identifier">values</span>[<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">arel_table</span>[<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">primary_key</span>]] = <span class="ruby-identifier">primary_key_value</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">im</span> = <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">create_insert</span>
  <span class="ruby-identifier">im</span>.<span class="ruby-identifier">into</span> <span class="ruby-ivar">@table</span>

  <span class="ruby-identifier">conn</span> = <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>

  <span class="ruby-identifier">substitutes</span> = <span class="ruby-identifier">values</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">arel_attr</span>,<span class="ruby-identifier">_</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arel_attr</span>.<span class="ruby-identifier">name</span> }
  <span class="ruby-identifier">binds</span>       = <span class="ruby-identifier">substitutes</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arel_attr</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    [<span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">columns_hash</span>[<span class="ruby-identifier">arel_attr</span>.<span class="ruby-identifier">name</span>], <span class="ruby-identifier">value</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">substitutes</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tuple</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">tuple</span>[<span class="ruby-number">1</span>] = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">substitute_at</span>(<span class="ruby-identifier">binds</span>[<span class="ruby-identifier">i</span>][<span class="ruby-number">0</span>], <span class="ruby-identifier">i</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">values</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment"># empty insert</span>
    <span class="ruby-identifier">im</span>.<span class="ruby-identifier">values</span> = <span class="ruby-constant">Arel</span>.<span class="ruby-identifier">sql</span>(<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">empty_insert_statement_value</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">im</span>.<span class="ruby-identifier">insert</span> <span class="ruby-identifier">substitutes</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">insert</span>(
    <span class="ruby-identifier">im</span>,
    <span class="ruby-string">'SQL'</span>,
    <span class="ruby-identifier">primary_key</span>,
    <span class="ruby-identifier">primary_key_value</span>,
    <span class="ruby-keyword">nil</span>,
    <span class="ruby-identifier">binds</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-inspect">
            
              <a name="method-i-inspect"></a><b>inspect</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-inspect_source')" id="l_method-i-inspect_source">show</a>
                
              </p>
              <div id="method-i-inspect_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 435</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">inspect</span>
  <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-joined_includes_values">
            
              <a name="method-i-joined_includes_values"></a><b>joined_includes_values</b>()
            
          </div>
          
          
            <div class="description">
              <p>Joins that are also marked for preloading. In which case we should just
eager load them. Note that this is a naive implementation because we could
have strings and symbols which represent the same association, but that
aren’t matched by this. Also, we could have nested hashes which partially
match, e.g. { :a =&gt; :b } &amp; { :a =&gt; [:b, :c] }</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-joined_includes_values_source')" id="l_method-i-joined_includes_values_source">show</a>
                
              </p>
              <div id="method-i-joined_includes_values_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 422</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">joined_includes_values</span>
  <span class="ruby-ivar">@includes_values</span> &amp; <span class="ruby-ivar">@joins_values</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-many-3F">
            
              <a name="method-i-many-3F"></a><b>many?</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-many-3F_source')" id="l_method-i-many-3F_source">show</a>
                
              </p>
              <div id="method-i-many-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">many?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">many?</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">block_args</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>(*<span class="ruby-identifier">block_args</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@limit_value</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">many?</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-new">
            
              <a name="method-i-new"></a><b>new</b>(*args, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
            <div class="aka">
              Also aliased as: <a href="Relation.html#method-i-build">build</a>
            </div>
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-new_source')" id="l_method-i-new_source">show</a>
                
              </p>
              <div id="method-i-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reload">
            
              <a name="method-i-reload"></a><b>reload</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-reload_source')" id="l_method-i-reload_source">show</a>
                
              </p>
              <div id="method-i-reload_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 383</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">reload</span>
  <span class="ruby-identifier">reset</span>
  <span class="ruby-identifier">to_a</span> <span class="ruby-comment"># force reload</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reset">
            
              <a name="method-i-reset"></a><b>reset</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-reset_source')" id="l_method-i-reset_source">show</a>
                
              </p>
              <div id="method-i-reset_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 389</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">reset</span>
  <span class="ruby-ivar">@first</span> = <span class="ruby-ivar">@last</span> = <span class="ruby-ivar">@to_sql</span> = <span class="ruby-ivar">@order_clause</span> = <span class="ruby-ivar">@scope_for_create</span> = <span class="ruby-ivar">@arel</span> = <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@should_eager_load</span> = <span class="ruby-ivar">@join_dependency</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@records</span> = []
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-respond_to-3F">
            
              <a name="method-i-respond_to-3F"></a><b>respond_to?</b>(method, include_private = false)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-respond_to-3F_source')" id="l_method-i-respond_to-3F_source">show</a>
                
              </p>
              <div id="method-i-respond_to-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">respond_to?</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">include_private</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">include_private</span>)     <span class="ruby-operator">||</span>
    <span class="ruby-constant">Array</span>.<span class="ruby-identifier">method_defined?</span>(<span class="ruby-identifier">method</span>)               <span class="ruby-operator">||</span>
    <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">include_private</span>) <span class="ruby-operator">||</span>
    <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-scope_for_create">
            
              <a name="method-i-scope_for_create"></a><b>scope_for_create</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-scope_for_create_source')" id="l_method-i-scope_for_create_source">show</a>
                
              </p>
              <div id="method-i-scope_for_create_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 408</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">scope_for_create</span>
  <span class="ruby-ivar">@scope_for_create</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">where_values_hash</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">create_with_value</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-scoping">
            
              <a name="method-i-scoping"></a><b>scoping</b>()
            
          </div>
          
          
            <div class="description">
              <p>Scope all queries to the current scope.</p>

<h4 id="method-i-scoping-label-Example">Example</h4>

<pre class="ruby"><span class="ruby-constant">Comment</span>.<span class="ruby-identifier">where</span>(:<span class="ruby-identifier">post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">scoping</span> <span class="ruby-keyword">do</span>
  <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">first</span> <span class="ruby-comment"># SELECT * FROM comments WHERE post_id = 1</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Please check unscoped if you want to remove all previous scopes (including
the default_scope) during the execution of a block.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-scoping_source')" id="l_method-i-scoping_source">show</a>
                
              </p>
              <div id="method-i-scoping_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">scoping</span>
  <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:with_scope</span>, <span class="ruby-keyword">self</span>, <span class="ruby-value">:overwrite</span>) { <span class="ruby-keyword">yield</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-size">
            
              <a name="method-i-size"></a><b>size</b>()
            
          </div>
          
          
            <div class="description">
              <p>Returns size of the records.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-size_source')" id="l_method-i-size_source">show</a>
                
              </p>
              <div id="method-i-size_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">size</span>
  <span class="ruby-identifier">loaded?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@records</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_a">
            
              <a name="method-i-to_a"></a><b>to_a</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_a_source')" id="l_method-i-to_a_source">show</a>
                
              </p>
              <div id="method-i-to_a_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 104</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">to_a</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@records</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>

  <span class="ruby-identifier">default_scoped</span> = <span class="ruby-identifier">with_default_scope</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">default_scoped</span>.<span class="ruby-identifier">equal?</span>(<span class="ruby-keyword">self</span>)
    <span class="ruby-ivar">@records</span> = <span class="ruby-keyword">if</span> <span class="ruby-ivar">@readonly_value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">locking_enabled?</span>
      <span class="ruby-identifier">eager_loading?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">find_with_associations</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">find_by_sql</span>(<span class="ruby-identifier">arel</span>, <span class="ruby-ivar">@bind_values</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">without</span> <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">eager_loading?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">find_with_associations</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">find_by_sql</span>(<span class="ruby-identifier">arel</span>, <span class="ruby-ivar">@bind_values</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">preload</span> = <span class="ruby-ivar">@preload_values</span>
    <span class="ruby-identifier">preload</span> <span class="ruby-operator">+=</span>  <span class="ruby-ivar">@includes_values</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">eager_loading?</span>
    <span class="ruby-identifier">preload</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">associations</span><span class="ruby-operator">|</span>
      <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Associations</span><span class="ruby-operator">::</span><span class="ruby-constant">Preloader</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@records</span>, <span class="ruby-identifier">associations</span>).<span class="ruby-identifier">run</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># @readonly_value is true only if set explicitly. @implicit_readonly is true if there</span>
    <span class="ruby-comment"># are JOINS and no explicit SELECT.</span>
    <span class="ruby-identifier">readonly</span> = <span class="ruby-ivar">@readonly_value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@implicit_readonly</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@readonly_value</span>
    <span class="ruby-ivar">@records</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">readonly!</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">readonly</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@records</span> = <span class="ruby-identifier">default_scoped</span>.<span class="ruby-identifier">to_a</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@records</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_sql">
            
              <a name="method-i-to_sql"></a><b>to_sql</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_sql_source')" id="l_method-i-to_sql_source">show</a>
                
              </p>
              <div id="method-i-to_sql_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 396</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">to_sql</span>
  <span class="ruby-ivar">@to_sql</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">to_sql</span>(<span class="ruby-identifier">arel</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-update">
            
              <a name="method-i-update"></a><b>update</b>(id, attributes)
            
          </div>
          
          
            <div class="description">
              <p>Updates an object (or multiple objects) and saves it to the database, if
validations pass. The resulting object is returned whether the object was
saved successfully to the database or not.</p>

<h4 id="method-i-update-label-Parameters">Parameters</h4>
<ul><li>
<p><code>id</code> - This should be the id or an array of ids to be updated.</p>
</li><li>
<p><code>attributes</code> - This should be a hash of attributes or an array
of hashes.</p>
</li></ul>

<h4 id="method-i-update-label-Examples">Examples</h4>

<pre class="ruby"><span class="ruby-comment"># Updates one record</span>
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">update</span>(<span class="ruby-value">15</span>, :<span class="ruby-identifier">user_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'Samuel'</span>, :<span class="ruby-identifier">group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'expert'</span>)

<span class="ruby-comment"># Updates multiple records</span>
<span class="ruby-identifier">people</span> = { <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span> }, <span class="ruby-value">2</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Jeremy&quot;</span> } }
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">people</span>.<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">people</span>.<span class="ruby-identifier">values</span>)
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-update_source')" id="l_method-i-update_source">show</a>
                
              </p>
              <div id="method-i-update_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 253</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">update</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">attributes</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">idx</span> = <span class="ruby-number">-1</span>
    <span class="ruby-identifier">id</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">one_id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">idx</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>; <span class="ruby-identifier">update</span>(<span class="ruby-identifier">one_id</span>, <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">idx</span>]) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">object</span> = <span class="ruby-identifier">find</span>(<span class="ruby-identifier">id</span>)
    <span class="ruby-identifier">object</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">attributes</span>)
    <span class="ruby-identifier">object</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-update_all">
            
              <a name="method-i-update_all"></a><b>update_all</b>(updates, conditions = nil, options = {})
            
          </div>
          
          
            <div class="description">
              <p>Updates all records with details given if they match a set of conditions
supplied, limits and order can also be supplied. This method constructs a
single SQL UPDATE statement and sends it straight to the database. It does
not instantiate the involved models and it does not trigger Active Record
callbacks or validations.</p>

<h4 id="method-i-update_all-label-Parameters">Parameters</h4>
<ul><li>
<p><code>updates</code> - <a href="../A.html">A</a> string, array, or hash
representing the SET part of an SQL statement.</p>
</li><li>
<p><code>conditions</code> - <a href="../A.html">A</a> string, array, or hash
representing the WHERE part of an SQL statement. See conditions in the
intro.</p>
</li><li>
<p><code>options</code> - Additional options are <code>:limit</code> and
<code>:order</code>, see the examples for usage.</p>
</li></ul>

<h4 id="method-i-update_all-label-Examples">Examples</h4>

<pre class="ruby"><span class="ruby-comment"># Update all customers with the given attributes</span>
<span class="ruby-constant">Customer</span>.<span class="ruby-identifier">update_all</span> :<span class="ruby-identifier">wants_email</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>

<span class="ruby-comment"># Update all books with 'Rails' in their title</span>
<span class="ruby-constant">Book</span>.<span class="ruby-identifier">update_all</span> <span class="ruby-string">&quot;author = 'David'&quot;</span>, <span class="ruby-string">&quot;title LIKE '%Rails%'&quot;</span>

<span class="ruby-comment"># Update all avatars migrated more than a week ago</span>
<span class="ruby-constant">Avatar</span>.<span class="ruby-identifier">update_all</span> [<span class="ruby-string">'migrated_at = ?'</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span>], [<span class="ruby-string">'migrated_at &gt; ?'</span>, <span class="ruby-value">1</span>.<span class="ruby-identifier">week</span>.<span class="ruby-identifier">ago</span>]

<span class="ruby-comment"># Update all books that match conditions, but limit it to 5 ordered by date</span>
<span class="ruby-constant">Book</span>.<span class="ruby-identifier">update_all</span> <span class="ruby-string">&quot;author = 'David'&quot;</span>, <span class="ruby-string">&quot;title LIKE '%Rails%'&quot;</span>, :<span class="ruby-identifier">order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'created_at'</span>, :<span class="ruby-identifier">limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>

<span class="ruby-comment"># Conditions from the current relation also works</span>
<span class="ruby-constant">Book</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">'title LIKE ?'</span>, <span class="ruby-string">'%Rails%'</span>).<span class="ruby-identifier">update_all</span>(:<span class="ruby-identifier">author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'David'</span>)

<span class="ruby-comment"># The same idea applies to limit and order</span>
<span class="ruby-constant">Book</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">'title LIKE ?'</span>, <span class="ruby-string">'%Rails%'</span>).<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">created_at</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">5</span>).<span class="ruby-identifier">update_all</span>(:<span class="ruby-identifier">author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'David'</span>)
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-update_all_source')" id="l_method-i-update_all_source">show</a>
                
              </p>
              <div id="method-i-update_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">update_all</span>(<span class="ruby-identifier">updates</span>, <span class="ruby-identifier">conditions</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">repository</span>[<span class="ruby-identifier">symbolized_base_class</span>].<span class="ruby-identifier">clear</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">IdentityMap</span>.<span class="ruby-identifier">enabled?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">conditions</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">present?</span>
    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">apply_finder_options</span>(<span class="ruby-identifier">options</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">:limit</span>, <span class="ruby-value">:order</span>)).<span class="ruby-identifier">update_all</span>(<span class="ruby-identifier">updates</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">stmt</span> = <span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">UpdateManager</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arel</span>.<span class="ruby-identifier">engine</span>)

    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">set</span> <span class="ruby-constant">Arel</span>.<span class="ruby-identifier">sql</span>(<span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:sanitize_sql_for_assignment</span>, <span class="ruby-identifier">updates</span>))
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">table</span>(<span class="ruby-identifier">table</span>)
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">key</span> = <span class="ruby-identifier">table</span>[<span class="ruby-identifier">primary_key</span>]

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">joins_values</span>.<span class="ruby-identifier">any?</span>
      <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">join_to_update</span>(<span class="ruby-identifier">stmt</span>, <span class="ruby-identifier">arel</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">take</span>(<span class="ruby-identifier">arel</span>.<span class="ruby-identifier">limit</span>)
      <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">order</span>(*<span class="ruby-identifier">arel</span>.<span class="ruby-identifier">orders</span>)
      <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">wheres</span> = <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">constraints</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">update</span> <span class="ruby-identifier">stmt</span>, <span class="ruby-string">'SQL'</span>, <span class="ruby-identifier">bind_values</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-where_values_hash">
            
              <a name="method-i-where_values_hash"></a><b>where_values_hash</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-where_values_hash_source')" id="l_method-i-where_values_hash_source">show</a>
                
              </p>
              <div id="method-i-where_values_hash_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 400</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">where_values_hash</span>
  <span class="ruby-identifier">equalities</span> = <span class="ruby-identifier">with_default_scope</span>.<span class="ruby-identifier">where_values</span>.<span class="ruby-identifier">grep</span>(<span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">Nodes</span><span class="ruby-operator">::</span><span class="ruby-constant">Equality</span>).<span class="ruby-identifier">find_all</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">node</span>.<span class="ruby-identifier">left</span>.<span class="ruby-identifier">relation</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">table_name</span>
  }

  <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">equalities</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">where</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">where</span>.<span class="ruby-identifier">left</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">where</span>.<span class="ruby-identifier">right</span>] }]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
              
      <div class="sectiontitle">Instance Protected methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-method_missing">
            
              <a name="method-i-method_missing"></a><b>method_missing</b>(method, *args, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-method_missing_source')" id="l_method-i-method_missing_source">show</a>
                
              </p>
              <div id="method-i-method_missing_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/lib/active_record/relation.rb, line 451</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">method_missing</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">method_defined?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>) }
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">super</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    