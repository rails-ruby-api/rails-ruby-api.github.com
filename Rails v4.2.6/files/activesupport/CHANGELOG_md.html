<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>CHANGELOG.md</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            CHANGELOG.md
        </h1>
        <ul class="files">
            
            <li>
                activesupport/CHANGELOG.md
                
                    <a href="https://github.com/rails/rails/blob/a0e0b67b5afbb02d9ea9e48d71ae80b3efb8c0ac/activesupport/CHANGELOG.md" target="_blank" class="github_url">on GitHub</a>
                
            </li>
            <li>Last modified: 2016-05-19 14:28:33 +0200</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h2 id="label-Rails+4.2.6+-28March+07-2C+2016-29">Rails 4.2.6 (March 07, 2016)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+4.2.5.2+-28February+26-2C+2016-29">Rails 4.2.5.2 (February 26, 2016)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+4.2.5.1+-28January+25-2C+2015-29">Rails 4.2.5.1 (January 25, 2015)</h2>
<ul><li>
<p>No changes.</p>
</li></ul>

<h2 id="label-Rails+4.2.5+-28November+12-2C+2015-29">Rails 4.2.5 (November 12, 2015)</h2>
<ul><li>
<p>Fix <code>TimeWithZone#eql?</code> to properly handle
<code>TimeWithZone</code> created from <code>DateTime</code>:  twz =
DateTime.now.in_time_zone  twz.eql?(twz.dup) =&gt; true</p>

<p>Fixes #14178.</p>

<p><em>Roque Pinel</em></p>
</li><li>
<p>Handle invalid UTF-8 characters in <code>MessageVerifier.verify</code>.</p>

<p><em>Roque Pinel</em>, <em>Grey Baker</em></p>
</li></ul>

<h2 id="label-Rails+4.2.4+-28August+24-2C+2015-29">Rails 4.2.4 (August 24, 2015)</h2>
<ul><li>
<p>Fix a <code>SystemStackError</code> when encoding an
<code>Enumerable</code> with <code>json</code> gem and with the Active
Support JSON encoder loaded.</p>

<p>Fixes #20775.</p>

<p><em>Sammy Larbi</em>, <em>Prathamesh Sonpatki</em></p>
</li><li>
<p>Fix not calling <code>#default</code> on
<code>HashWithIndifferentAcess#to_hash</code> when only
<code>default_proc</code> is set, which could raise.</p>

<p><em>Simon Eskildsen</em></p>
</li><li>
<p>Fix setting <code>default_proc</code> on
<code>HashWithIndifferentAccess#dup</code></p>

<p><em>Simon Eskildsen</em></p>
</li></ul>

<h2 id="label-Rails+4.2.3+-28June+25-2C+2015-29">Rails 4.2.3 (June 25, 2015)</h2>
<ul><li>
<p>Fix a range of values for parameters of the <a
href="../../classes/Time.html#method-i-change">Time#change</a></p>

<p><em>Nikolay Kondratyev</em></p>
</li><li>
<p>Add some missing <code>require &#39;active_support/deprecation&#39;</code></p>

<p><em>Akira Matsuda</em></p>
</li></ul>

<h2 id="label-Rails+4.2.2+-28June+16-2C+2015-29">Rails 4.2.2 (June 16, 2015)</h2>
<ul><li>
<p>Fix XSS vulnerability in <code>ActiveSupport::JSON.encode</code> method.</p>

<p>CVE-2015-3226.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Fix denial of service vulnerability in the XML processing.</p>

<p>CVE-2015-3227.</p>

<p><em>Aaron Patterson</em></p>
</li></ul>

<h2 id="label-Rails+4.2.1+-28March+19-2C+2015-29">Rails 4.2.1 (March 19, 2015)</h2>
<ul><li>
<p>Fixed a problem where <a
href="../../classes/String.html#method-i-truncate_words">String#truncate_words</a>
would get stuck with a complex string.</p>

<p><em>Henrik Nygren</em></p>
</li><li>
<p>Fixed a roundtrip problem with AS::SafeBuffer where primitive-like strings
will be dumped as primitives:</p>

<p>Before:</p>

<pre><code>YAML.load ActiveSupport::SafeBuffer.new(&quot;Hello&quot;).to_yaml  # =&gt; &quot;Hello&quot;
YAML.load ActiveSupport::SafeBuffer.new(&quot;true&quot;).to_yaml   # =&gt; true
YAML.load ActiveSupport::SafeBuffer.new(&quot;false&quot;).to_yaml  # =&gt; false
YAML.load ActiveSupport::SafeBuffer.new(&quot;1&quot;).to_yaml      # =&gt; 1
YAML.load ActiveSupport::SafeBuffer.new(&quot;1.1&quot;).to_yaml    # =&gt; 1.1
</code></pre>

<p>After:</p>

<pre><code>YAML.load ActiveSupport::SafeBuffer.new(&quot;Hello&quot;).to_yaml  # =&gt; &quot;Hello&quot;
YAML.load ActiveSupport::SafeBuffer.new(&quot;true&quot;).to_yaml   # =&gt; &quot;true&quot;
YAML.load ActiveSupport::SafeBuffer.new(&quot;false&quot;).to_yaml  # =&gt; &quot;false&quot;
YAML.load ActiveSupport::SafeBuffer.new(&quot;1&quot;).to_yaml      # =&gt; &quot;1&quot;
YAML.load ActiveSupport::SafeBuffer.new(&quot;1.1&quot;).to_yaml    # =&gt; &quot;1.1&quot;
</code></pre>

<p><em>Godfrey Chan</em></p>
</li><li>
<p>Replace fixed <code>:en</code> with <code>I18n.default_locale</code> in
<code>Duration#inspect</code>.</p>

<p><em>Dominik Masur</em></p>
</li><li>
<p>Add missing time zone definitions for Russian Federation and sync them with
<code>zone.tab</code> file from tzdata version 2014j (latest).</p>

<p><em>Andrey Novikov</em></p>
</li></ul>

<h2 id="label-Rails+4.2.0+-28December+20-2C+2014-29">Rails 4.2.0 (December 20, 2014)</h2>
<ul><li>
<p>The decorated <code>load</code> and <code>require</code> methods are now
kept private.</p>

<p>Fixes #17553.</p>

<p><em>Xavier Noria</em></p>
</li><li>
<p><code>String#remove</code> and <code>String#remove!</code> accept multiple
arguments.</p>

<p><em>Pavel Pravosud</em></p>
</li><li>
<p><code>TimeWithZone#strftime</code> now delegates every directive to
<code>Time#strftime</code> except for &#39;%Z&#39;, it also now correctly
handles escaped &#39;%&#39; characters placed just before time zone related
directives.</p>

<p><em>Pablo Herrero</em></p>
</li><li>
<p>Corrected <code>Inflector#underscore</code> handling of multiple successive
acroynms.</p>

<p><em>James Le Cuirot</em></p>
</li><li>
<p>Delegation now works with ruby reserved words passed to <code>:to</code>
option.</p>

<p>Fixes #16956.</p>

<p><em>Agis Anastasopoulos</em></p>
</li><li>
<p>Added method <code>#eql?</code> to <code>ActiveSupport::Duration</code>, in
addition to <code>#==</code>.</p>

<p>Currently, the following returns <code>false</code>, contrary to
expectation:</p>

<pre><code>1.minute.eql?(1.minute)
</code></pre>

<p>Adding method <code>#eql?</code> will make this behave like expected. <a
href="../../classes/Method.html">Method</a> <code>#eql?</code> is just a
bit stricter than <code>#==</code>, as it checks whether the argument is
also a duration. Their parts may be different though.</p>

<pre><code>1.minute.eql?(60.seconds)  # =&gt; true
1.minute.eql?(60)          # =&gt; false
</code></pre>

<p><em>Joost Lubach</em></p>
</li><li>
<p><code>Time#change</code> can now change nanoseconds (<code>:nsec</code>) as
a higher-precision alternative to microseconds (<code>:usec</code>).</p>

<p><em>Agis Anastasooulos</em></p>
</li><li>
<p><code>MessageVerifier.new</code> raises an appropriate exception if the
secret is <code>nil</code>. This prevents
<code>MessageVerifier#generate</code> from raising a cryptic error later
on.</p>

<p><em>Kostiantyn Kahanskyi</em></p>
</li><li>
<p>Introduced new configuration option <code>active_support.test_order</code>
for specifying the order in which test cases are executed. This option
currently defaults to <code>:sorted</code> but will be changed to
<code>:random</code> in Rails 5.0.</p>

<p><em>Akira Matsuda</em>, <em>Godfrey Chan</em></p>
</li><li>
<p>Fixed a bug in <code>Inflector#underscore</code> where acroynms in nested
constant names are incorrectly parsed as camelCase.</p>

<p>Fixes #8015.</p>

<p><em>Fred Wu</em>, <em>Matthew Draper</em></p>
</li><li>
<p>Make <code>Time#change</code> throw an exception if the <code>:usec</code>
option is out of range and the time has an offset other than UTC or local.</p>

<p><em>Agis Anastasopoulos</em></p>
</li><li>
<p><code>Method</code> objects now report themselves as not
<code>duplicable?</code>. This allows hashes and arrays containing
<code>Method</code> objects to be <code>deep_dup</code>ed.</p>

<p><em>Peter Jaros</em></p>
</li><li>
<p><code>determine_constant_from_test_name</code> does no longer shadow
<code>NameError</code>s which happens during constant autoloading.</p>

<p>Fixes #9933.</p>

<p><em>Guo Xiang Tan</em></p>
</li><li>
<p>Added instance_eval version to <a
href="../../classes/Object.html#method-i-try">Object#try</a> and <a
href="../../classes/Object.html#method-i-try-21">Object#try!</a>, so you
can do this:</p>

<pre><code>person.try { name.first }
</code></pre>

<p>instead of:</p>

<pre><code>person.try { |person| person.name.first }
</code></pre>

<p><em>DHH</em>, <em>Ari Pollak</em></p>
</li><li>
<p>Fix the <code>ActiveSupport::Duration#instance_of?</code> method to return
the right value with the class itself since it was previously delegated to
the internal value.</p>

<p><em>Robin Dupret</em></p>
</li><li>
<p>Fix rounding errors with <code>#travel_to</code> by resetting the usec on
any passed time to zero, so we only travel with per-second precision, not
anything deeper than that.</p>

<p><em>DHH</em></p>
</li><li>
<p>Fix <a href="../../classes/DateTime.html">DateTime</a> comparison with
<code>DateTime::Infinity</code> object.</p>

<p><em>Rafael Mendonça França</em></p>
</li><li>
<p>Added <a href="../../classes/Object.html#method-i-itself">Object#itself</a>
which returns the object itself. Useful when dealing with a chaining
scenario, like Active <a href="../../classes/Record.html">Record</a>
scopes:</p>

<pre><code>Event.public_send(state.presence_in([ :trashed, :drafted ]) || :itself).order(:created_at)
</code></pre>

<p><em>DHH</em></p>
</li><li>
<p><code>Object#with_options</code> executes block in merging option context
when explicit receiver in not passed.</p>

<p><em>Pavel Pravosud</em></p>
</li><li>
<p>Fixed a compatibility issue with the <code>Oj</code> gem when
cherry-picking the file <code>active_support/core_ext/object/json</code>
without requiring <code>active_support/json</code>.</p>

<p>Fixes #16131.</p>

<p><em>Godfrey Chan</em></p>
</li><li>
<p>Make <code>Hash#with_indifferent_access</code> copy the default proc too.</p>

<p><em>arthurnn</em>, <em>Xanders</em></p>
</li><li>
<p>Add <code>String#truncate_words</code> to truncate a string by a number of
words.</p>

<p><em>Mohamed Osama</em></p>
</li><li>
<p>Deprecate <code>capture</code> and <code>quietly</code>.</p>

<p>These methods are not thread safe and may cause issues when used in
threaded environments. To avoid problems we are deprecating them.</p>

<p><em>Tom Meier</em></p>
</li><li>
<p><code>DateTime#to_f</code> now preserves the fractional seconds instead of
always rounding to <code>.0</code>.</p>

<p>Fixes #15994.</p>

<p><em>John Paul Ashenfelter</em></p>
</li><li>
<p>Add <code>Hash#transform_values</code> to simplify a common pattern where
the values of a hash must change, but the keys are left the same.</p>

<p><em>Sean Griffin</em></p>
</li><li>
<p>Always instrument <code>ActiveSupport::Cache</code>.</p>

<p>Since <code>ActiveSupport::Notifications</code> only instruments items when
there are attached subscribers, we don&#39;t need to disable
instrumentation.</p>

<p><em>Peter Wagenet</em></p>
</li><li>
<p>Make the <code>apply_inflections</code> method case-insensitive when
checking whether a word is uncountable or not.</p>

<p><em>Robin Dupret</em></p>
</li><li>
<p>Make Dependencies pass a name to <a
href="../../classes/NameError.html">NameError</a> error.</p>

<p><em>arthurnn</em></p>
</li><li>
<p>Fixed <code>ActiveSupport::Cache::FileStore</code> exploding with long
paths.</p>

<p><em>Adam Panzer</em>, <em>Michael Grosser</em></p>
</li><li>
<p>Fixed <code>ActiveSupport::TimeWithZone#-</code> so precision is not
unnecessarily lost when working with objects with a nanosecond component.</p>

<p><code>ActiveSupport::TimeWithZone#-</code> should return the same result as
if we were using <code>Time#-</code>:</p>

<pre><code>Time.now.end_of_day - Time.now.beginning_of_day # =&gt; 86399.999999999
</code></pre>

<p>Before:</p>

<pre><code>Time.zone.now.end_of_day.nsec # =&gt; 999999999
Time.zone.now.end_of_day - Time.zone.now.beginning_of_day # =&gt; 86400.0
</code></pre>

<p>After:</p>

<pre><code>Time.zone.now.end_of_day - Time.zone.now.beginning_of_day
# =&gt; 86399.999999999
</code></pre>

<p><em>Gordon Chan</em></p>
</li><li>
<p>Fixed precision error in NumberHelper when using Rationals.</p>

<p>Before:</p>

<pre><code>ActiveSupport::NumberHelper.number_to_rounded Rational(1000, 3), precision: 2
# =&gt; &quot;330.00&quot;
</code></pre>

<p>After:</p>

<pre><code>ActiveSupport::NumberHelper.number_to_rounded Rational(1000, 3), precision: 2
# =&gt; &quot;333.33&quot;
</code></pre>

<p>See #15379.</p>

<p><em>Juanjo Bazán</em></p>
</li><li>
<p>Removed deprecated <code>Numeric#ago</code> and friends</p>

<p>Replacements:</p>

<pre><code>5.ago   =&gt; 5.seconds.ago
5.until =&gt; 5.seconds.until
5.since =&gt; 5.seconds.since
5.from_now =&gt; 5.seconds.from_now</code></pre>

<p>See #12389 for the history and rationale behind this.</p>

<p><em>Godfrey Chan</em></p>
</li><li>
<p><a href="../../classes/DateTime.html">DateTime</a> <code>advance</code> now
supports partial days.</p>

<p>Before:</p>

<pre><code>DateTime.now.advance(days: 1, hours: 12)
</code></pre>

<p>After:</p>

<pre><code>DateTime.now.advance(days: 1.5)
</code></pre>

<p>Fixes #12005.</p>

<p><em>Shay Davidson</em></p>
</li><li>
<p><code>Hash#deep_transform_keys</code> and
<code>Hash#deep_transform_keys!</code> now transform hashes in nested
arrays. This change also applies to <code>Hash#deep_stringify_keys</code>,
<code>Hash#deep_stringify_keys!</code>,
<code>Hash#deep_symbolize_keys</code> and
<code>Hash#deep_symbolize_keys!</code>.</p>

<p><em>OZAWA Sakuro</em></p>
</li><li>
<p>Fixed confusing <code>DelegationError</code> in
<code>Module#delegate</code>.</p>

<p>See #15186.</p>

<p><em>Vladimir Yarotsky</em></p>
</li><li>
<p>Fixed <code>ActiveSupport::Subscriber</code> so that no duplicate
subscriber is created when a subscriber method is redefined.</p>

<p><em>Dennis Schön</em></p>
</li><li>
<p>Remove deprecated string based terminators for
<code>ActiveSupport::Callbacks</code>.</p>

<p><em>Eileen M. Uchitelle</em></p>
</li><li>
<p>Fixed an issue when using
<code>ActiveSupport::NumberHelper::NumberToDelimitedConverter</code> to
convert a value that is an <code>ActiveSupport::SafeBuffer</code>
introduced in 2da9d67.</p>

<p>See #15064.</p>

<p><em>Mark J. Titorenko</em></p>
</li><li>
<p><code>TimeZone#parse</code> defaults the day of the month to &#39;1&#39; if
any other date components are specified. This is more consistent with the
behavior of <code>Time#parse</code>.</p>

<p><em>Ulysse Carion</em></p>
</li><li>
<p><code>humanize</code> strips leading underscores, if any.</p>

<p>Before:</p>

<pre><code>&#39;_id&#39;.humanize # =&gt; &quot;&quot;
</code></pre>

<p>After:</p>

<pre><code>&#39;_id&#39;.humanize # =&gt; &quot;Id&quot;
</code></pre>

<p><em>Xavier Noria</em></p>
</li><li>
<p>Fixed backward compatibility issues introduced in 326e652.</p>

<p>Empty <a href="../../classes/Hash.html">Hash</a> or <a
href="../../classes/Array.html">Array</a> should not be present in
serialization result.</p>

<pre><code>{a: []}.to_query # =&gt; &quot;&quot;
{a: {}}.to_query # =&gt; &quot;&quot;
</code></pre>

<p>For more info see #14948.</p>

<p><em>Bogdan Gusiev</em></p>
</li><li>
<p>Add <code>Digest::UUID::uuid_v3</code> and
<code>Digest::UUID::uuid_v5</code> to support stable UUID fixtures on
PostgreSQL.</p>

<p><em>Roderick van Domburg</em></p>
</li><li>
<p>Fixed <code>ActiveSupport::Duration#eql?</code> so that
<code>1.second.eql?(1.second)</code> is true.</p>

<p>This fixes the current situation of:</p>

<pre><code>1.second.eql?(1.second) # =&gt; false
</code></pre>

<p><code>eql?</code> also requires that the other object is an
<code>ActiveSupport::Duration</code>. This requirement makes
<code>ActiveSupport::Duration</code>&#39;s behavior consistent with the
behavior of Ruby&#39;s numeric types:</p>

<pre><code>1.eql?(1.0) # =&gt; false
1.0.eql?(1) # =&gt; false

1.second.eql?(1) # =&gt; false (was true)
1.eql?(1.second) # =&gt; false

{ 1 =&gt; &quot;foo&quot;, 1.0 =&gt; &quot;bar&quot; }
# =&gt; { 1 =&gt; &quot;foo&quot;, 1.0 =&gt; &quot;bar&quot; }

{ 1 =&gt; &quot;foo&quot;, 1.second =&gt; &quot;bar&quot; }
# now =&gt; { 1 =&gt; &quot;foo&quot;, 1.second =&gt; &quot;bar&quot; }
# was =&gt; { 1 =&gt; &quot;bar&quot; }
</code></pre>

<p>And though the behavior of these hasn&#39;t changed, for reference:</p>

<pre><code>1 == 1.0 # =&gt; true
1.0 == 1 # =&gt; true

1 == 1.second # =&gt; true
1.second == 1 # =&gt; true
</code></pre>

<p><em>Emily Dobervich</em></p>
</li><li>
<p><code>ActiveSupport::SafeBuffer#prepend</code> acts like
<code>String#prepend</code> and modifies instance in-place, returning self.
<code>ActiveSupport::SafeBuffer#prepend!</code> is deprecated.</p>

<p><em>Pavel Pravosud</em></p>
</li><li>
<p><code>HashWithIndifferentAccess</code> better respects
<code>#to_hash</code> on objects it receives. In particular,
<code>.new</code>, <code>#update</code>, <code>#merge</code>, and
<code>#replace</code> accept objects which respond to
<code>#to_hash</code>, even if those objects are not hashes directly.</p>

<p><em>Peter Jaros</em></p>
</li><li>
<p>Deprecate <code>Class#superclass_delegating_accessor</code>, use
<code>Class#class_attribute</code> instead.</p>

<p><em>Akshay Vishnoi</em></p>
</li><li>
<p>Ensure classes which <code>include Enumerable</code> get
<code>#to_json</code> in addition to <code>#as_json</code>.</p>

<p><em>Sammy Larbi</em></p>
</li><li>
<p>Change the signature of <code>fetch_multi</code> to return a hash rather
than an array. This makes it consistent with the output of
<code>read_multi</code>.</p>

<p><em>Parker Selbert</em></p>
</li><li>
<p>Introduce <code>Concern#class_methods</code> as a sleek alternative to
clunky <code>module ClassMethods</code>. Add <code>Kernel#concern</code> to
define at the toplevel without chunky <code>module Foo; extend
ActiveSupport::Concern</code> boilerplate.</p>

<pre><code># app/models/concerns/authentication.rb
concern :Authentication do
  included do
    after_create :generate_private_key
  end

  class_methods do
    def authenticate(credentials)
      # ...
    end
  end

  def generate_private_key
    # ...
  end
end

# app/models/user.rb
class User &lt; ActiveRecord::Base
  include Authentication
end
</code></pre>

<p><em>Jeremy Kemper</em></p>
</li></ul>

<p>Please check <a
href="https://github.com/rails/rails/blob/4-1-stable/activesupport/CHANGELOG.md">4-1-stable</a>
for previous changes.</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
              </div>

    </div>
  </body>
</html>