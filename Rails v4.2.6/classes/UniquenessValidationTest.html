<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>UniquenessValidationTest</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            UniquenessValidationTest 
            
                <span class="parent">&lt; 
                    
                    ActiveRecord::TestCase
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/activerecord/test/cases/validations/uniqueness_validation_test_rb.html">activerecord/test/cases/validations/uniqueness_validation_test.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-name">name</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-test_validate_case_insensitive_uniqueness">test_validate_case_insensitive_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars">test_validate_case_insensitive_uniqueness_with_special_sql_like_chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_sensitive_uniqueness">test_validate_case_sensitive_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars">test_validate_case_sensitive_uniqueness_with_special_sql_like_chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_straight_inheritance_uniqueness">test_validate_straight_inheritance_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness">test_validate_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_on_empty_relation">test_validate_uniqueness_on_empty_relation</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_on_existing_relation">test_validate_uniqueness_on_existing_relation</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_scoped_to_defining_class">test_validate_uniqueness_scoped_to_defining_class</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_when_integer_out_of_range">test_validate_uniqueness_when_integer_out_of_range</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter">test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_alias_attribute">test_validate_uniqueness_with_alias_attribute</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_array_column">test_validate_uniqueness_with_array_column</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords">test_validate_uniqueness_with_columns_which_are_sql_keywords</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_composed_attribute_scope">test_validate_uniqueness_with_composed_attribute_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_conditions">test_validate_uniqueness_with_conditions</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_limit">test_validate_uniqueness_with_limit</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_limit_and_utf8">test_validate_uniqueness_with_limit_and_utf8</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported">test_validate_uniqueness_with_non_callable_conditions_is_not_supported</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_non_standard_table_names">test_validate_uniqueness_with_non_standard_table_names</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_object_arg">test_validate_uniqueness_with_object_arg</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_object_scope">test_validate_uniqueness_with_object_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_scope">test_validate_uniqueness_with_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_scope_array">test_validate_uniqueness_with_scope_array</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_without_primary_key">test_validate_uniqueness_without_primary_key</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_inside_scoping">test_validates_uniqueness_inside_scoping</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_with_newline_chars">test_validates_uniqueness_with_newline_chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_with_nil_value">test_validates_uniqueness_with_nil_value</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_with_validates">test_validates_uniqueness_with_validates</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">INT_MAX_VALUE</td>
            <td>=</td>
            <td class="attr-value">2147483647</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-name">
            
              <b>name</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-c-name" name="method-c-name" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-name_source')" id="l_method-c-name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L438" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 438</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">name</span>; <span class="ruby-string">&quot;Dashboard&quot;</span> <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_insensitive_uniqueness">
            
              <b>test_validate_case_insensitive_uniqueness</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_case_insensitive_uniqueness" name="method-i-test_validate_case_insensitive_uniqueness" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_insensitive_uniqueness_source')" id="l_method-i-test_validate_case_insensitive_uniqueness_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L217" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_case_insensitive_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 217</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_insensitive_uniqueness</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:parent_id</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>, <span class="ruby-value">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;Remaining unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should still save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m UNIQUE!&quot;</span>, <span class="ruby-value">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn&#39;t save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">any?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">any?</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-string">&quot;I&#39;m truly UNIQUE!&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn&#39;t save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">any?</span>

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-number">4</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should now save t2 as unique&quot;</span>

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;should validate with nil&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;should save with nil&quot;</span>

  <span class="ruby-identifier">t_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Я тоже уникальный!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t_utf8 as unique&quot;</span>

  <span class="ruby-comment"># If database hasn&#39;t UTF-8 character set, this test fails</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;LOWER(title) AS title&#39;</span>).<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t_utf8</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">title</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;я тоже уникальный!&quot;</span>
    <span class="ruby-identifier">t2_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;я тоже УНИКАЛЬНЫЙ!&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn&#39;t be valid&quot;</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn&#39;t save t2_utf8 as unique&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars">
            
              <b>test_validate_case_insensitive_uniqueness_with_special_sql_like_chars</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars" name="method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars_source')" id="l_method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L271" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 271</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_insensitive_uniqueness_with_special_sql_like_chars</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m %&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m uniqu_!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t3 as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_sensitive_uniqueness">
            
              <b>test_validate_case_sensitive_uniqueness</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_case_sensitive_uniqueness" name="method-i-test_validate_case_sensitive_uniqueness" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_sensitive_uniqueness_source')" id="l_method-i-test_validate_case_sensitive_uniqueness_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L284" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_case_sensitive_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 284</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_sensitive_uniqueness</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;Remaining unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should still save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;M UNIQUE!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Should be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert_not_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;M uNiQUe!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Should be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert_not_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer">
            
              <b>test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer" name="method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer_source')" id="l_method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L308" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 308</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-string">&#39;title&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">101</span>)

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;title&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">101</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars">
            
              <b>test_validate_case_sensitive_uniqueness_with_special_sql_like_chars</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars" name="method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars_source')" id="l_method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L258" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 258</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_sensitive_uniqueness_with_special_sql_like_chars</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m %&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m uniqu_!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t3 as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_straight_inheritance_uniqueness">
            
              <b>test_validate_straight_inheritance_uniqueness</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_straight_inheritance_uniqueness" name="method-i-test_validate_straight_inheritance_uniqueness" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_straight_inheritance_uniqueness_source')" id="l_method-i-test_validate_straight_inheritance_uniqueness_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L359" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_straight_inheritance_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 359</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_straight_inheritance_uniqueness</span>
  <span class="ruby-identifier">w1</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Rincewind&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ankh-Morpork&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving w1&quot;</span>

  <span class="ruby-comment"># Should use validation from base class (which is abstract)</span>
  <span class="ruby-identifier">w2</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Rincewind&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w2 shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for name&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>], <span class="ruby-string">&quot;Should have uniqueness message for name&quot;</span>

  <span class="ruby-identifier">w3</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Rincewind&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w3 shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for name&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>], <span class="ruby-string">&quot;Should have uniqueness message for name&quot;</span>

  <span class="ruby-identifier">w4</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w4</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving w4&quot;</span>

  <span class="ruby-identifier">w5</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Lancre&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w5</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w5 shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for name&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>], <span class="ruby-string">&quot;Should have uniqueness message for name&quot;</span>

  <span class="ruby-identifier">w6</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Mustrum Ridcully&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w6</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w6 shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:city</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for city&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:city</span>], <span class="ruby-string">&quot;Should have uniqueness message for city&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness">
            
              <b>test_validate_uniqueness</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness" name="method-i-test_validate_uniqueness" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_source')" id="l_method-i-test_validate_uniqueness_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L63" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m uniqué!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;Remaining unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should still save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m uniqué!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn&#39;t save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-string">&quot;Now I am really also unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should now save t2 as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_on_empty_relation">
            
              <b>test_validate_uniqueness_on_empty_relation</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_on_empty_relation" name="method-i-test_validate_uniqueness_on_empty_relation" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_on_empty_relation_source')" id="l_method-i-test_validate_uniqueness_on_empty_relation_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L427" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_on_empty_relation_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 427</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_on_empty_relation</span>
  <span class="ruby-identifier">topic</span> = <span class="ruby-constant">TopicWithUniqEvent</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">valid?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_on_existing_relation">
            
              <b>test_validate_uniqueness_on_existing_relation</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_on_existing_relation" name="method-i-test_validate_uniqueness_on_existing_relation" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_on_existing_relation_source')" id="l_method-i-test_validate_uniqueness_on_existing_relation_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L418" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_on_existing_relation_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 418</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_on_existing_relation</span>
  <span class="ruby-identifier">event</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-constant">TopicWithUniqEvent</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">event</span><span class="ruby-operator">:</span> <span class="ruby-identifier">event</span>).<span class="ruby-identifier">valid?</span>

  <span class="ruby-identifier">topic</span> = <span class="ruby-constant">TopicWithUniqEvent</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">event</span><span class="ruby-operator">:</span> <span class="ruby-identifier">event</span>)
  <span class="ruby-identifier">assert_not</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&#39;has already been taken&#39;</span>], <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:event</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_scoped_to_defining_class">
            
              <b>test_validate_uniqueness_scoped_to_defining_class</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_scoped_to_defining_class" name="method-i-test_validate_uniqueness_scoped_to_defining_class" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_scoped_to_defining_class_source')" id="l_method-i-test_validate_uniqueness_scoped_to_defining_class_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L178" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_scoped_to_defining_class_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 178</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_scoped_to_defining_class</span>
  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;What, me worry?&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a barrel of fun&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">silly_unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a barrel of fun&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2&quot;</span>

  <span class="ruby-comment"># Should succeed as validates_uniqueness_of only applies to</span>
  <span class="ruby-comment"># UniqueReply and its subclasses</span>
  <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a barrel of fun&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r3&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_when_integer_out_of_range">
            
              <b>test_validate_uniqueness_when_integer_out_of_range</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_when_integer_out_of_range" name="method-i-test_validate_uniqueness_when_integer_out_of_range" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_when_integer_out_of_range_source')" id="l_method-i-test_validate_uniqueness_when_integer_out_of_range_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L110" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_when_integer_out_of_range_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_when_integer_out_of_range</span>
  <span class="ruby-identifier">entry</span> = <span class="ruby-constant">BigIntTest</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">engines_count</span><span class="ruby-operator">:</span> <span class="ruby-constant">INT_MAX_VALUE</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:engines_count</span>], [<span class="ruby-string">&#39;is not included in the list&#39;</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter">
            
              <b>test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter" name="method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter_source')" id="l_method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L115" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_when_integer_out_of_range_show_order_does_not_matter</span>
  <span class="ruby-identifier">entry</span> = <span class="ruby-constant">BigIntReverseTest</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">engines_count</span><span class="ruby-operator">:</span> <span class="ruby-constant">INT_MAX_VALUE</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:engines_count</span>], [<span class="ruby-string">&#39;is not included in the list&#39;</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_alias_attribute">
            
              <b>test_validate_uniqueness_with_alias_attribute</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_alias_attribute" name="method-i-test_validate_uniqueness_with_alias_attribute" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_alias_attribute_source')" id="l_method-i-test_validate_uniqueness_with_alias_attribute_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L81" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_alias_attribute_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_alias_attribute</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">alias_attribute</span> <span class="ruby-value">:new_title</span>, <span class="ruby-value">:title</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:new_title</span>)

  <span class="ruby-identifier">topic</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">new_title</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;abc&#39;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">topic</span>.<span class="ruby-identifier">valid?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_array_column">
            
              <b>test_validate_uniqueness_with_array_column</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_array_column" name="method-i-test_validate_uniqueness_with_array_column" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_array_column_source')" id="l_method-i-test_validate_uniqueness_with_array_column_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L407" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_array_column_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 407</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_array_column</span>
  <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Employee</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;nicknames&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">&quot;john&quot;</span>, <span class="ruby-string">&quot;johnny&quot;</span>], <span class="ruby-string">&quot;commission_by_quarter&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-number">1000</span>, <span class="ruby-number">1200</span>])
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">persisted?</span>, <span class="ruby-string">&quot;Saving e1&quot;</span>

  <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Employee</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;nicknames&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-string">&quot;john&quot;</span>, <span class="ruby-string">&quot;johnny&quot;</span>], <span class="ruby-string">&quot;commission_by_quarter&quot;</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-number">2200</span>])
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">persisted?</span>, <span class="ruby-string">&quot;e2 shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:nicknames</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for nicknames&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">e2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:nicknames</span>], <span class="ruby-string">&quot;Should have uniqueness message for nicknames&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords">
            
              <b>test_validate_uniqueness_with_columns_which_are_sql_keywords</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords" name="method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords_source')" id="l_method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L334" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 334</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_columns_which_are_sql_keywords</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Guid</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-value">:key</span>
    <span class="ruby-identifier">g</span> = <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">g</span>.<span class="ruby-identifier">key</span> = <span class="ruby-string">&quot;foo&quot;</span>
    <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-operator">!</span><span class="ruby-identifier">g</span>.<span class="ruby-identifier">valid?</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_composed_attribute_scope">
            
              <b>test_validate_uniqueness_with_composed_attribute_scope</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_composed_attribute_scope" name="method-i-test_validate_uniqueness_with_composed_attribute_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_composed_attribute_scope_source')" id="l_method-i-test_validate_uniqueness_with_composed_attribute_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L158" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_composed_attribute_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 158</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_composed_attribute_scope</span>
  <span class="ruby-identifier">r1</span> = <span class="ruby-constant">ReplyWithTitleObject</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-constant">ReplyWithTitleObject</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2 first time&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_conditions">
            
              <b>test_validate_uniqueness_with_conditions</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_conditions" name="method-i-test_validate_uniqueness_with_conditions" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_conditions_source')" id="l_method-i-test_validate_uniqueness_with_conditions_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L388" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_conditions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 388</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_conditions</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-value">:title</span>, <span class="ruby-identifier">conditions</span><span class="ruby-operator">:</span> <span class="ruby-operator">-</span><span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">where</span>(<span class="ruby-identifier">approved</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>) }
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m a topic&quot;</span>, <span class="ruby-string">&quot;approved&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m an unapproved topic&quot;</span>, <span class="ruby-string">&quot;approved&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m a topic&quot;</span>, <span class="ruby-string">&quot;approved&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;t3 shouldn&#39;t be valid&quot;</span>

  <span class="ruby-identifier">t4</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m an unapproved topic&quot;</span>, <span class="ruby-string">&quot;approved&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t4</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;t4 should be valid&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_limit">
            
              <b>test_validate_uniqueness_with_limit</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_limit" name="method-i-test_validate_uniqueness_with_limit" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_limit_source')" id="l_method-i-test_validate_uniqueness_with_limit_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L343" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_limit_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 343</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_limit</span>
  <span class="ruby-comment"># Event.title is limited to 5 characters</span>
  <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;abcde&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Could not create an event with a unique, 5 character title&quot;</span>
  <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;abcdefgh&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_limit_and_utf8">
            
              <b>test_validate_uniqueness_with_limit_and_utf8</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_limit_and_utf8" name="method-i-test_validate_uniqueness_with_limit_and_utf8" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_limit_and_utf8_source')" id="l_method-i-test_validate_uniqueness_with_limit_and_utf8_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L351" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_limit_and_utf8_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 351</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_limit_and_utf8</span>
  <span class="ruby-comment"># Event.title is limited to 5 characters</span>
  <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;一二三四五&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Could not create an event with a unique, 5 character title&quot;</span>
  <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;一二三四五六七八&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported">
            
              <b>test_validate_uniqueness_with_non_callable_conditions_is_not_supported</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported" name="method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported_source')" id="l_method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L400" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_non_callable_conditions_is_not_supported_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 400</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_non_callable_conditions_is_not_supported</span>
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ArgumentError</span>) {
    <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-value">:title</span>, <span class="ruby-identifier">conditions</span><span class="ruby-operator">:</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">approved</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
  }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_non_standard_table_names">
            
              <b>test_validate_uniqueness_with_non_standard_table_names</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_non_standard_table_names" name="method-i-test_validate_uniqueness_with_non_standard_table_names" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_non_standard_table_names_source')" id="l_method-i-test_validate_uniqueness_with_non_standard_table_names_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L317" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_non_standard_table_names_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 317</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_non_standard_table_names</span>
  <span class="ruby-identifier">i1</span> = <span class="ruby-constant">WarehouseThing</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1000</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">i1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;i1 should not be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">i1</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:value</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should not be empty&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_object_arg">
            
              <b>test_validate_uniqueness_with_object_arg</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_object_arg" name="method-i-test_validate_uniqueness_with_object_arg" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_object_arg_source')" id="l_method-i-test_validate_uniqueness_with_object_arg_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L166" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_object_arg_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 166</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_object_arg</span>
  <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:topic</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2 first time&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_object_scope">
            
              <b>test_validate_uniqueness_with_object_scope</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_object_scope" name="method-i-test_validate_uniqueness_with_object_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_object_scope_source')" id="l_method-i-test_validate_uniqueness_with_object_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L146" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_object_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 146</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_object_scope</span>
  <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:content</span>, <span class="ruby-value">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:topic</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2 first time&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_scope">
            
              <b>test_validate_uniqueness_with_scope</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_scope" name="method-i-test_validate_uniqueness_with_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_scope_source')" id="l_method-i-test_validate_uniqueness_with_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L127" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 127</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_scope</span>
  <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:content</span>, <span class="ruby-value">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;parent_id&quot;</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2 first time&quot;</span>

  <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;something else&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r2 second time&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique too!&quot;</span>)
  <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r3&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r3&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_scope_array">
            
              <b>test_validate_uniqueness_with_scope_array</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_with_scope_array" name="method-i-test_validate_uniqueness_with_scope_array" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_scope_array_source')" id="l_method-i-test_validate_uniqueness_with_scope_array_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L193" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_scope_array_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 193</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_scope_array</span>
  <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:author_name</span>, <span class="ruby-value">:scope</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value">:author_email_address</span>, <span class="ruby-value">:parent_id</span>])

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;The earth is actually flat!&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy&quot;</span>, <span class="ruby-string">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You&#39;re crazy!&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Crazy reply&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy&quot;</span>, <span class="ruby-string">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You&#39;re crazy!&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Crazy reply again...&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2. Double reply by same author.&quot;</span>

  <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">author_email_address</span> = <span class="ruby-string">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r2 the second time.&quot;</span>

  <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy&quot;</span>, <span class="ruby-string">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>, <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You&#39;re wrong&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;It&#39;s cubic&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r3&quot;</span>

  <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-string">&quot;jj&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r3 the second time.&quot;</span>

  <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-string">&quot;jeremy&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r3 the third time.&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_without_primary_key">
            
              <b>test_validate_uniqueness_without_primary_key</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validate_uniqueness_without_primary_key" name="method-i-test_validate_uniqueness_without_primary_key" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_without_primary_key_source')" id="l_method-i-test_validate_uniqueness_without_primary_key_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L432" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_without_primary_key_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 432</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_without_primary_key</span>
  <span class="ruby-identifier">klass</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">table_name</span> = <span class="ruby-string">&quot;dashboards&quot;</span>

    <span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-value">:dashboard_id</span>

    <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">name</span>; <span class="ruby-string">&quot;Dashboard&quot;</span> <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">abc</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">dashboard_id</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;abc&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dashboard_id</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;xyz&quot;</span>).<span class="ruby-identifier">valid?</span>
  <span class="ruby-identifier">assert_not</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dashboard_id</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;abc&quot;</span>).<span class="ruby-identifier">valid?</span>

  <span class="ruby-identifier">abc</span>.<span class="ruby-identifier">dashboard_id</span> = <span class="ruby-string">&quot;def&quot;</span>

  <span class="ruby-identifier">e</span> = <span class="ruby-identifier">assert_raises</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">UnknownPrimaryKey</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">abc</span>.<span class="ruby-identifier">save!</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp">/\AUnknown primary key for table dashboards in model/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
  <span class="ruby-identifier">assert_match</span>(<span class="ruby-regexp">/Can not validate uniqueness for persisted record without primary key.\z/</span>, <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_inside_scoping">
            
              <b>test_validates_uniqueness_inside_scoping</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validates_uniqueness_inside_scoping" name="method-i-test_validates_uniqueness_inside_scoping" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_inside_scoping_source')" id="l_method-i-test_validates_uniqueness_inside_scoping_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L323" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_inside_scoping_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 323</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_inside_scoping</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>)

  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span>).<span class="ruby-identifier">scoping</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>, <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Mary&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t1</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I&#39;m unique!&quot;</span>, <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_with_newline_chars">
            
              <b>test_validates_uniqueness_with_newline_chars</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validates_uniqueness_with_newline_chars" name="method-i-test_validates_uniqueness_with_newline_chars" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_with_newline_chars_source')" id="l_method-i-test_validates_uniqueness_with_newline_chars_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L120" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_with_newline_chars_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 120</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_with_newline_chars</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;new\nline&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_with_nil_value">
            
              <b>test_validates_uniqueness_with_nil_value</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validates_uniqueness_with_nil_value" name="method-i-test_validates_uniqueness_with_nil_value" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_with_nil_value_source')" id="l_method-i-test_validates_uniqueness_with_nil_value_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L89" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_with_nil_value_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 89</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_with_nil_value</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn&#39;t be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn&#39;t save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_with_validates">
            
              <b>test_validates_uniqueness_with_validates</b>()
            
            <a href="../classes/UniquenessValidationTest.html#method-i-test_validates_uniqueness_with_validates" name="method-i-test_validates_uniqueness_with_validates" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_with_validates_source')" id="l_method-i-test_validates_uniqueness_with_validates_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/1d08b98055508d00844cd30cbb68a4afa38a77a1/activerecord/test/cases/validations/uniqueness_validation_test.rb#L101" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_with_validates_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/validations/uniqueness_validation_test.rb, line 101</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_with_validates</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates</span> <span class="ruby-value">:title</span>, <span class="ruby-value">:uniqueness</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-string">&#39;title&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;abc&#39;</span>)

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;title&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;abc&#39;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    