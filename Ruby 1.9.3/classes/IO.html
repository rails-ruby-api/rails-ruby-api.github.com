<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>IO</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            IO 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/file_c.html">file.c</a></li>
            
            <li><a href="../files/io_c.html">io.c</a></li>
            
            <li><a href="../files/lib/scanf_rb.html">lib/scanf.rb</a></li>
            
            <li><a href="../files/ext/io/console/console_c.html">ext/io/console/console.c</a></li>
            
            <li><a href="../files/ext/io/wait/wait_c.html">ext/io/wait/wait.c</a></li>
            
            <li><a href="../files/ext/pty/lib/expect_rb.html">ext/pty/lib/expect.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p><a href="Class.html">Class</a> <code>IO</code> is the basis for all input
and output in Ruby. An I/O stream may be <em>duplexed</em> (that is,
bidirectional), and so may use more than one native operating system
stream.</p>

<p>Many of the examples in this section use class <code>File</code>, the only
standard subclass of <code>IO</code>. The two classes are closely
associated.</p>

<p>As used in this section, <em>portname</em> may take any of the following
forms.</p>
<ul><li>
<p>A plain string represents a filename suitable for the underlying operating
system.</p>
</li><li>
<p>A string starting with “<code>|</code>” indicates a subprocess. The
remainder of the string following the “<code>|</code>” is invoked as a
process with appropriate input/output channels connected to it.</p>
</li><li>
<p>A string equal to “<code>|-</code>” will create another Ruby instance as a
subprocess.</p>
</li></ul>

<p>Ruby will convert pathnames between different operating system conventions
if possible. For instance, on a Windows system the filename
“<code>/gumby/ruby/test.rb</code>” will be opened as
“<code>\gumby\ruby\test.rb</code>”. When specifying a Windows-style
filename in a Ruby string, remember to escape the backslashes:</p>

<pre>&quot;c:\\gumby\\ruby\\test.rb&quot;</pre>

<p>Our examples here will use the Unix-style forward slashes;
<code>File::SEPARATOR</code> can be used to get the platform-specific
separator character.</p>

<p>I/O ports may be opened in any one of several different modes, which are
shown in this section as <em>mode</em>. The mode may either be a Fixnum or
a String. If numeric, it should be one of the operating system specific
constants (O_RDONLY, O_WRONLY, O_RDWR, O_APPEND and so on). See man open(2)
for more information.</p>

<p>If the mode is given as a String, it must be one of the values listed in
the following table.</p>

<pre>Mode |  Meaning
-----+--------------------------------------------------------
&quot;r&quot;  |  Read-only, starts at beginning of file  (default mode).
-----+--------------------------------------------------------
&quot;r+&quot; |  Read-write, starts at beginning of file.
-----+--------------------------------------------------------
&quot;w&quot;  |  Write-only, truncates existing file
     |  to zero length or creates a new file for writing.
-----+--------------------------------------------------------
&quot;w+&quot; |  Read-write, truncates existing file to zero length
     |  or creates a new file for reading and writing.
-----+--------------------------------------------------------
&quot;a&quot;  |  Write-only, starts at end of file if file exists,
     |  otherwise creates a new file for writing.
-----+--------------------------------------------------------
&quot;a+&quot; |  Read-write, starts at end of file if file exists,
     |  otherwise creates a new file for reading and
     |  writing.
-----+--------------------------------------------------------
 &quot;b&quot; |  Binary file mode (may appear with
     |  any of the key letters listed above).
     |  Suppresses EOL &lt;-&gt; CRLF conversion on Windows. And
     |  sets external encoding to ASCII-8BIT unless explicitly
     |  specified.
-----+--------------------------------------------------------
 &quot;t&quot; |  Text file mode (may appear with
     |  any of the key letters listed above except &quot;b&quot;).</pre>

<p>The global constant <a href="ARGF.html">ARGF</a> (also accessible as $&lt;)
provides an IO-like stream which allows access to all files mentioned on
the command line (or STDIN if no files are mentioned). <a
href="ARGF.html">ARGF</a> provides the methods <code>#path</code> and
<code>#filename</code> to access the name of the file currently being read.</p>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">MODULE</span>
          <a href="IO/WaitReadable.html">IO::WaitReadable</a>
        </li>
      
        <li>
          <span class="type">MODULE</span>
          <a href="IO/WaitWritable.html">IO::WaitWritable</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-3C-3C">&lt;&lt;</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-advise">advise</a>,
              </li>
            
              
              <li>
                <a href="#method-i-autoclose-3D">autoclose=</a>,
              </li>
            
              
              <li>
                <a href="#method-i-autoclose-3F">autoclose?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-binmode">binmode</a>,
              </li>
            
              
              <li>
                <a href="#method-i-binmode-3F">binmode?</a>,
              </li>
            
              
              <li>
                <a href="#method-c-binread">binread</a>,
              </li>
            
              
              <li>
                <a href="#method-c-binwrite">binwrite</a>,
              </li>
            
              
              <li>
                <a href="#method-i-bytes">bytes</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-chars">chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-close">close</a>,
              </li>
            
              
              <li>
                <a href="#method-i-close_on_exec-3D">close_on_exec=</a>,
              </li>
            
              
              <li>
                <a href="#method-i-close_on_exec-3F">close_on_exec?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-close_read">close_read</a>,
              </li>
            
              
              <li>
                <a href="#method-i-close_write">close_write</a>,
              </li>
            
              
              <li>
                <a href="#method-i-closed-3F">closed?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-codepoints">codepoints</a>,
              </li>
            
              
              <li>
                <a href="#method-c-console">console</a>,
              </li>
            
              
              <li>
                <a href="#method-c-copy_stream">copy_stream</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-each">each</a>,
              </li>
            
              
              <li>
                <a href="#method-i-each_byte">each_byte</a>,
              </li>
            
              
              <li>
                <a href="#method-i-each_char">each_char</a>,
              </li>
            
              
              <li>
                <a href="#method-i-each_codepoint">each_codepoint</a>,
              </li>
            
              
              <li>
                <a href="#method-i-each_line">each_line</a>,
              </li>
            
              
              <li>
                <a href="#method-i-echo-3D">echo=</a>,
              </li>
            
              
              <li>
                <a href="#method-i-echo-3F">echo?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-eof">eof</a>,
              </li>
            
              
              <li>
                <a href="#method-i-eof-3F">eof?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-expect">expect</a>,
              </li>
            
              
              <li>
                <a href="#method-i-external_encoding">external_encoding</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-fcntl">fcntl</a>,
              </li>
            
              
              <li>
                <a href="#method-i-fdatasync">fdatasync</a>,
              </li>
            
              
              <li>
                <a href="#method-i-fileno">fileno</a>,
              </li>
            
              
              <li>
                <a href="#method-i-flush">flush</a>,
              </li>
            
              
              <li>
                <a href="#method-c-for_fd">for_fd</a>,
              </li>
            
              
              <li>
                <a href="#method-c-foreach">foreach</a>,
              </li>
            
              
              <li>
                <a href="#method-i-fsync">fsync</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-getbyte">getbyte</a>,
              </li>
            
              
              <li>
                <a href="#method-i-getc">getc</a>,
              </li>
            
              
              <li>
                <a href="#method-i-getch">getch</a>,
              </li>
            
              
              <li>
                <a href="#method-i-gets">gets</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-iflush">iflush</a>,
              </li>
            
              
              <li>
                <a href="#method-i-inspect">inspect</a>,
              </li>
            
              
              <li>
                <a href="#method-i-internal_encoding">internal_encoding</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ioctl">ioctl</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ioflush">ioflush</a>,
              </li>
            
              
              <li>
                <a href="#method-i-isatty">isatty</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-lineno">lineno</a>,
              </li>
            
              
              <li>
                <a href="#method-i-lineno-3D">lineno=</a>,
              </li>
            
              
              <li>
                <a href="#method-i-lines">lines</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>,
              </li>
            
              
              <li>
                <a href="#method-i-noecho">noecho</a>,
              </li>
            
              
              <li>
                <a href="#method-i-nread">nread</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>O</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-oflush">oflush</a>,
              </li>
            
              
              <li>
                <a href="#method-c-open">open</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-pid">pid</a>,
              </li>
            
              
              <li>
                <a href="#method-c-pipe">pipe</a>,
              </li>
            
              
              <li>
                <a href="#method-c-popen">popen</a>,
              </li>
            
              
              <li>
                <a href="#method-i-pos">pos</a>,
              </li>
            
              
              <li>
                <a href="#method-i-pos-3D">pos=</a>,
              </li>
            
              
              <li>
                <a href="#method-i-print">print</a>,
              </li>
            
              
              <li>
                <a href="#method-i-printf">printf</a>,
              </li>
            
              
              <li>
                <a href="#method-i-putc">putc</a>,
              </li>
            
              
              <li>
                <a href="#method-i-puts">puts</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-raw">raw</a>,
              </li>
            
              
              <li>
                <a href="#method-i-raw-21">raw!</a>,
              </li>
            
              
              <li>
                <a href="#method-i-read">read</a>,
              </li>
            
              
              <li>
                <a href="#method-c-read">read</a>,
              </li>
            
              
              <li>
                <a href="#method-i-read_nonblock">read_nonblock</a>,
              </li>
            
              
              <li>
                <a href="#method-i-readbyte">readbyte</a>,
              </li>
            
              
              <li>
                <a href="#method-i-readchar">readchar</a>,
              </li>
            
              
              <li>
                <a href="#method-i-readline">readline</a>,
              </li>
            
              
              <li>
                <a href="#method-c-readlines">readlines</a>,
              </li>
            
              
              <li>
                <a href="#method-i-readlines">readlines</a>,
              </li>
            
              
              <li>
                <a href="#method-i-readpartial">readpartial</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ready-3F">ready?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-reopen">reopen</a>,
              </li>
            
              
              <li>
                <a href="#method-i-rewind">rewind</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-scanf">scanf</a>,
              </li>
            
              
              <li>
                <a href="#method-i-seek">seek</a>,
              </li>
            
              
              <li>
                <a href="#method-c-select">select</a>,
              </li>
            
              
              <li>
                <a href="#method-i-set_encoding">set_encoding</a>,
              </li>
            
              
              <li>
                <a href="#method-i-stat">stat</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sync">sync</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sync-3D">sync=</a>,
              </li>
            
              
              <li>
                <a href="#method-c-sysopen">sysopen</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sysread">sysread</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sysseek">sysseek</a>,
              </li>
            
              
              <li>
                <a href="#method-i-syswrite">syswrite</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-tell">tell</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_i">to_i</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_io">to_io</a>,
              </li>
            
              
              <li>
                <a href="#method-c-try_convert">try_convert</a>,
              </li>
            
              
              <li>
                <a href="#method-i-tty-3F">tty?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ungetbyte">ungetbyte</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ungetc">ungetc</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>W</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-wait">wait</a>,
              </li>
            
              
              <li>
                <a href="#method-i-winsize">winsize</a>,
              </li>
            
              
              <li>
                <a href="#method-i-winsize-3D">winsize=</a>,
              </li>
            
              
              <li>
                <a href="#method-i-write">write</a>,
              </li>
            
              
              <li>
                <a href="#method-c-write">write</a>,
              </li>
            
              
              <li>
                <a href="#method-i-write_nonblock">write_nonblock</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="File/Constants.html">
              File::Constants
            </a>
          
        </li>
      
        <li>
          
            <a href="Enumerable.html">
              Enumerable
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">SEEK_SET</td>
            <td>=</td>
            <td class="attr-value">INT2FIX(SEEK_SET)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">SEEK_CUR</td>
            <td>=</td>
            <td class="attr-value">INT2FIX(SEEK_CUR)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">SEEK_END</td>
            <td>=</td>
            <td class="attr-value">INT2FIX(SEEK_END)</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-binread">
            
              <a name="method-c-binread"></a><b>IO.binread(name, [length [, offset]] )   &rarr; string
</b>
            
          </div>
          
          
            <div class="description">
              <p>Opens the file, optionally seeks to the given <em>offset</em>, then returns
<em>length</em> bytes (defaulting to the rest of the file).
<code>binread</code> ensures the file is closed before returning. The open
mode would be “rb:ASCII-8BIT”.</p>

<pre class="ruby"><span class="ruby-constant">IO</span>.<span class="ruby-identifier">binread</span>(<span class="ruby-string">&quot;testfile&quot;</span>)           <span class="ruby-comment">#=&gt; &quot;This is line one\nThis is line two\nThis is line three\nAnd so on...\n&quot;</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">binread</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-value">20</span>)       <span class="ruby-comment">#=&gt; &quot;This is line one\nThi&quot;</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">binread</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-value">20</span>, <span class="ruby-value">10</span>)   <span class="ruby-comment">#=&gt; &quot;ne one\nThis is line &quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-binread_source')" id="l_method-c-binread_source">show</a>
                
              </p>
              <div id="method-c-binread_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_binread(int argc, VALUE *argv, VALUE io)
{
    VALUE offset;
    struct foreach_arg arg;

    rb_scan_args(argc, argv, &quot;12&quot;, NULL, NULL, &amp;offset);
    FilePathValue(argv[0]);
    arg.io = rb_io_open(argv[0], rb_str_new_cstr(&quot;rb:ASCII-8BIT&quot;), Qnil, Qnil);
    if (NIL_P(arg.io)) return Qnil;
    arg.argv = argv+1;
    arg.argc = (argc &gt; 1) ? 1 : 0;
    if (!NIL_P(offset)) {
        rb_io_seek(arg.io, offset, SEEK_SET);
    }
    return rb_ensure(io_s_read, (VALUE)&amp;arg, rb_io_close, arg.io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-binwrite">
            
              <a name="method-c-binwrite"></a><b>IO.binwrite(name, string, [offset] )   => fixnum
</b>
            
          </div>
          
          
            <div class="description">
              <p>Opens the file, optionally seeks to the given <em>offset</em>, write
<em>string</em> then returns the length written. <code>binwrite</code>
ensures the file is closed before returning. The open mode would be
“wb:ASCII-8BIT”. If <em>offset</em> is not given, the file is truncated. 
Otherwise, it is not truncated.</p>

<pre class="ruby"><span class="ruby-constant">IO</span>.<span class="ruby-identifier">binwrite</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-string">&quot;0123456789&quot;</span>)      <span class="ruby-comment">#=&gt; &quot;0123456789&quot;</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">binwrite</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-string">&quot;0123456789&quot;</span>, <span class="ruby-value">20</span>)  <span class="ruby-comment">#=&gt; &quot;This is line one\nThi0123456789two\nThis is line three\nAnd so on...\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-binwrite_source')" id="l_method-c-binwrite_source">show</a>
                
              </p>
              <div id="method-c-binwrite_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_binwrite(int argc, VALUE *argv, VALUE io)
{
    return io_s_write(argc, argv, 1);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-console">
            
              <a name="method-c-console"></a><b>IO.console      &rarr; #<File:/dev/tty>
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns an <a href="File.html">File</a> instance opened console.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-console_source')" id="l_method-c-console_source">show</a>
                
              </p>
              <div id="method-c-console_source" class="dyn-source">
                <pre>static VALUE
console_dev(VALUE klass)
{
    VALUE con = 0;
    rb_io_t *fptr;

    if (klass == rb_cIO) klass = rb_cFile;
    if (rb_const_defined(klass, id_console)) {
        con = rb_const_get(klass, id_console);
        if (TYPE(con) == T_FILE) {
            if ((fptr = RFILE(con)-&gt;fptr) &amp;&amp; GetReadFD(fptr) != -1)
                return con;
        }
        rb_mod_remove_const(klass, ID2SYM(id_console));
    }
    {
        VALUE args[2];
#if defined HAVE_TERMIOS_H || defined HAVE_TERMIO_H || defined HAVE_SGTTY_H
# define CONSOLE_DEVICE &quot;/dev/tty&quot;
#elif defined _WIN32
# define CONSOLE_DEVICE &quot;con$&quot;
# define CONSOLE_DEVICE_FOR_READING &quot;conin$&quot;
# define CONSOLE_DEVICE_FOR_WRITING &quot;conout$&quot;
#endif
#ifndef CONSOLE_DEVICE_FOR_READING
# define CONSOLE_DEVICE_FOR_READING CONSOLE_DEVICE
#endif
#ifdef CONSOLE_DEVICE_FOR_WRITING
        VALUE out;
        rb_io_t *ofptr;
#endif
        int fd, mode;

#ifdef CONSOLE_DEVICE_FOR_WRITING
        fd = open(CONSOLE_DEVICE_FOR_WRITING, O_WRONLY);
        if (fd &lt; 0) return Qnil;
        rb_update_max_fd(fd);
        args[1] = INT2FIX(O_WRONLY);
        args[0] = INT2NUM(fd);
        out = rb_class_new_instance(2, args, klass);
#endif
        fd = open(CONSOLE_DEVICE_FOR_READING, O_RDWR);
        if (fd &lt; 0) {
#ifdef CONSOLE_DEVICE_FOR_WRITING
            rb_io_close(out);
#endif
            return Qnil;
        }
        rb_update_max_fd(fd);
        args[1] = INT2FIX(O_RDWR);
        args[0] = INT2NUM(fd);
        con = rb_class_new_instance(2, args, klass);
        GetOpenFile(con, fptr);
        fptr-&gt;pathv = rb_obj_freeze(rb_str_new2(CONSOLE_DEVICE));
#ifdef CONSOLE_DEVICE_FOR_WRITING
        GetOpenFile(out, ofptr);
# ifdef HAVE_RB_IO_GET_WRITE_IO
        ofptr-&gt;pathv = fptr-&gt;pathv;
        fptr-&gt;tied_io_for_writing = out;
# else
        fptr-&gt;f2 = ofptr-&gt;f;
        ofptr-&gt;f = 0;
# endif
        ofptr-&gt;mode |= FMODE_SYNC;
#endif
        fptr-&gt;mode |= FMODE_SYNC;
        rb_const_set(klass, id_console, con);
    }
    return con;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-copy_stream">
            
              <a name="method-c-copy_stream"></a><b>IO.copy_stream(src, dst)
IO.copy_stream(src, dst, copy_length)
IO.copy_stream(src, dst, copy_length, src_offset)
</b>
            
          </div>
          
          
            <div class="description">
              <p><a href="IO.html#method-c-copy_stream">::copy_stream</a> copies
<em>src</em> to <em>dst</em>. <em>src</em> and <em>dst</em> is either a
filename or an <a href="IO.html">IO</a>.</p>

<p>This method returns the number of bytes copied.</p>

<p>If optional arguments are not given, the start position of the copy is the
beginning of the filename or the current file offset of the <a
href="IO.html">IO</a>. The end position of the copy is the end of file.</p>

<p>If <em>copy_length</em> is given, No more than <em>copy_length</em> bytes
are copied.</p>

<p>If <em>src_offset</em> is given, it specifies the start position of the
copy.</p>

<p>When <em>src_offset</em> is specified and <em>src</em> is an <a
href="IO.html">IO</a>, <a
href="IO.html#method-c-copy_stream">::copy_stream</a> doesn’t move the
current file offset.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-copy_stream_source')" id="l_method-c-copy_stream_source">show</a>
                
              </p>
              <div id="method-c-copy_stream_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_copy_stream(int argc, VALUE *argv, VALUE io)
{
    VALUE src, dst, length, src_offset;
    struct copy_stream_struct st;

    MEMZERO(&amp;st, struct copy_stream_struct, 1);

    rb_scan_args(argc, argv, &quot;22&quot;, &amp;src, &amp;dst, &amp;length, &amp;src_offset);

    st.src = src;
    st.dst = dst;

    if (NIL_P(length))
        st.copy_length = (off_t)-1;
    else
        st.copy_length = NUM2OFFT(length);

    if (NIL_P(src_offset))
        st.src_offset = (off_t)-1;
    else
        st.src_offset = NUM2OFFT(src_offset);

    rb_fd_init(&amp;st.fds);
    rb_ensure(copy_stream_body, (VALUE)&amp;st, copy_stream_finalize, (VALUE)&amp;st);

    return OFFT2NUM(st.total);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-for_fd">
            
              <a name="method-c-for_fd"></a><b>IO.for_fd(fd, mode [, opt])    &rarr; io
</b>
            
          </div>
          
          
            <div class="description">
              <p>Synonym for <code>IO.new</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-for_fd_source')" id="l_method-c-for_fd_source">show</a>
                
              </p>
              <div id="method-c-for_fd_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_for_fd(int argc, VALUE *argv, VALUE klass)
{
    VALUE io = rb_obj_alloc(klass);
    rb_io_initialize(argc, argv, io);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-foreach">
            
              <a name="method-c-foreach"></a><b>IO.foreach(name, sep=$/ [, open_args]) {|line| block }     &rarr; nil
IO.foreach(name, limit [, open_args]) {|line| block }      &rarr; nil
IO.foreach(name, sep, limit [, open_args]) {|line| block } &rarr; nil
IO.foreach(...)                                            &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Executes the block for every line in the named I/O port, where lines are
separated by <em>sep</em>.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-constant">IO</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-string">&quot;testfile&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;GOT &quot;</span>, <span class="ruby-identifier">x</span> }
</pre>

<p><em>produces:</em></p>

<pre>GOT This is line one
GOT This is line two
GOT This is line three
GOT And so on...</pre>

<p>If the last argument is a hash, it’s the keyword argument to open. See
<code>IO.read</code> for detail.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-foreach_source')" id="l_method-c-foreach_source">show</a>
                
              </p>
              <div id="method-c-foreach_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_foreach(int argc, VALUE *argv, VALUE self)
{
    VALUE opt;
    struct foreach_arg arg;

    argc = rb_scan_args(argc, argv, &quot;13:&quot;, NULL, NULL, NULL, NULL, &amp;opt);
    RETURN_ENUMERATOR(self, argc, argv);
    open_key_args(argc, argv, opt, &amp;arg);
    if (NIL_P(arg.io)) return Qnil;
    return rb_ensure(io_s_foreach, (VALUE)&amp;arg, rb_io_close, arg.io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>IO.new(fd [, mode] [, opt])   &rarr; io
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns a new <a href="IO.html">IO</a> object (a stream) for the given <a
href="IO.html">IO</a> object or integer file descriptor and mode string. 
See also <a href="IO.html#method-c-sysopen">::sysopen</a> and <a
href="IO.html#method-c-for_fd">::for_fd</a>.</p>

<h3 id="method-c-new-label-Parameters">Parameters</h3>
<dl class="rdoc-list note-list"><dt>fd
<dd>
<p>numeric file descriptor or <a href="IO.html">IO</a> object</p>
</dd><dt>mode
<dd>
<p>file mode. a string or an integer</p>
</dd><dt>opt
<dd>
<p>hash for specifying <code>mode</code> by name.</p>
</dd></dl>

<h4 id="method-c-new-label-Mode">Mode</h4>

<p>When mode is an integer it must be combination of the modes defined in <a
href="File/Constants.html">File::Constants</a>.</p>

<p>When mode is a string it must be in one of the following forms:</p>
<ul><li>
<p>“fmode”,</p>
</li><li>
<p>“fmode:extern”,</p>
</li><li>
<p>“fmode:extern:intern”.</p>
</li></ul>

<p><code>extern</code> is the external encoding name for the <a
href="IO.html">IO</a>. <code>intern</code> is the internal encoding.
<code>fmode</code> must be a file open mode string. See the description of
class <a href="IO.html">IO</a> for mode string directives.</p>

<p>When the mode of original <a href="IO.html">IO</a> is read only, the mode
cannot be changed to be writable.  Similarly, the mode cannot be changed
from write only to readable.</p>

<p>When such a change is attempted the error is raised in different locations
according to the platform.</p>

<h4 id="method-c-new-label-Options">Options</h4>

<p><code>opt</code> can have the following keys</p>
<dl class="rdoc-list note-list"><dt>:mode 
<dd>
<p>Same as <code>mode</code> parameter</p>
</dd><dt>:<a href="IO.html#method-i-external_encoding">#external_encoding</a> 
<dd>
<p>External encoding for the <a href="IO.html">IO</a>.  “-” is a synonym for
the default external encoding.</p>
</dd><dt>:<a href="IO.html#method-i-internal_encoding">#internal_encoding</a> 
<dd>
<p>Internal encoding for the <a href="IO.html">IO</a>.  “-” is a synonym for
the default internal encoding.</p>

<p>If the value is nil no conversion occurs.</p>
</dd><dt>:encoding 
<dd>
<p>Specifies external and internal encodings as “extern:intern”.</p>
</dd><dt>:textmode 
<dd>
<p>If the value is truth value, same as “t” in argument <code>mode</code>.</p>
</dd><dt>:binmode 
<dd>
<p>If the value is truth value, same as “b” in argument <code>mode</code>.</p>
</dd><dt>:autoclose 
<dd>
<p>If the value is <code>false</code>, the <code>fd</code> will be kept open
after this <a href="IO.html">IO</a> instance gets finalized.</p>
</dd></dl>

<p>Also <code>opt</code> can have same keys in <a
href="String.html#method-i-encode">String#encode</a> for controlling
conversion between the external encoding and the internal encoding.</p>

<h3 id="method-c-new-label-Example+1">Example 1</h3>

<pre>fd = IO.sysopen(&quot;/dev/tty&quot;, &quot;w&quot;)
a = IO.new(fd,&quot;w&quot;)
$stderr.puts &quot;Hello&quot;
a.puts &quot;World&quot;</pre>

<p><em>produces:</em></p>

<pre>Hello
World</pre>

<h3 id="method-c-new-label-Example+2">Example 2</h3>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">'fcntl'</span>

<span class="ruby-identifier">fd</span> = <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">fcntl</span>(<span class="ruby-constant">Fcntl</span><span class="ruby-operator">::</span><span class="ruby-constant">F_DUPFD</span>)
<span class="ruby-identifier">io</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">fd</span>, <span class="ruby-identifier">mode</span><span class="ruby-operator">:</span> <span class="ruby-string">'w:UTF-16LE'</span>, <span class="ruby-identifier">cr_newline</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
<span class="ruby-identifier">io</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Hello, World!&quot;</span>

<span class="ruby-identifier">fd</span> = <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">fcntl</span>(<span class="ruby-constant">Fcntl</span><span class="ruby-operator">::</span><span class="ruby-constant">F_DUPFD</span>)
<span class="ruby-identifier">io</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">fd</span>, <span class="ruby-identifier">mode</span><span class="ruby-operator">:</span> <span class="ruby-string">'w'</span>, <span class="ruby-identifier">cr_newline</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
            <span class="ruby-identifier">external_encoding</span><span class="ruby-operator">:</span> <span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF_16LE</span>)
<span class="ruby-identifier">io</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Hello, World!&quot;</span>
</pre>

<p>Both of above print “Hello, World!” in UTF-16LE to standard error output
with converting EOL generated by <code>puts</code> to CR.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre>static VALUE
rb_io_initialize(int argc, VALUE *argv, VALUE io)
{
    VALUE fnum, vmode;
    rb_io_t *fp;
    int fd, fmode, oflags = O_RDONLY;
    convconfig_t convconfig;
    VALUE opt;
#if defined(HAVE_FCNTL) &amp;&amp; defined(F_GETFL)
    int ofmode;
#else
    struct stat st;
#endif

    rb_secure(4);

    argc = rb_scan_args(argc, argv, &quot;11:&quot;, &amp;fnum, &amp;vmode, &amp;opt);
    rb_io_extract_modeenc(&amp;vmode, 0, opt, &amp;oflags, &amp;fmode, &amp;convconfig);

    fd = NUM2INT(fnum);
    if (rb_reserved_fd_p(fd)) {
        rb_raise(rb_eArgError, &quot;The given fd is not accessible because RubyVM reserves it&quot;);
    }
#if defined(HAVE_FCNTL) &amp;&amp; defined(F_GETFL)
    oflags = fcntl(fd, F_GETFL);
    if (oflags == -1) rb_sys_fail(0);
#else
    if (fstat(fd, &amp;st) == -1) rb_sys_fail(0);
#endif
    rb_update_max_fd(fd);
#if defined(HAVE_FCNTL) &amp;&amp; defined(F_GETFL)
    ofmode = rb_io_oflags_fmode(oflags);
    if (NIL_P(vmode)) {
        fmode = ofmode;
    }
    else if ((~ofmode &amp; fmode) &amp; FMODE_READWRITE) {
        VALUE error = INT2FIX(EINVAL);
        rb_exc_raise(rb_class_new_instance(1, &amp;error, rb_eSystemCallError));
    }
#endif
    if (!NIL_P(opt) &amp;&amp; rb_hash_aref(opt, sym_autoclose) == Qfalse) {
        fmode |= FMODE_PREP;
    }
    MakeOpenFile(io, fp);
    fp-&gt;fd = fd;
    fp-&gt;mode = fmode;
    fp-&gt;encs = convconfig;
    clear_codeconv(fp);
    io_check_tty(fp);
    if (fileno(stdin) == fd)
        fp-&gt;stdio_file = stdin;
    else if (fileno(stdout) == fd)
        fp-&gt;stdio_file = stdout;
    else if (fileno(stderr) == fd)
        fp-&gt;stdio_file = stderr;

    if (fmode &amp; FMODE_SETENC_BY_BOM) io_set_encoding_by_bom(io);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-open">
            
              <a name="method-c-open"></a><b>IO.open(fd, mode_string="r" [, opt])               &rarr; io
IO.open(fd, mode_string="r" [, opt]) {|io| block } &rarr; obj
</b>
            
          </div>
          
          
            <div class="description">
              <p>With no associated block, <code>IO.open</code> is a synonym for <a
href="IO.html#method-c-new">::new</a>. If the optional code block is given,
it will be passed <code>io</code> as an argument, and the <a
href="IO.html">IO</a> object will automatically be closed when the block
terminates. In this instance, <a href="IO.html#method-c-open">::open</a>
returns the value of the block.</p>

<p>See <a href="IO.html#method-c-new">::new</a> for a description of values
for the <code>opt</code> parameter.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-open_source')" id="l_method-c-open_source">show</a>
                
              </p>
              <div id="method-c-open_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_open(int argc, VALUE *argv, VALUE klass)
{
    VALUE io = rb_class_new_instance(argc, argv, klass);

    if (rb_block_given_p()) {
        return rb_ensure(rb_yield, io, io_close, io);
    }

    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-pipe">
            
              <a name="method-c-pipe"></a><b>IO.pipe                             &rarr;  [read_io, write_io]
IO.pipe(ext_enc)                    &rarr;  [read_io, write_io]
IO.pipe("ext_enc:int_enc" [, opt])  &rarr;  [read_io, write_io]
IO.pipe(ext_enc, int_enc [, opt])   &rarr;  [read_io, write_io]
IO.pipe(...) {|read_io, write_io| ... }
</b>
            
          </div>
          
          
            <div class="description">
              <p>Creates a pair of pipe endpoints (connected to each other) and returns them
as a two-element array of <code>IO</code> objects: <code>[</code>
<em>read_io</em>, <em>write_io</em> <code>]</code>.</p>

<p>If a block is given, the block is called and returns the value of the
block. <em>read_io</em> and <em>write_io</em> are sent to the block as
arguments. If read_io and write_io are not closed when the block exits,
they are closed. i.e. closing read_io and/or write_io doesn’t cause an
error.</p>

<p>Not available on all platforms.</p>

<p>If an encoding (encoding name or encoding object) is specified as an
optional argument, read string from pipe is tagged with the encoding
specified. If the argument is a colon separated two encoding names “A:B”,
the read string is converted from encoding A (external encoding) to
encoding B (internal encoding), then tagged with B. If two optional
arguments are specified, those must be encoding objects or encoding names,
and the first one is the external encoding, and the second one is the
internal encoding. If the external encoding and the internal encoding is
specified, optional hash argument specify the conversion option.</p>

<p>In the example below, the two processes close the ends of the pipe that
they are not using. This is not just a cosmetic nicety. The read end of a
pipe will not generate an end of file condition if there are any writers
with the pipe still open. In the case of the parent process, the
<code>rd.read</code> will never return if it does not first issue a
<code>wr.close</code>.</p>

<pre>rd, wr = IO.pipe

if fork
  wr.close
  puts &quot;Parent got: &lt;#{rd.read}&gt;&quot;
  rd.close
  Process.wait
else
  rd.close
  puts &quot;Sending message to parent&quot;
  wr.write &quot;Hi Dad&quot;
  wr.close
end</pre>

<p><em>produces:</em></p>

<pre>Sending message to parent
Parent got: &lt;Hi Dad&gt;</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-pipe_source')" id="l_method-c-pipe_source">show</a>
                
              </p>
              <div id="method-c-pipe_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_pipe(int argc, VALUE *argv, VALUE klass)
{
    int pipes[2], state;
    VALUE r, w, args[3], v1, v2;
    VALUE opt;
    rb_io_t *fptr, *fptr2;
    int fmode = 0;
    VALUE ret;

    argc = rb_scan_args(argc, argv, &quot;02:&quot;, &amp;v1, &amp;v2, &amp;opt);
    if (rb_pipe(pipes) == -1)
        rb_sys_fail(0);

    args[0] = klass;
    args[1] = INT2NUM(pipes[0]);
    args[2] = INT2FIX(O_RDONLY);
    r = rb_protect(io_new_instance, (VALUE)args, &amp;state);
    if (state) {
        close(pipes[0]);
        close(pipes[1]);
        rb_jump_tag(state);
    }
    GetOpenFile(r, fptr);
    io_encoding_set(fptr, v1, v2, opt);
    args[1] = INT2NUM(pipes[1]);
    args[2] = INT2FIX(O_WRONLY);
    w = rb_protect(io_new_instance, (VALUE)args, &amp;state);
    if (state) {
        close(pipes[1]);
        if (!NIL_P(r)) rb_io_close(r);
        rb_jump_tag(state);
    }
    GetOpenFile(w, fptr2);
    rb_io_synchronized(fptr2);

    extract_binmode(opt, &amp;fmode);
#if DEFAULT_TEXTMODE
    if ((fptr-&gt;mode &amp; FMODE_TEXTMODE) &amp;&amp; (fmode &amp; FMODE_BINMODE))
        fptr-&gt;mode &amp;= ~FMODE_TEXTMODE;
#endif
    fptr-&gt;mode |= fmode;
#if DEFAULT_TEXTMODE
    if ((fptr2-&gt;mode &amp; FMODE_TEXTMODE) &amp;&amp; (fmode &amp; FMODE_BINMODE))
        fptr2-&gt;mode &amp;= ~FMODE_TEXTMODE;
#endif
    fptr2-&gt;mode |= fmode;

    ret = rb_assoc_new(r, w);
    if (rb_block_given_p()) {
        VALUE rw[2];
        rw[0] = r;
        rw[1] = w;
        return rb_ensure(rb_yield, ret, pipe_pair_close, (VALUE)rw);
    }
    return ret;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-popen">
            
              <a name="method-c-popen"></a><b>IO.popen(cmd, mode="r" [, opt])               &rarr; io
IO.popen(cmd, mode="r" [, opt]) {|io| block } &rarr; obj
</b>
            
          </div>
          
          
            <div class="description">
              <p>Runs the specified command as a subprocess; the subprocess’s standard input
and output will be connected to the returned <code>IO</code> object.</p>

<p>The PID of the started process can be obtained by <a
href="IO.html#method-i-pid">#pid</a> method.</p>

<p><em>cmd</em> is a string or an array as follows.</p>

<pre>cmd:
  &quot;-&quot;                                      : fork
  commandline                              : command line string which is passed to a shell
  [env, cmdname, arg1, ..., opts]          : command name and zero or more arguments (no shell)
  [env, [cmdname, argv0], arg1, ..., opts] : command name, argv[0] and zero or more arguments (no shell)
(env and opts are optional.)</pre>

<p>If <em>cmd</em> is a <code>String</code> “<code>-</code>”, then a new
instance of Ruby is started as the subprocess.</p>

<p>If <em>cmd</em> is an <code>Array</code> of <code>String</code>, then it
will be used as the subprocess’s <code>argv</code> bypassing a shell. The
array can contains a hash at first for environments and a hash at last for
options similar to <code>spawn</code>.</p>

<p>The default mode for the new file object is “r”, but <em>mode</em> may be
set to any of the modes listed in the description for class <a
href="IO.html">IO</a>. The last argument <em>opt</em> qualifies
<em>mode</em>.</p>

<pre class="ruby"><span class="ruby-comment"># set IO encoding</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-string">&quot;nkf -e filename&quot;</span>, :<span class="ruby-identifier">external_encoding=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;EUC-JP&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">nkf_io</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">euc_jp_string</span> = <span class="ruby-identifier">nkf_io</span>.<span class="ruby-identifier">read</span>
}

<span class="ruby-comment"># merge standard output and standard error using</span>
<span class="ruby-comment"># spawn option.  See the document of Kernel.spawn.</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>([<span class="ruby-string">&quot;ls&quot;</span>, <span class="ruby-string">&quot;/&quot;</span>, :<span class="ruby-identifier">err=</span><span class="ruby-operator">&gt;</span>[:<span class="ruby-identifier">child</span>, :<span class="ruby-identifier">out</span>]]) {<span class="ruby-operator">|</span><span class="ruby-identifier">ls_io</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">ls_result_with_error</span> = <span class="ruby-identifier">ls_io</span>.<span class="ruby-identifier">read</span>
}
</pre>

<p>Raises exceptions which <code>IO.pipe</code> and <code>Kernel.spawn</code>
raise.</p>

<p>If a block is given, Ruby will run the command as a child connected to Ruby
with a pipe. Ruby’s end of the pipe will be passed as a parameter to the
block. At the end of block, Ruby close the pipe and sets <code>$?</code>.
In this case <code>IO.popen</code> returns the value of the block.</p>

<p>If a block is given with a <em>cmd</em> of “<code>-</code>”, the block will
be run in two separate processes: once in the parent, and once in a child.
The parent process will be passed the pipe object as a parameter to the
block, the child version of the block will be passed <code>nil</code>, and
the child’s standard in and standard out will be connected to the parent
through the pipe. Not available on all platforms.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-string">&quot;uname&quot;</span>)
<span class="ruby-identifier">p</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Parent is #{Process.pid}&quot;</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-string">&quot;date&quot;</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span> }
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-string">&quot;-&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{Process.pid} is here, f is #{f.inspect}&quot;</span>}
<span class="ruby-identifier">p</span> <span class="ruby-identifier">$?</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-node">%wsed -e s|^|&lt;foo&gt;| -e s&amp;$&amp;;zot;&amp;&quot;</span>, <span class="ruby-string">&quot;r+&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;bar&quot;</span>; <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_write</span>; <span class="ruby-identifier">puts</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>
}
</pre>

<p><em>produces:</em></p>

<pre>[&quot;Linux\n&quot;]
Parent is 21346
Thu Jan 15 22:41:19 JST 2009
21346 is here, f is #&lt;IO:fd 3&gt;
21352 is here, f is nil
#&lt;Process::Status: pid 21352 exit 0&gt;
&lt;foo&gt;bar;zot;</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-popen_source')" id="l_method-c-popen_source">show</a>
                
              </p>
              <div id="method-c-popen_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_popen(int argc, VALUE *argv, VALUE klass)
{
    const char *modestr;
    VALUE pname, pmode, port, tmp, opt;
    int oflags, fmode;
    convconfig_t convconfig;

    argc = rb_scan_args(argc, argv, &quot;11:&quot;, &amp;pname, &amp;pmode, &amp;opt);

    rb_io_extract_modeenc(&amp;pmode, 0, opt, &amp;oflags, &amp;fmode, &amp;convconfig);
    modestr = rb_io_oflags_modestr(oflags);

    tmp = rb_check_array_type(pname);
    if (!NIL_P(tmp)) {
        long len = RARRAY_LEN(tmp);
#if SIZEOF_LONG &gt; SIZEOF_INT
        if (len &gt; INT_MAX) {
            rb_raise(rb_eArgError, &quot;too many arguments&quot;);
        }
#endif
        tmp = rb_ary_dup(tmp);
        RBASIC(tmp)-&gt;klass = 0;
        port = pipe_open_v((int)len, RARRAY_PTR(tmp), modestr, fmode, &amp;convconfig);
        rb_ary_clear(tmp);
    }
    else {
        SafeStringValue(pname);
        port = pipe_open_s(pname, modestr, fmode, &amp;convconfig);
    }
    if (NIL_P(port)) {
        /* child */
        if (rb_block_given_p()) {
            rb_yield(Qnil);
            rb_io_flush(rb_stdout);
            rb_io_flush(rb_stderr);
            _exit(0);
        }
        return Qnil;
    }
    RBASIC(port)-&gt;klass = klass;
    if (rb_block_given_p()) {
        return rb_ensure(rb_yield, port, io_close, port);
    }
    return port;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-read">
            
              <a name="method-c-read"></a><b>IO.read(name, [length [, offset]] )   &rarr; string
IO.read(name, [length [, offset]], open_args)   &rarr; string
</b>
            
          </div>
          
          
            <div class="description">
              <p>Opens the file, optionally seeks to the given <em>offset</em>, then returns
<em>length</em> bytes (defaulting to the rest of the file).
<code>read</code> ensures the file is closed before returning.</p>

<p>If the last argument is a hash, it specifies option for internal open(). 
The key would be the following.  open_args: is exclusive to others.</p>

<pre class="ruby"><span class="ruby-identifier">encoding</span><span class="ruby-operator">:</span> <span class="ruby-identifier">string</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">encoding</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">encoding</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">read</span> <span class="ruby-identifier">string</span>.  <span class="ruby-identifier">encoding</span> <span class="ruby-identifier">will</span> <span class="ruby-identifier">be</span> <span class="ruby-identifier">ignored</span>
 <span class="ruby-keyword">if</span> <span class="ruby-identifier">length</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">specified</span>.

<span class="ruby-identifier">mode</span><span class="ruby-operator">:</span> <span class="ruby-identifier">string</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">mode</span> <span class="ruby-identifier">argument</span> <span class="ruby-keyword">for</span> <span class="ruby-identifier">open</span>().  <span class="ruby-identifier">it</span> <span class="ruby-identifier">should</span> <span class="ruby-identifier">start</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;r&quot;</span>
 <span class="ruby-identifier">otherwise</span> <span class="ruby-identifier">it</span> <span class="ruby-identifier">would</span> <span class="ruby-identifier">cause</span> <span class="ruby-identifier">error</span>.

<span class="ruby-identifier">open_args</span><span class="ruby-operator">:</span> <span class="ruby-identifier">array</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">strings</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">arguments</span> <span class="ruby-keyword">for</span> <span class="ruby-identifier">open</span>() <span class="ruby-identifier">as</span> <span class="ruby-identifier">an</span> <span class="ruby-identifier">array</span>.

  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">read</span>(<span class="ruby-string">&quot;testfile&quot;</span>)           <span class="ruby-comment">#=&gt; &quot;This is line one\nThis is line two\nThis is line three\nAnd so on...\n&quot;</span>
  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">read</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-value">20</span>)       <span class="ruby-comment">#=&gt; &quot;This is line one\nThi&quot;</span>
  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">read</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-value">20</span>, <span class="ruby-value">10</span>)   <span class="ruby-comment">#=&gt; &quot;ne one\nThis is line &quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-read_source')" id="l_method-c-read_source">show</a>
                
              </p>
              <div id="method-c-read_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_read(int argc, VALUE *argv, VALUE io)
{
    VALUE opt, offset;
    struct foreach_arg arg;

    argc = rb_scan_args(argc, argv, &quot;13:&quot;, NULL, NULL, &amp;offset, NULL, &amp;opt);
    open_key_args(argc, argv, opt, &amp;arg);
    if (NIL_P(arg.io)) return Qnil;
    if (!NIL_P(offset)) {
        struct seek_arg sarg;
        int state = 0;
        sarg.io = arg.io;
        sarg.offset = offset;
        sarg.mode = SEEK_SET;
        rb_protect(seek_before_access, (VALUE)&amp;sarg, &amp;state);
        if (state) {
            rb_io_close(arg.io);
            rb_jump_tag(state);
        }
        if (arg.argc == 2) arg.argc = 1;
    }
    return rb_ensure(io_s_read, (VALUE)&amp;arg, rb_io_close, arg.io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-readlines">
            
              <a name="method-c-readlines"></a><b>IO.readlines(name, sep=$/ [, open_args])     &rarr; array
IO.readlines(name, limit [, open_args])      &rarr; array
IO.readlines(name, sep, limit [, open_args]) &rarr; array
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads the entire file specified by <em>name</em> as individual lines, and
returns those lines in an array. Lines are separated by <em>sep</em>.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
</pre>

<p>If the last argument is a hash, it’s the keyword argument to open. See
<code>IO.read</code> for detail.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-readlines_source')" id="l_method-c-readlines_source">show</a>
                
              </p>
              <div id="method-c-readlines_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_readlines(int argc, VALUE *argv, VALUE io)
{
    VALUE opt;
    struct foreach_arg arg;

    argc = rb_scan_args(argc, argv, &quot;13:&quot;, NULL, NULL, NULL, NULL, &amp;opt);
    open_key_args(argc, argv, opt, &amp;arg);
    if (NIL_P(arg.io)) return Qnil;
    return rb_ensure(io_s_readlines, (VALUE)&amp;arg, rb_io_close, arg.io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-select">
            
              <a name="method-c-select"></a><b>IO.select(read_array
[, write_array
[, error_array
[, timeout]]]) &rarr; array  or  nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Calls select(2) system call. It monitors given arrays of <code>IO</code>
objects, waits one or more of <code>IO</code> objects ready for reading,
are ready for writing, and have pending exceptions respectably, and returns
an array that contains arrays of those <a href="IO.html">IO</a> objects. 
It will return <code>nil</code> if optional <em>timeout</em> value is given
and no <code>IO</code> object is ready in <em>timeout</em> seconds.</p>

<h3 id="method-c-select-label-Parameters">Parameters</h3>
<dl class="rdoc-list note-list"><dt>read_array
<dd>
<p>an array of <code>IO</code> objects that wait until ready for read</p>
</dd><dt>write_array
<dd>
<p>an array of <code>IO</code> objects that wait until ready for write</p>
</dd><dt>error_array
<dd>
<p>an array of <code>IO</code> objects that wait for exceptions</p>
</dd><dt>timeout
<dd>
<p>a numeric value in second</p>
</dd></dl>

<h3 id="method-c-select-label-Example">Example</h3>

<pre>rp, wp = IO.pipe
mesg = &quot;ping &quot;
100.times {
  rs, ws, = IO.select([rp], [wp])
  if r = rs[0]
    ret = r.read(5)
    print ret
    case ret
    when /ping/
      mesg = &quot;pong\n&quot;
    when /pong/
      mesg = &quot;ping &quot;
    end
  end
  if w = ws[0]
    w.write(mesg)
  end
}</pre>

<p><em>produces:</em></p>

<pre>ping pong
ping pong
ping pong
(snipped)
ping</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-select_source')" id="l_method-c-select_source">show</a>
                
              </p>
              <div id="method-c-select_source" class="dyn-source">
                <pre>static VALUE
rb_f_select(int argc, VALUE *argv, VALUE obj)
{
    VALUE timeout;
    struct select_args args;
    struct timeval timerec;
    int i;

    rb_scan_args(argc, argv, &quot;13&quot;, &amp;args.read, &amp;args.write, &amp;args.except, &amp;timeout);
    if (NIL_P(timeout)) {
        args.timeout = 0;
    }
    else {
        timerec = rb_time_interval(timeout);
        args.timeout = &amp;timerec;
    }

    for (i = 0; i &lt; numberof(args.fdsets); ++i)
        rb_fd_init(&amp;args.fdsets[i]);

    return rb_ensure(select_call, (VALUE)&amp;args, select_end, (VALUE)&amp;args);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-sysopen">
            
              <a name="method-c-sysopen"></a><b>IO.sysopen(path, [mode, [perm]])  &rarr; fixnum
</b>
            
          </div>
          
          
            <div class="description">
              <p>Opens the given path, returning the underlying file descriptor as a
<code>Fixnum</code>.</p>

<pre class="ruby"><span class="ruby-constant">IO</span>.<span class="ruby-identifier">sysopen</span>(<span class="ruby-string">&quot;testfile&quot;</span>)   <span class="ruby-comment">#=&gt; 3</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-sysopen_source')" id="l_method-c-sysopen_source">show</a>
                
              </p>
              <div id="method-c-sysopen_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_sysopen(int argc, VALUE *argv)
{
    VALUE fname, vmode, vperm;
    VALUE intmode;
    int oflags, fd;
    mode_t perm;

    rb_scan_args(argc, argv, &quot;12&quot;, &amp;fname, &amp;vmode, &amp;vperm);
    FilePathValue(fname);

    if (NIL_P(vmode))
        oflags = O_RDONLY;
    else if (!NIL_P(intmode = rb_check_to_integer(vmode, &quot;to_int&quot;)))
        oflags = NUM2INT(intmode);
    else {
        SafeStringValue(vmode);
        oflags = rb_io_modestr_oflags(StringValueCStr(vmode));
    }
    if (NIL_P(vperm)) perm = 0666;
    else              perm = NUM2MODET(vperm);

    RB_GC_GUARD(fname) = rb_str_new4(fname);
    fd = rb_sysopen(fname, oflags, perm);
    return INT2NUM(fd);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-try_convert">
            
              <a name="method-c-try_convert"></a><b>IO.try_convert(obj)  &rarr;  io or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Try to convert <em>obj</em> into an <a href="IO.html">IO</a>, using <a
href="IO.html#method-i-to_io">#to_io</a> method. Returns converted <a
href="IO.html">IO</a> or nil if <em>obj</em> cannot be converted for any
reason.</p>

<pre class="ruby"><span class="ruby-constant">IO</span>.<span class="ruby-identifier">try_convert</span>(<span class="ruby-constant">STDOUT</span>)     <span class="ruby-comment">#=&gt; STDOUT</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">try_convert</span>(<span class="ruby-string">&quot;STDOUT&quot;</span>)   <span class="ruby-comment">#=&gt; nil</span>

<span class="ruby-identifier">require</span> <span class="ruby-string">'zlib'</span>
<span class="ruby-identifier">f</span> = <span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;/tmp/zz.gz&quot;</span>)       <span class="ruby-comment">#=&gt; #&lt;File:/tmp/zz.gz&gt;</span>
<span class="ruby-identifier">z</span> = <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">GzipReader</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">f</span>) <span class="ruby-comment">#=&gt; #&lt;Zlib::GzipReader:0x81d8744&gt;</span>
<span class="ruby-constant">IO</span>.<span class="ruby-identifier">try_convert</span>(<span class="ruby-identifier">z</span>)            <span class="ruby-comment">#=&gt; #&lt;File:/tmp/zz.gz&gt;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-try_convert_source')" id="l_method-c-try_convert_source">show</a>
                
              </p>
              <div id="method-c-try_convert_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_try_convert(VALUE dummy, VALUE io)
{
    return rb_io_check_io(io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-write">
            
              <a name="method-c-write"></a><b>IO.write(name, string, [offset] )   => fixnum
IO.write(name, string, [offset], open_args )   => fixnum
</b>
            
          </div>
          
          
            <div class="description">
              <p>Opens the file, optionally seeks to the given <em>offset</em>, writes
<em>string</em>, then returns the length written. <code>write</code>
ensures the file is closed before returning. If <em>offset</em> is not
given, the file is truncated.  Otherwise, it is not truncated.</p>

<p>If the last argument is a hash, it specifies option for internal open(). 
The key would be the following.  open_args: is exclusive to others.</p>

<pre class="ruby"><span class="ruby-identifier">encoding</span><span class="ruby-operator">:</span> <span class="ruby-identifier">string</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">encoding</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">encoding</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">read</span> <span class="ruby-identifier">string</span>.  <span class="ruby-identifier">encoding</span> <span class="ruby-identifier">will</span> <span class="ruby-identifier">be</span> <span class="ruby-identifier">ignored</span>
 <span class="ruby-keyword">if</span> <span class="ruby-identifier">length</span> <span class="ruby-identifier">is</span> <span class="ruby-identifier">specified</span>.

<span class="ruby-identifier">mode</span><span class="ruby-operator">:</span> <span class="ruby-identifier">string</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">mode</span> <span class="ruby-identifier">argument</span> <span class="ruby-keyword">for</span> <span class="ruby-identifier">open</span>().  <span class="ruby-identifier">it</span> <span class="ruby-identifier">should</span> <span class="ruby-identifier">start</span> <span class="ruby-identifier">with</span> <span class="ruby-string">&quot;w&quot;</span> <span class="ruby-keyword">or</span> <span class="ruby-string">&quot;a&quot;</span> <span class="ruby-keyword">or</span> <span class="ruby-string">&quot;r+&quot;</span>
 <span class="ruby-identifier">otherwise</span> <span class="ruby-identifier">it</span> <span class="ruby-identifier">would</span> <span class="ruby-identifier">cause</span> <span class="ruby-identifier">error</span>.

<span class="ruby-identifier">perm</span><span class="ruby-operator">:</span> <span class="ruby-identifier">fixnum</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">perm</span> <span class="ruby-identifier">argument</span> <span class="ruby-keyword">for</span> <span class="ruby-identifier">open</span>().

<span class="ruby-identifier">open_args</span><span class="ruby-operator">:</span> <span class="ruby-identifier">array</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">strings</span>

 <span class="ruby-identifier">specifies</span> <span class="ruby-identifier">arguments</span> <span class="ruby-keyword">for</span> <span class="ruby-identifier">open</span>() <span class="ruby-identifier">as</span> <span class="ruby-identifier">an</span> <span class="ruby-identifier">array</span>.

  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-string">&quot;0123456789&quot;</span>)      <span class="ruby-comment">#=&gt; &quot;0123456789&quot;</span>
  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;testfile&quot;</span>, <span class="ruby-string">&quot;0123456789&quot;</span>, <span class="ruby-value">20</span>)  <span class="ruby-comment">#=&gt; &quot;This is line one\nThi0123456789two\nThis is line three\nAnd so on...\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-write_source')" id="l_method-c-write_source">show</a>
                
              </p>
              <div id="method-c-write_source" class="dyn-source">
                <pre>static VALUE
rb_io_s_write(int argc, VALUE *argv, VALUE io)
{
    return io_s_write(argc, argv, 0);
}</pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-3C-3C">
            
              <a name="method-i-3C-3C"></a><b>ios << obj     &rarr; ios
</b>
            
          </div>
          
          
            <div class="description">
              <p>String Output—Writes <em>obj</em> to <em>ios</em>. <em>obj</em> will be
converted to a string using <code>to_s</code>.</p>

<pre>$stdout &lt;&lt; &quot;Hello &quot; &lt;&lt; &quot;world!\n&quot;</pre>

<p><em>produces:</em></p>

<pre>Hello world!</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-3C-3C_source')" id="l_method-i-3C-3C_source">show</a>
                
              </p>
              <div id="method-i-3C-3C_source" class="dyn-source">
                <pre>VALUE
rb_io_addstr(VALUE io, VALUE str)
{
    rb_io_write(io, str);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-advise">
            
              <a name="method-i-advise"></a><b>ios.advise(advice, offset=0, len=0) &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <pre>Announce an intention to access data from the current file in a
specific pattern. On platforms that do not support the
&lt;em&gt;posix_fadvise(2)&lt;/em&gt; system call, this method is a no-op.</pre>

<p><em>advice</em> is one of the following symbols:</p>

<pre>* :normal - No advice to give; the default assumption for an open file.
* :sequential - The data will be accessed sequentially:
   with lower offsets read before higher ones.
* :random - The data will be accessed in random order.
* :willneed - The data will be accessed in the near future.
* :dontneed - The data will not be accessed in the near future.
* :noreuse - The data will only be accessed once.</pre>

<p>The semantics of a piece of advice are platform-dependent. See <em>man 2
posix_fadvise</em> for details.</p>

<pre>&quot;data&quot; means the region of the current file that begins at
_offset_ and extends for _len_ bytes. If _len_ is 0, the region
ends at the last byte of the file. By default, both _offset_ and
_len_ are 0, meaning that the advice applies to the entire file.

If an error occurs, one of the following exceptions will be raised:

* &lt;code&gt;IOError&lt;/code&gt; - The &lt;code&gt;IO&lt;/code&gt; stream is closed.
* &lt;code&gt;Errno::EBADF&lt;/code&gt; - The file descriptor of the current file is
  invalid.
* &lt;code&gt;Errno::EINVAL&lt;/code&gt; - An invalid value for _advice_ was given.
* &lt;code&gt;Errno::ESPIPE&lt;/code&gt; - The file descriptor of the current
* file refers to a FIFO or pipe. (Linux raises &lt;code&gt;Errno::EINVAL&lt;/code&gt;
* in this case).
* &lt;code&gt;TypeError&lt;/code&gt; - Either _advice_ was not a Symbol, or one of the
  other arguments was not an &lt;code&gt;Integer&lt;/code&gt;.
* &lt;code&gt;RangeError&lt;/code&gt; - One of the arguments given was too big/small.</pre>
<dl class="rdoc-list note-list"><dt>This list is not exhaustive; other <a href="Errno.html">Errno</a>
<dd>
<p>exceptions are also possible.</p>
</dd></dl>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-advise_source')" id="l_method-i-advise_source">show</a>
                
              </p>
              <div id="method-i-advise_source" class="dyn-source">
                <pre>static VALUE
rb_io_advise(int argc, VALUE *argv, VALUE io)
{
    VALUE advice, offset, len;
    off_t off, l;
    rb_io_t *fptr;

    rb_scan_args(argc, argv, &quot;12&quot;, &amp;advice, &amp;offset, &amp;len);
    advice_arg_check(advice);

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    off = NIL_P(offset) ? 0 : NUM2OFFT(offset);
    l   = NIL_P(len)    ? 0 : NUM2OFFT(len);

#ifdef HAVE_POSIX_FADVISE
    return do_io_advise(fptr, advice, off, l);
#else
    /* Ignore all hint */
    return Qnil;
#endif
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-autoclose-3D">
            
              <a name="method-i-autoclose-3D"></a><b>io.autoclose = bool    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Sets auto-close flag.</p>

<pre>f = open(&quot;/dev/null&quot;)
IO.for_fd(f.fileno)
# ...
f.gets # may cause IOError

f = open(&quot;/dev/null&quot;)
IO.for_fd(f.fileno).autoclose = true
# ...
f.gets # won't cause IOError</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-autoclose-3D_source')" id="l_method-i-autoclose-3D_source">show</a>
                
              </p>
              <div id="method-i-autoclose-3D_source" class="dyn-source">
                <pre>static VALUE
rb_io_set_autoclose(VALUE io, VALUE autoclose)
{
    rb_io_t *fptr;
    rb_secure(4);
    GetOpenFile(io, fptr);
    if (!RTEST(autoclose))
        fptr-&gt;mode |= FMODE_PREP;
    else
        fptr-&gt;mode &amp;= ~FMODE_PREP;
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-autoclose-3F">
            
              <a name="method-i-autoclose-3F"></a><b>ios.autoclose?   &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if the underlying file descriptor of <em>ios</em>
will be closed automatically at its finalization, otherwise
<code>false</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-autoclose-3F_source')" id="l_method-i-autoclose-3F_source">show</a>
                
              </p>
              <div id="method-i-autoclose-3F_source" class="dyn-source">
                <pre>static VALUE
rb_io_autoclose_p(VALUE io)
{
    rb_io_t *fptr;
    rb_secure(4);
    GetOpenFile(io, fptr);
    return (fptr-&gt;mode &amp; FMODE_PREP) ? Qfalse : Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-binmode">
            
              <a name="method-i-binmode"></a><b>ios.binmode    &rarr; ios
</b>
            
          </div>
          
          
            <div class="description">
              <p>Puts <em>ios</em> into binary mode. Once a stream is in binary mode, it
cannot be reset to nonbinary mode.</p>
<ul><li>
<p>newline conversion disabled</p>
</li><li>
<p>encoding conversion disabled</p>
</li><li>
<p>content is treated as ASCII-8BIT</p>
</li></ul>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-binmode_source')" id="l_method-i-binmode_source">show</a>
                
              </p>
              <div id="method-i-binmode_source" class="dyn-source">
                <pre>static VALUE
rb_io_binmode_m(VALUE io)
{
    VALUE write_io;

    rb_io_ascii8bit_binmode(io);

    write_io = GetWriteIO(io);
    if (write_io != io)
        rb_io_ascii8bit_binmode(write_io);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-binmode-3F">
            
              <a name="method-i-binmode-3F"></a><b>ios.binmode?    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if <em>ios</em> is binmode.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-binmode-3F_source')" id="l_method-i-binmode-3F_source">show</a>
                
              </p>
              <div id="method-i-binmode-3F_source" class="dyn-source">
                <pre>static VALUE
rb_io_binmode_p(VALUE io)
{
    rb_io_t *fptr;
    GetOpenFile(io, fptr);
    return fptr-&gt;mode &amp; FMODE_BINMODE ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-bytes">
            
              <a name="method-i-bytes"></a><b>ios.bytes {|byte| block }      &rarr; ios
ios.bytes                      &rarr; an_enumerator
ios.each_byte {|byte| block }  &rarr; ios
ios.each_byte                  &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Calls the given block once for each byte (0..255) in <em>ios</em>, passing
the byte as an argument. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">checksum</span> = <span class="ruby-value">0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each_byte</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">checksum</span> <span class="ruby-operator">^=</span> <span class="ruby-identifier">x</span> }   <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
<span class="ruby-identifier">checksum</span>                           <span class="ruby-comment">#=&gt; 12</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-bytes_source')" id="l_method-i-bytes_source">show</a>
                
              </p>
              <div id="method-i-bytes_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_byte(VALUE io)
{
    rb_io_t *fptr;
    char *p, *e;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);

    for (;;) {
        while (fptr-&gt;rbuf.len &gt; 0) {
            p = fptr-&gt;rbuf.ptr + fptr-&gt;rbuf.off++;
            e = p + fptr-&gt;rbuf.len--;
            rb_yield(INT2FIX(*p &amp; 0xff));
            errno = 0;
        }
        rb_io_check_byte_readable(fptr);
        READ_CHECK(fptr);
        if (io_fillbuf(fptr) &lt; 0) {
            break;
        }
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-chars">
            
              <a name="method-i-chars"></a><b>ios.chars {|c| block }      &rarr; ios
ios.chars                   &rarr; an_enumerator
ios.each_char {|c| block }  &rarr; ios
ios.each_char               &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Calls the given block once for each character in <em>ios</em>, passing the
character as an argument. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each_char</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">print</span> <span class="ruby-identifier">c</span>, <span class="ruby-string">' '</span> }   <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-chars_source')" id="l_method-i-chars_source">show</a>
                
              </p>
              <div id="method-i-chars_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_char(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;
    VALUE c;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    enc = io_input_encoding(fptr);
    READ_CHECK(fptr);
    while (!NIL_P(c = io_getc(fptr, enc))) {
        rb_yield(c);
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-close">
            
              <a name="method-i-close"></a><b>ios.close   &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Closes <em>ios</em> and flushes any pending writes to the operating system.
The stream is unavailable for any further data operations; an
<code>IOError</code> is raised if such an attempt is made. I/O streams are
automatically closed when they are claimed by the garbage collector.</p>

<p>If <em>ios</em> is opened by <code>IO.popen</code>, <code>close</code> sets
<code>$?</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-close_source')" id="l_method-i-close_source">show</a>
                
              </p>
              <div id="method-i-close_source" class="dyn-source">
                <pre>static VALUE
rb_io_close_m(VALUE io)
{
    if (rb_safe_level() &gt;= 4 &amp;&amp; !OBJ_UNTRUSTED(io)) {
        rb_raise(rb_eSecurityError, &quot;Insecure: can't close&quot;);
    }
    rb_io_check_closed(RFILE(io)-&gt;fptr);
    rb_io_close(io);
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-close_on_exec-3D">
            
              <a name="method-i-close_on_exec-3D"></a><b>ios.close_on_exec = bool    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Sets a close-on-exec flag.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;/dev/null&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_on_exec</span> = <span class="ruby-keyword">true</span>
<span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;cat&quot;</span>, <span class="ruby-node">&quot;/proc/self/fd/#{f.fileno}&quot;</span>) <span class="ruby-comment"># cat: /proc/self/fd/3: No such file or directory</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">closed?</span>                <span class="ruby-comment">#=&gt; false</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-close_on_exec-3D_source')" id="l_method-i-close_on_exec-3D_source">show</a>
                
              </p>
              <div id="method-i-close_on_exec-3D_source" class="dyn-source">
                <pre>static VALUE
rb_io_set_close_on_exec(VALUE io, VALUE arg)
{
    int flag = RTEST(arg) ? FD_CLOEXEC : 0;
    rb_io_t *fptr;
    VALUE write_io;
    int fd, ret;

    write_io = GetWriteIO(io);
    if (io != write_io) {
        GetOpenFile(write_io, fptr);
        if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
            if ((ret = fcntl(fptr-&gt;fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
            if ((ret &amp; FD_CLOEXEC) != flag) {
                ret = (ret &amp; ~FD_CLOEXEC) | flag;
                ret = fcntl(fd, F_SETFD, ret);
                if (ret == -1) rb_sys_fail_path(fptr-&gt;pathv);
            }
        }

    }

    GetOpenFile(io, fptr);
    if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
        if ((ret = fcntl(fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
        if ((ret &amp; FD_CLOEXEC) != flag) {
            ret = (ret &amp; ~FD_CLOEXEC) | flag;
            ret = fcntl(fd, F_SETFD, ret);
            if (ret == -1) rb_sys_fail_path(fptr-&gt;pathv);
        }
    }
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-close_on_exec-3F">
            
              <a name="method-i-close_on_exec-3F"></a><b>ios.close_on_exec?   &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if <em>ios</em> will be closed on exec.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;/dev/null&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_on_exec?</span>                 <span class="ruby-comment">#=&gt; false</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_on_exec</span> = <span class="ruby-keyword">true</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_on_exec?</span>                 <span class="ruby-comment">#=&gt; true</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_on_exec</span> = <span class="ruby-keyword">false</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_on_exec?</span>                 <span class="ruby-comment">#=&gt; false</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-close_on_exec-3F_source')" id="l_method-i-close_on_exec-3F_source">show</a>
                
              </p>
              <div id="method-i-close_on_exec-3F_source" class="dyn-source">
                <pre>static VALUE
rb_io_close_on_exec_p(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;
    int fd, ret;

    write_io = GetWriteIO(io);
    if (io != write_io) {
        GetOpenFile(write_io, fptr);
        if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
            if ((ret = fcntl(fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
            if (!(ret &amp; FD_CLOEXEC)) return Qfalse;
        }
    }

    GetOpenFile(io, fptr);
    if (fptr &amp;&amp; 0 &lt;= (fd = fptr-&gt;fd)) {
        if ((ret = fcntl(fd, F_GETFD)) == -1) rb_sys_fail_path(fptr-&gt;pathv);
        if (!(ret &amp; FD_CLOEXEC)) return Qfalse;
    }
    return Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-close_read">
            
              <a name="method-i-close_read"></a><b>ios.close_read    &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Closes the read end of a duplex I/O stream (i.e., one that contains both a
read and a write stream, such as a pipe). Will raise an
<code>IOError</code> if the stream is not duplexed.</p>

<pre>f = IO.popen(&quot;/bin/sh&quot;,&quot;r+&quot;)
f.close_read
f.readlines</pre>

<p><em>produces:</em></p>

<pre>prog.rb:3:in `readlines': not opened for reading (IOError)
 from prog.rb:3</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-close_read_source')" id="l_method-i-close_read_source">show</a>
                
              </p>
              <div id="method-i-close_read_source" class="dyn-source">
                <pre>static VALUE
rb_io_close_read(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;

    if (rb_safe_level() &gt;= 4 &amp;&amp; !OBJ_UNTRUSTED(io)) {
        rb_raise(rb_eSecurityError, &quot;Insecure: can't close&quot;);
    }
    GetOpenFile(io, fptr);
    if (is_socket(fptr-&gt;fd, fptr-&gt;pathv)) {
#ifndef SHUT_RD
# define SHUT_RD 0
#endif
        if (shutdown(fptr-&gt;fd, SHUT_RD) &lt; 0)
            rb_sys_fail_path(fptr-&gt;pathv);
        fptr-&gt;mode &amp;= ~FMODE_READABLE;
        if (!(fptr-&gt;mode &amp; FMODE_WRITABLE))
            return rb_io_close(io);
        return Qnil;
    }

    write_io = GetWriteIO(io);
    if (io != write_io) {
        rb_io_t *wfptr;
        rb_io_fptr_cleanup(fptr, FALSE);
        GetOpenFile(write_io, wfptr);
        RFILE(io)-&gt;fptr = wfptr;
        RFILE(write_io)-&gt;fptr = NULL;
        rb_io_fptr_finalize(fptr);
        return Qnil;
    }

    if (fptr-&gt;mode &amp; FMODE_WRITABLE) {
        rb_raise(rb_eIOError, &quot;closing non-duplex IO for reading&quot;);
    }
    return rb_io_close(io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-close_write">
            
              <a name="method-i-close_write"></a><b>ios.close_write   &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Closes the write end of a duplex I/O stream (i.e., one that contains both a
read and a write stream, such as a pipe). Will raise an
<code>IOError</code> if the stream is not duplexed.</p>

<pre>f = IO.popen(&quot;/bin/sh&quot;,&quot;r+&quot;)
f.close_write
f.print &quot;nowhere&quot;</pre>

<p><em>produces:</em></p>

<pre>prog.rb:3:in `write': not opened for writing (IOError)
 from prog.rb:3:in `print'
 from prog.rb:3</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-close_write_source')" id="l_method-i-close_write_source">show</a>
                
              </p>
              <div id="method-i-close_write_source" class="dyn-source">
                <pre>static VALUE
rb_io_close_write(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;

    if (rb_safe_level() &gt;= 4 &amp;&amp; !OBJ_UNTRUSTED(io)) {
        rb_raise(rb_eSecurityError, &quot;Insecure: can't close&quot;);
    }
    write_io = GetWriteIO(io);
    GetOpenFile(write_io, fptr);
    if (is_socket(fptr-&gt;fd, fptr-&gt;pathv)) {
#ifndef SHUT_WR
# define SHUT_WR 1
#endif
        if (shutdown(fptr-&gt;fd, SHUT_WR) &lt; 0)
            rb_sys_fail_path(fptr-&gt;pathv);
        fptr-&gt;mode &amp;= ~FMODE_WRITABLE;
        if (!(fptr-&gt;mode &amp; FMODE_READABLE))
            return rb_io_close(write_io);
        return Qnil;
    }

    if (fptr-&gt;mode &amp; FMODE_READABLE) {
        rb_raise(rb_eIOError, &quot;closing non-duplex IO for writing&quot;);
    }

    rb_io_close(write_io);
    if (io != write_io) {
        GetOpenFile(io, fptr);
        fptr-&gt;tied_io_for_writing = 0;
        fptr-&gt;mode &amp;= ~FMODE_DUPLEX;
    }
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-closed-3F">
            
              <a name="method-i-closed-3F"></a><b>ios.closed?    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if <em>ios</em> is completely closed (for duplex
streams, both reader and writer), <code>false</code> otherwise.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>         <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">closed?</span>       <span class="ruby-comment">#=&gt; true</span>
<span class="ruby-identifier">f</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-string">&quot;/bin/sh&quot;</span>,<span class="ruby-string">&quot;r+&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_write</span>   <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">closed?</span>       <span class="ruby-comment">#=&gt; false</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">close_read</span>    <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">closed?</span>       <span class="ruby-comment">#=&gt; true</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-closed-3F_source')" id="l_method-i-closed-3F_source">show</a>
                
              </p>
              <div id="method-i-closed-3F_source" class="dyn-source">
                <pre>static VALUE
rb_io_closed(VALUE io)
{
    rb_io_t *fptr;
    VALUE write_io;
    rb_io_t *write_fptr;

    write_io = GetWriteIO(io);
    if (io != write_io) {
        write_fptr = RFILE(write_io)-&gt;fptr;
        if (write_fptr &amp;&amp; 0 &lt;= write_fptr-&gt;fd) {
            return Qfalse;
        }
    }

    fptr = RFILE(io)-&gt;fptr;
    rb_io_check_initialized(fptr);
    return 0 &lt;= fptr-&gt;fd ? Qfalse : Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-codepoints">
            
              <a name="method-i-codepoints"></a><b>ios.each_codepoint {|c| block }  &rarr; ios
ios.codepoints     {|c| block }  &rarr; ios
ios.each_codepoint               &rarr; an_enumerator
ios.codepoints                   &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Passes the <code>Integer</code> ordinal of each character in <em>ios</em>,
passing the codepoint as an argument. The stream must be opened for reading
or an <code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-codepoints_source')" id="l_method-i-codepoints_source">show</a>
                
              </p>
              <div id="method-i-codepoints_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_codepoint(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;
    unsigned int c;
    int r, n;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    READ_CHECK(fptr);
    if (NEED_READCONV(fptr)) {
        for (;;) {
            make_readconv(fptr, 0);
            for (;;) {
                if (fptr-&gt;cbuf.len) {
                    if (fptr-&gt;encs.enc)
                        r = rb_enc_precise_mbclen(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
                                                  fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off+fptr-&gt;cbuf.len,
                                                  fptr-&gt;encs.enc);
                    else
                        r = ONIGENC_CONSTRUCT_MBCLEN_CHARFOUND(1);
                    if (!MBCLEN_NEEDMORE_P(r))
                        break;
                    if (fptr-&gt;cbuf.len == fptr-&gt;cbuf.capa) {
                        rb_raise(rb_eIOError, &quot;too long character&quot;);
                    }
                }
                if (more_char(fptr) == MORE_CHAR_FINISHED) {
                    clear_readconv(fptr);
                    /* ignore an incomplete character before EOF */
                    return io;
                }
            }
            if (MBCLEN_INVALID_P(r)) {
                rb_raise(rb_eArgError, &quot;invalid byte sequence in %s&quot;,
                         rb_enc_name(fptr-&gt;encs.enc));
            }
            n = MBCLEN_CHARFOUND_LEN(r);
            if (fptr-&gt;encs.enc) {
                c = rb_enc_codepoint(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
                                     fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off+fptr-&gt;cbuf.len,
                                     fptr-&gt;encs.enc);
            }
            else {
                c = (unsigned char)fptr-&gt;cbuf.ptr[fptr-&gt;cbuf.off];
            }
            fptr-&gt;cbuf.off += n;
            fptr-&gt;cbuf.len -= n;
            rb_yield(UINT2NUM(c));
        }
    }
    enc = io_input_encoding(fptr);
    for (;;) {
        if (io_fillbuf(fptr) &lt; 0) {
            return io;
        }
        r = rb_enc_precise_mbclen(fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off,
                                  fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off+fptr-&gt;rbuf.len, enc);
        if (MBCLEN_CHARFOUND_P(r) &amp;&amp;
            (n = MBCLEN_CHARFOUND_LEN(r)) &lt;= fptr-&gt;rbuf.len) {
            c = rb_enc_codepoint(fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off,
                                 fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off+fptr-&gt;rbuf.len, enc);
            fptr-&gt;rbuf.off += n;
            fptr-&gt;rbuf.len -= n;
            rb_yield(UINT2NUM(c));
        }
        else if (MBCLEN_INVALID_P(r)) {
            rb_raise(rb_eArgError, &quot;invalid byte sequence in %s&quot;, rb_enc_name(enc));
        }
        else {
            continue;
        }
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-each">
            
              <a name="method-i-each"></a><b>ios.each(sep=$/) {|line| block }         &rarr; ios
ios.each(limit) {|line| block }          &rarr; ios
ios.each(sep,limit) {|line| block }      &rarr; ios
ios.each(...)                            &rarr; an_enumerator
ios.each_line(sep=$/) {|line| block }    &rarr; ios
ios.each_line(limit) {|line| block }     &rarr; ios
ios.each_line(sep,limit) {|line| block } &rarr; ios
ios.each_line(...)                       &rarr; an_enumerator
ios.lines(sep=$/) {|line| block }        &rarr; ios
ios.lines(limit) {|line| block }         &rarr; ios
ios.lines(sep,limit) {|line| block }     &rarr; ios
ios.lines(...)                           &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Executes the block for every line in <em>ios</em>, where lines are
separated by <em>sep</em>. <em>ios</em> must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{f.lineno}: #{line}&quot;</span> }
</pre>

<p><em>produces:</em></p>

<pre>1: This is line one
2: This is line two
3: This is line three
4: And so on...</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-each_source')" id="l_method-i-each_source">show</a>
                
              </p>
              <div id="method-i-each_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_line(int argc, VALUE *argv, VALUE io)
{
    VALUE str, rs;
    long limit;

    RETURN_ENUMERATOR(io, argc, argv);
    prepare_getline_args(argc, argv, &amp;rs, &amp;limit, io);
    if (limit == 0)
        rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    while (!NIL_P(str = rb_io_getline_1(rs, limit, io))) {
        rb_yield(str);
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-each_byte">
            
              <a name="method-i-each_byte"></a><b>ios.bytes {|byte| block }      &rarr; ios
ios.bytes                      &rarr; an_enumerator
ios.each_byte {|byte| block }  &rarr; ios
ios.each_byte                  &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Calls the given block once for each byte (0..255) in <em>ios</em>, passing
the byte as an argument. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">checksum</span> = <span class="ruby-value">0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each_byte</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">checksum</span> <span class="ruby-operator">^=</span> <span class="ruby-identifier">x</span> }   <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
<span class="ruby-identifier">checksum</span>                           <span class="ruby-comment">#=&gt; 12</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-each_byte_source')" id="l_method-i-each_byte_source">show</a>
                
              </p>
              <div id="method-i-each_byte_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_byte(VALUE io)
{
    rb_io_t *fptr;
    char *p, *e;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);

    for (;;) {
        while (fptr-&gt;rbuf.len &gt; 0) {
            p = fptr-&gt;rbuf.ptr + fptr-&gt;rbuf.off++;
            e = p + fptr-&gt;rbuf.len--;
            rb_yield(INT2FIX(*p &amp; 0xff));
            errno = 0;
        }
        rb_io_check_byte_readable(fptr);
        READ_CHECK(fptr);
        if (io_fillbuf(fptr) &lt; 0) {
            break;
        }
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-each_char">
            
              <a name="method-i-each_char"></a><b>ios.chars {|c| block }      &rarr; ios
ios.chars                   &rarr; an_enumerator
ios.each_char {|c| block }  &rarr; ios
ios.each_char               &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Calls the given block once for each character in <em>ios</em>, passing the
character as an argument. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each_char</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">print</span> <span class="ruby-identifier">c</span>, <span class="ruby-string">' '</span> }   <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-each_char_source')" id="l_method-i-each_char_source">show</a>
                
              </p>
              <div id="method-i-each_char_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_char(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;
    VALUE c;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    enc = io_input_encoding(fptr);
    READ_CHECK(fptr);
    while (!NIL_P(c = io_getc(fptr, enc))) {
        rb_yield(c);
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-each_codepoint">
            
              <a name="method-i-each_codepoint"></a><b>ios.each_codepoint {|c| block }  &rarr; ios
ios.codepoints     {|c| block }  &rarr; ios
ios.each_codepoint               &rarr; an_enumerator
ios.codepoints                   &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Passes the <code>Integer</code> ordinal of each character in <em>ios</em>,
passing the codepoint as an argument. The stream must be opened for reading
or an <code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-each_codepoint_source')" id="l_method-i-each_codepoint_source">show</a>
                
              </p>
              <div id="method-i-each_codepoint_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_codepoint(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;
    unsigned int c;
    int r, n;

    RETURN_ENUMERATOR(io, 0, 0);
    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    READ_CHECK(fptr);
    if (NEED_READCONV(fptr)) {
        for (;;) {
            make_readconv(fptr, 0);
            for (;;) {
                if (fptr-&gt;cbuf.len) {
                    if (fptr-&gt;encs.enc)
                        r = rb_enc_precise_mbclen(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
                                                  fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off+fptr-&gt;cbuf.len,
                                                  fptr-&gt;encs.enc);
                    else
                        r = ONIGENC_CONSTRUCT_MBCLEN_CHARFOUND(1);
                    if (!MBCLEN_NEEDMORE_P(r))
                        break;
                    if (fptr-&gt;cbuf.len == fptr-&gt;cbuf.capa) {
                        rb_raise(rb_eIOError, &quot;too long character&quot;);
                    }
                }
                if (more_char(fptr) == MORE_CHAR_FINISHED) {
                    clear_readconv(fptr);
                    /* ignore an incomplete character before EOF */
                    return io;
                }
            }
            if (MBCLEN_INVALID_P(r)) {
                rb_raise(rb_eArgError, &quot;invalid byte sequence in %s&quot;,
                         rb_enc_name(fptr-&gt;encs.enc));
            }
            n = MBCLEN_CHARFOUND_LEN(r);
            if (fptr-&gt;encs.enc) {
                c = rb_enc_codepoint(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
                                     fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off+fptr-&gt;cbuf.len,
                                     fptr-&gt;encs.enc);
            }
            else {
                c = (unsigned char)fptr-&gt;cbuf.ptr[fptr-&gt;cbuf.off];
            }
            fptr-&gt;cbuf.off += n;
            fptr-&gt;cbuf.len -= n;
            rb_yield(UINT2NUM(c));
        }
    }
    enc = io_input_encoding(fptr);
    for (;;) {
        if (io_fillbuf(fptr) &lt; 0) {
            return io;
        }
        r = rb_enc_precise_mbclen(fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off,
                                  fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off+fptr-&gt;rbuf.len, enc);
        if (MBCLEN_CHARFOUND_P(r) &amp;&amp;
            (n = MBCLEN_CHARFOUND_LEN(r)) &lt;= fptr-&gt;rbuf.len) {
            c = rb_enc_codepoint(fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off,
                                 fptr-&gt;rbuf.ptr+fptr-&gt;rbuf.off+fptr-&gt;rbuf.len, enc);
            fptr-&gt;rbuf.off += n;
            fptr-&gt;rbuf.len -= n;
            rb_yield(UINT2NUM(c));
        }
        else if (MBCLEN_INVALID_P(r)) {
            rb_raise(rb_eArgError, &quot;invalid byte sequence in %s&quot;, rb_enc_name(enc));
        }
        else {
            continue;
        }
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-each_line">
            
              <a name="method-i-each_line"></a><b>ios.each(sep=$/) {|line| block }         &rarr; ios
ios.each(limit) {|line| block }          &rarr; ios
ios.each(sep,limit) {|line| block }      &rarr; ios
ios.each(...)                            &rarr; an_enumerator
ios.each_line(sep=$/) {|line| block }    &rarr; ios
ios.each_line(limit) {|line| block }     &rarr; ios
ios.each_line(sep,limit) {|line| block } &rarr; ios
ios.each_line(...)                       &rarr; an_enumerator
ios.lines(sep=$/) {|line| block }        &rarr; ios
ios.lines(limit) {|line| block }         &rarr; ios
ios.lines(sep,limit) {|line| block }     &rarr; ios
ios.lines(...)                           &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Executes the block for every line in <em>ios</em>, where lines are
separated by <em>sep</em>. <em>ios</em> must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{f.lineno}: #{line}&quot;</span> }
</pre>

<p><em>produces:</em></p>

<pre>1: This is line one
2: This is line two
3: This is line three
4: And so on...</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-each_line_source')" id="l_method-i-each_line_source">show</a>
                
              </p>
              <div id="method-i-each_line_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_line(int argc, VALUE *argv, VALUE io)
{
    VALUE str, rs;
    long limit;

    RETURN_ENUMERATOR(io, argc, argv);
    prepare_getline_args(argc, argv, &amp;rs, &amp;limit, io);
    if (limit == 0)
        rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    while (!NIL_P(str = rb_io_getline_1(rs, limit, io))) {
        rb_yield(str);
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-echo-3D">
            
              <a name="method-i-echo-3D"></a><b>io.echo = flag
</b>
            
          </div>
          
          
            <div class="description">
              <p>Enables/disables echo back.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-echo-3D_source')" id="l_method-i-echo-3D_source">show</a>
                
              </p>
              <div id="method-i-echo-3D_source" class="dyn-source">
                <pre>static VALUE
console_set_echo(VALUE io, VALUE f)
{
    conmode t;
    rb_io_t *fptr;
    int fd;

    GetOpenFile(io, fptr);
    fd = GetReadFD(fptr);
    if (!getattr(fd, &amp;t)) rb_sys_fail(0);
    if (RTEST(f))
        set_echo(&amp;t);
    else
        set_noecho(&amp;t);
    if (!setattr(fd, &amp;t)) rb_sys_fail(0);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-echo-3F">
            
              <a name="method-i-echo-3F"></a><b>io.echo?       &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if echo back is enabled.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-echo-3F_source')" id="l_method-i-echo-3F_source">show</a>
                
              </p>
              <div id="method-i-echo-3F_source" class="dyn-source">
                <pre>static VALUE
console_echo_p(VALUE io)
{
    conmode t;
    rb_io_t *fptr;
    int fd;

    GetOpenFile(io, fptr);
    fd = GetReadFD(fptr);
    if (!getattr(fd, &amp;t)) rb_sys_fail(0);
    return echo_p(&amp;t) ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-eof">
            
              <a name="method-i-eof"></a><b>ios.eof     &rarr; true or false
ios.eof?    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns true if <em>ios</em> is at end of file that means there are no more
data to read. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">dummy</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">eof</span>   <span class="ruby-comment">#=&gt; true</span>
</pre>

<p>If <em>ios</em> is a stream such as pipe or socket, <code>IO#eof?</code>
blocks until the other end sends some data or closes it.</p>

<pre class="ruby"><span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
<span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>; <span class="ruby-identifier">w</span>.<span class="ruby-identifier">close</span> }
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">eof?</span>  <span class="ruby-comment">#=&gt; true after 1 second blocking</span>

<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
<span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>; <span class="ruby-identifier">w</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;a&quot;</span> }
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">eof?</span>  <span class="ruby-comment">#=&gt; false after 1 second blocking</span>

<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">eof?</span>  <span class="ruby-comment"># blocks forever</span>
</pre>

<p>Note that <code>IO#eof?</code> reads data to the input byte buffer. So
<code>IO#sysread</code> may not behave as you intend with
<code>IO#eof?</code>, unless you call <code>IO#rewind</code> first (which
is not available for some streams).</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-eof_source')" id="l_method-i-eof_source">show</a>
                
              </p>
              <div id="method-i-eof_source" class="dyn-source">
                <pre>VALUE
rb_io_eof(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    if (READ_CHAR_PENDING(fptr)) return Qfalse;
    if (READ_DATA_PENDING(fptr)) return Qfalse;
    READ_CHECK(fptr);
    if (io_fillbuf(fptr) &lt; 0) {
        return Qtrue;
    }
    return Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-eof-3F">
            
              <a name="method-i-eof-3F"></a><b>ios.eof     &rarr; true or false
ios.eof?    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns true if <em>ios</em> is at end of file that means there are no more
data to read. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">dummy</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">eof</span>   <span class="ruby-comment">#=&gt; true</span>
</pre>

<p>If <em>ios</em> is a stream such as pipe or socket, <code>IO#eof?</code>
blocks until the other end sends some data or closes it.</p>

<pre class="ruby"><span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
<span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>; <span class="ruby-identifier">w</span>.<span class="ruby-identifier">close</span> }
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">eof?</span>  <span class="ruby-comment">#=&gt; true after 1 second blocking</span>

<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
<span class="ruby-constant">Thread</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">sleep</span> <span class="ruby-value">1</span>; <span class="ruby-identifier">w</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;a&quot;</span> }
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">eof?</span>  <span class="ruby-comment">#=&gt; false after 1 second blocking</span>

<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">eof?</span>  <span class="ruby-comment"># blocks forever</span>
</pre>

<p>Note that <code>IO#eof?</code> reads data to the input byte buffer. So
<code>IO#sysread</code> may not behave as you intend with
<code>IO#eof?</code>, unless you call <code>IO#rewind</code> first (which
is not available for some streams).</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-eof-3F_source')" id="l_method-i-eof-3F_source">show</a>
                
              </p>
              <div id="method-i-eof-3F_source" class="dyn-source">
                <pre>VALUE
rb_io_eof(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    if (READ_CHAR_PENDING(fptr)) return Qfalse;
    if (READ_DATA_PENDING(fptr)) return Qfalse;
    READ_CHECK(fptr);
    if (io_fillbuf(fptr) &lt; 0) {
        return Qtrue;
    }
    return Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-expect">
            
              <a name="method-i-expect"></a><b>expect</b>(pat,timeout=9999999)
            
          </div>
          
          
            <div class="description">
              <p>Reads from the <a href="IO.html">IO</a> until pattern <code>pat</code>
matches or the <code>timeout</code> is over. It returns an array with the
read buffer, followed by the matches. If a block is given, the result is
yielded to the block and returns nil.</p>

<p>The optional timeout parameter defines, in seconds, the total time to wait
for the pattern.  If the timeout expires or eof is found, nil is returned
or yielded.  However, the buffer in a timeout session is kept for the next
expect call.  The default timeout is 9999999 seconds.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-expect_source')" id="l_method-i-expect_source">show</a>
                
              </p>
              <div id="method-i-expect_source" class="dyn-source">
                <pre><span class="ruby-comment"># File ext/pty/lib/expect.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">expect</span>(<span class="ruby-identifier">pat</span>,<span class="ruby-identifier">timeout</span>=<span class="ruby-number">9999999</span>)
  <span class="ruby-identifier">buf</span> = <span class="ruby-string">''</span>
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">pat</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
    <span class="ruby-identifier">e_pat</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">quote</span>(<span class="ruby-identifier">pat</span>))
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Regexp</span>
    <span class="ruby-identifier">e_pat</span> = <span class="ruby-identifier">pat</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;unsupported pattern class: #{pattern.class}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@unusedBuf</span> <span class="ruby-operator">||=</span> <span class="ruby-string">''</span>
  <span class="ruby-keyword">while</span> <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-ivar">@unusedBuf</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@unusedBuf</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-number">0</span>).<span class="ruby-identifier">chr</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-constant">IO</span>.<span class="ruby-identifier">select</span>([<span class="ruby-keyword">self</span>],<span class="ruby-keyword">nil</span>,<span class="ruby-keyword">nil</span>,<span class="ruby-identifier">timeout</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">eof?</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-keyword">nil</span>
      <span class="ruby-ivar">@unusedBuf</span> = <span class="ruby-identifier">buf</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">buf</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">$expect_verbose</span>
      <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">c</span>
      <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">flush</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">mat</span>=<span class="ruby-identifier">e_pat</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">buf</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">result</span> = [<span class="ruby-identifier">buf</span>,*<span class="ruby-identifier">mat</span>.<span class="ruby-identifier">to_a</span>[<span class="ruby-number">1</span><span class="ruby-operator">..</span><span class="ruby-number">-1</span>]]
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">result</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-external_encoding">
            
              <a name="method-i-external_encoding"></a><b>io.external_encoding   &rarr; encoding
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the <a href="Encoding.html">Encoding</a> object that represents the
encoding of the file. If io is write mode and no encoding is specified,
returns <code>nil</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-external_encoding_source')" id="l_method-i-external_encoding_source">show</a>
                
              </p>
              <div id="method-i-external_encoding_source" class="dyn-source">
                <pre>static VALUE
rb_io_external_encoding(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (fptr-&gt;encs.enc2) {
        return rb_enc_from_encoding(fptr-&gt;encs.enc2);
    }
    if (fptr-&gt;mode &amp; FMODE_WRITABLE) {
        if (fptr-&gt;encs.enc)
            return rb_enc_from_encoding(fptr-&gt;encs.enc);
        return Qnil;
    }
    return rb_enc_from_encoding(io_read_encoding(fptr));
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fcntl">
            
              <a name="method-i-fcntl"></a><b>ios.fcntl(integer_cmd, arg)    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Provides a mechanism for issuing low-level commands to control or query
file-oriented I/O streams. Arguments and results are platform dependent. If
<em>arg</em> is a number, its value is passed directly. If it is a string,
it is interpreted as a binary sequence of bytes (<code>Array#pack</code>
might be a useful way to build this string). On Unix platforms, see
<code>fcntl(2)</code> for details. Not implemented on all platforms.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-fcntl_source')" id="l_method-i-fcntl_source">show</a>
                
              </p>
              <div id="method-i-fcntl_source" class="dyn-source">
                <pre>static VALUE
rb_io_fcntl(int argc, VALUE *argv, VALUE io)
{
    VALUE req, arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;req, &amp;arg);
    return rb_io_ctl(io, req, arg, 0);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fdatasync">
            
              <a name="method-i-fdatasync"></a><b>ios.fdatasync   &rarr; 0 or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Immediately writes all buffered data in <em>ios</em> to disk.</p>

<p>If the underlying operating system does not support <em>fdatasync(2)</em>,
<code>IO#fsync</code> is called instead (which might raise a
<code>NotImplementedError</code>).</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-fdatasync_source')" id="l_method-i-fdatasync_source">show</a>
                
              </p>
              <div id="method-i-fdatasync_source" class="dyn-source">
                <pre>static VALUE
rb_io_fdatasync(VALUE io)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    if (io_fflush(fptr) &lt; 0)
        rb_sys_fail(0);

    if (fdatasync(fptr-&gt;fd) == 0)
        return INT2FIX(0);

    /* fall back */
    return rb_io_fsync(io);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fileno">
            
              <a name="method-i-fileno"></a><b>ios.fileno    &rarr; fixnum
ios.to_i      &rarr; fixnum
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns an integer representing the numeric file descriptor for
<em>ios</em>.</p>

<pre class="ruby"><span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">fileno</span>    <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">fileno</span>   <span class="ruby-comment">#=&gt; 1</span>
</pre>
            </div>
          
          
          
            <div class="aka">
              Also aliased as: <a href="IO.html#method-i-to_i">to_i</a>
            </div>
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-fileno_source')" id="l_method-i-fileno_source">show</a>
                
              </p>
              <div id="method-i-fileno_source" class="dyn-source">
                <pre>static VALUE
rb_io_fileno(VALUE io)
{
    rb_io_t *fptr;
    int fd;

    GetOpenFile(io, fptr);
    fd = fptr-&gt;fd;
    return INT2FIX(fd);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-flush">
            
              <a name="method-i-flush"></a><b>ios.flush    &rarr; ios
</b>
            
          </div>
          
          
            <div class="description">
              <p>Flushes any buffered data within <em>ios</em> to the underlying operating
system (note that this is Ruby internal buffering only; the OS may buffer
the data as well).</p>

<pre>$stdout.print &quot;no newline&quot;
$stdout.flush</pre>

<p><em>produces:</em></p>

<pre>no newline</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-flush_source')" id="l_method-i-flush_source">show</a>
                
              </p>
              <div id="method-i-flush_source" class="dyn-source">
                <pre>VALUE
rb_io_flush(VALUE io)
{
    rb_io_t *fptr;

    if (TYPE(io) != T_FILE) {
        return rb_funcall(io, id_flush, 0);
    }

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    if (fptr-&gt;mode &amp; FMODE_WRITABLE) {
        if (io_fflush(fptr) &lt; 0)
            rb_sys_fail(0);
    }
    if (fptr-&gt;mode &amp; FMODE_READABLE) {
        io_unread(fptr);
    }

    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-fsync">
            
              <a name="method-i-fsync"></a><b>ios.fsync   &rarr; 0 or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Immediately writes all buffered data in <em>ios</em> to disk. Note that
<code>fsync</code> differs from using <code>IO#sync=</code>. The latter
ensures that data is flushed from Ruby’s buffers, but doesn’t not guarantee
that the underlying operating system actually writes it to disk.</p>

<p><code>NotImplementedError</code> is raised if the underlying operating
system does not support <em>fsync(2)</em>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-fsync_source')" id="l_method-i-fsync_source">show</a>
                
              </p>
              <div id="method-i-fsync_source" class="dyn-source">
                <pre>static VALUE
rb_io_fsync(VALUE io)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);

    if (io_fflush(fptr) &lt; 0)
        rb_sys_fail(0);
#ifndef _WIN32  /* already called in io_fflush() */
    if (fsync(fptr-&gt;fd) &lt; 0)
        rb_sys_fail_path(fptr-&gt;pathv);
#endif
    return INT2FIX(0);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-getbyte">
            
              <a name="method-i-getbyte"></a><b>ios.getbyte   &rarr; fixnum or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Gets the next 8-bit byte (0..255) from <em>ios</em>. Returns
<code>nil</code> if called at end of file.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">getbyte</span>   <span class="ruby-comment">#=&gt; 84</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">getbyte</span>   <span class="ruby-comment">#=&gt; 104</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-getbyte_source')" id="l_method-i-getbyte_source">show</a>
                
              </p>
              <div id="method-i-getbyte_source" class="dyn-source">
                <pre>VALUE
rb_io_getbyte(VALUE io)
{
    rb_io_t *fptr;
    int c;

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);
    READ_CHECK(fptr);
    if (fptr-&gt;fd == 0 &amp;&amp; (fptr-&gt;mode &amp; FMODE_TTY) &amp;&amp; TYPE(rb_stdout) == T_FILE) {
        rb_io_t *ofp;
        GetOpenFile(rb_stdout, ofp);
        if (ofp-&gt;mode &amp; FMODE_TTY) {
            rb_io_flush(rb_stdout);
        }
    }
    if (io_fillbuf(fptr) &lt; 0) {
        return Qnil;
    }
    fptr-&gt;rbuf.off++;
    fptr-&gt;rbuf.len--;
    c = (unsigned char)fptr-&gt;rbuf.ptr[fptr-&gt;rbuf.off-1];
    return INT2FIX(c &amp; 0xff);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-getc">
            
              <a name="method-i-getc"></a><b>ios.getc   &rarr; string or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads a one-character string from <em>ios</em>. Returns <code>nil</code> if
called at end of file.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">getc</span>   <span class="ruby-comment">#=&gt; &quot;h&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">getc</span>   <span class="ruby-comment">#=&gt; &quot;e&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-getc_source')" id="l_method-i-getc_source">show</a>
                
              </p>
              <div id="method-i-getc_source" class="dyn-source">
                <pre>static VALUE
rb_io_getc(VALUE io)
{
    rb_io_t *fptr;
    rb_encoding *enc;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);

    enc = io_input_encoding(fptr);
    READ_CHECK(fptr);
    return io_getc(fptr, enc);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-getch">
            
              <a name="method-i-getch"></a><b>io.getch       &rarr; char
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads and returns a character in raw mode.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-getch_source')" id="l_method-i-getch_source">show</a>
                
              </p>
              <div id="method-i-getch_source" class="dyn-source">
                <pre>static VALUE
console_getch(VALUE io)
{
    return ttymode(io, getc_call, set_rawmode);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-gets">
            
              <a name="method-i-gets"></a><b>ios.gets(sep=$/)     &rarr; string or nil
ios.gets(limit)      &rarr; string or nil
ios.gets(sep, limit) &rarr; string or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads the next “line” from the I/O stream; lines are separated by
<em>sep</em>. A separator of <code>nil</code> reads the entire contents,
and a zero-length separator reads the input a paragraph at a time (two
successive newlines in the input separate paragraphs). The stream must be
opened for reading or an <code>IOError</code> will be raised. The line read
in will be returned and also assigned to <code>$_</code>. Returns
<code>nil</code> if called at end of file.  If the first argument is an
integer, or optional second argument is given, the returning string would
not be longer than the given value in bytes.</p>

<pre class="ruby"><span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>).<span class="ruby-identifier">gets</span>   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">$_</span>                          <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-gets_source')" id="l_method-i-gets_source">show</a>
                
              </p>
              <div id="method-i-gets_source" class="dyn-source">
                <pre>static VALUE
rb_io_gets_m(int argc, VALUE *argv, VALUE io)
{
    VALUE str;

    str = rb_io_getline(argc, argv, io);
    rb_lastline_set(str);

    return str;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-iflush">
            
              <a name="method-i-iflush"></a><b>io.iflush
</b>
            
          </div>
          
          
            <div class="description">
              <p>Flushes input buffer in kernel.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-iflush_source')" id="l_method-i-iflush_source">show</a>
                
              </p>
              <div id="method-i-iflush_source" class="dyn-source">
                <pre>static VALUE
console_iflush(VALUE io)
{
    rb_io_t *fptr;
    int fd;

    GetOpenFile(io, fptr);
    fd = GetReadFD(fptr);
#if defined HAVE_TERMIOS_H || defined HAVE_TERMIO_H
    if (tcflush(fd, TCIFLUSH)) rb_sys_fail(0);
#endif
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-inspect">
            
              <a name="method-i-inspect"></a><b>ios.inspect   &rarr; string
</b>
            
          </div>
          
          
            <div class="description">
              <p>Return a string describing this <a href="IO.html">IO</a> object.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-inspect_source')" id="l_method-i-inspect_source">show</a>
                
              </p>
              <div id="method-i-inspect_source" class="dyn-source">
                <pre>static VALUE
rb_io_inspect(VALUE obj)
{
    rb_io_t *fptr;
    const char *cname;
    char fd_desc[4+sizeof(int)*3];
    const char *path;
    const char *st = &quot;&quot;;

    fptr = RFILE(rb_io_taint_check(obj))-&gt;fptr;
    if (!fptr) return rb_any_to_s(obj);
    cname = rb_obj_classname(obj);
    if (NIL_P(fptr-&gt;pathv)) {
        if (fptr-&gt;fd &lt; 0) {
            path = &quot;&quot;;
            st = &quot;(closed)&quot;;
        }
        else {
            snprintf(fd_desc, sizeof(fd_desc), &quot;fd %d&quot;, fptr-&gt;fd);
            path = fd_desc;
        }
    }
    else {
        path = RSTRING_PTR(fptr-&gt;pathv);
        if (fptr-&gt;fd &lt; 0) {
            st = &quot; (closed)&quot;;
        }
    }
    return rb_sprintf(&quot;#&lt;%s:%s%s&gt;&quot;, cname, path, st);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-internal_encoding">
            
              <a name="method-i-internal_encoding"></a><b>io.internal_encoding   &rarr; encoding
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the <a href="Encoding.html">Encoding</a> of the internal string if
conversion is specified.  Otherwise returns nil.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-internal_encoding_source')" id="l_method-i-internal_encoding_source">show</a>
                
              </p>
              <div id="method-i-internal_encoding_source" class="dyn-source">
                <pre>static VALUE
rb_io_internal_encoding(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (!fptr-&gt;encs.enc2) return Qnil;
    return rb_enc_from_encoding(io_read_encoding(fptr));
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ioctl">
            
              <a name="method-i-ioctl"></a><b>ios.ioctl(integer_cmd, arg)    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Provides a mechanism for issuing low-level commands to control or query I/O
devices. Arguments and results are platform dependent. If <em>arg</em> is a
number, its value is passed directly. If it is a string, it is interpreted
as a binary sequence of bytes. On Unix platforms, see <code>ioctl(2)</code>
for details. Not implemented on all platforms.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ioctl_source')" id="l_method-i-ioctl_source">show</a>
                
              </p>
              <div id="method-i-ioctl_source" class="dyn-source">
                <pre>static VALUE
rb_io_ioctl(int argc, VALUE *argv, VALUE io)
{
    VALUE req, arg;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;req, &amp;arg);
    return rb_io_ctl(io, req, arg, 1);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ioflush">
            
              <a name="method-i-ioflush"></a><b>io.ioflush
</b>
            
          </div>
          
          
            <div class="description">
              <p>Flushes input and output buffers in kernel.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ioflush_source')" id="l_method-i-ioflush_source">show</a>
                
              </p>
              <div id="method-i-ioflush_source" class="dyn-source">
                <pre>static VALUE
console_ioflush(VALUE io)
{
    rb_io_t *fptr;
#if defined HAVE_TERMIOS_H || defined HAVE_TERMIO_H
    int fd1, fd2;
#endif

    GetOpenFile(io, fptr);
#if defined HAVE_TERMIOS_H || defined HAVE_TERMIO_H
    fd1 = GetReadFD(fptr);
    fd2 = GetWriteFD(fptr);
    if (fd2 != -1 &amp;&amp; fd1 != fd2) {
        if (tcflush(fd1, TCIFLUSH)) rb_sys_fail(0);
        if (tcflush(fd2, TCOFLUSH)) rb_sys_fail(0);
    }
    else {
        if (tcflush(fd1, TCIOFLUSH)) rb_sys_fail(0);
    }
#endif
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-isatty">
            
              <a name="method-i-isatty"></a><b>ios.isatty   &rarr; true or false
ios.tty?     &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if <em>ios</em> is associated with a terminal
device (tty), <code>false</code> otherwise.</p>

<pre class="ruby"><span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>).<span class="ruby-identifier">isatty</span>   <span class="ruby-comment">#=&gt; false</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;/dev/tty&quot;</span>).<span class="ruby-identifier">isatty</span>   <span class="ruby-comment">#=&gt; true</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-isatty_source')" id="l_method-i-isatty_source">show</a>
                
              </p>
              <div id="method-i-isatty_source" class="dyn-source">
                <pre>static VALUE
rb_io_isatty(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (isatty(fptr-&gt;fd) == 0)
        return Qfalse;
    return Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lineno">
            
              <a name="method-i-lineno"></a><b>ios.lineno    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the current line number in <em>ios</em>.  The stream must be opened
for reading. <code>lineno</code> counts the number of times <a
href="IO.html#method-i-gets">#gets</a> is called rather than the number of
newlines encountered.  The two values will differ if <a
href="IO.html#method-i-gets">#gets</a> is called with a separator other
than newline.</p>

<p>Methods that use <code>$/</code> like <a
href="IO.html#method-i-each">#each</a>, <a
href="IO.html#method-i-lines">#lines</a> and <a
href="IO.html#method-i-readline">#readline</a> will also increment
<code>lineno</code>.</p>

<p>See also the <code>$.</code> variable.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">lineno</span>   <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>     <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">lineno</span>   <span class="ruby-comment">#=&gt; 1</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>     <span class="ruby-comment">#=&gt; &quot;This is line two\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">lineno</span>   <span class="ruby-comment">#=&gt; 2</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lineno_source')" id="l_method-i-lineno_source">show</a>
                
              </p>
              <div id="method-i-lineno_source" class="dyn-source">
                <pre>static VALUE
rb_io_lineno(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);
    return INT2NUM(fptr-&gt;lineno);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lineno-3D">
            
              <a name="method-i-lineno-3D"></a><b>ios.lineno = integer    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Manually sets the current line number to the given value. <code>$.</code>
is updated only on the next read.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>                     <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">$.</span>                         <span class="ruby-comment">#=&gt; 1</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">lineno</span> = <span class="ruby-value">1000</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">lineno</span>                   <span class="ruby-comment">#=&gt; 1000</span>
<span class="ruby-identifier">$.</span>                         <span class="ruby-comment">#=&gt; 1         # lineno of last read</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>                     <span class="ruby-comment">#=&gt; &quot;This is line two\n&quot;</span>
<span class="ruby-identifier">$.</span>                         <span class="ruby-comment">#=&gt; 1001      # lineno of last read</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lineno-3D_source')" id="l_method-i-lineno-3D_source">show</a>
                
              </p>
              <div id="method-i-lineno-3D_source" class="dyn-source">
                <pre>static VALUE
rb_io_set_lineno(VALUE io, VALUE lineno)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);
    fptr-&gt;lineno = NUM2INT(lineno);
    return lineno;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lines">
            
              <a name="method-i-lines"></a><b>ios.each(sep=$/) {|line| block }         &rarr; ios
ios.each(limit) {|line| block }          &rarr; ios
ios.each(sep,limit) {|line| block }      &rarr; ios
ios.each(...)                            &rarr; an_enumerator
ios.each_line(sep=$/) {|line| block }    &rarr; ios
ios.each_line(limit) {|line| block }     &rarr; ios
ios.each_line(sep,limit) {|line| block } &rarr; ios
ios.each_line(...)                       &rarr; an_enumerator
ios.lines(sep=$/) {|line| block }        &rarr; ios
ios.lines(limit) {|line| block }         &rarr; ios
ios.lines(sep,limit) {|line| block }     &rarr; ios
ios.lines(...)                           &rarr; an_enumerator
</b>
            
          </div>
          
          
            <div class="description">
              <p>Executes the block for every line in <em>ios</em>, where lines are
separated by <em>sep</em>. <em>ios</em> must be opened for reading or an
<code>IOError</code> will be raised.</p>

<p>If no block is given, an enumerator is returned instead.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{f.lineno}: #{line}&quot;</span> }
</pre>

<p><em>produces:</em></p>

<pre>1: This is line one
2: This is line two
3: This is line three
4: And so on...</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lines_source')" id="l_method-i-lines_source">show</a>
                
              </p>
              <div id="method-i-lines_source" class="dyn-source">
                <pre>static VALUE
rb_io_each_line(int argc, VALUE *argv, VALUE io)
{
    VALUE str, rs;
    long limit;

    RETURN_ENUMERATOR(io, argc, argv);
    prepare_getline_args(argc, argv, &amp;rs, &amp;limit, io);
    if (limit == 0)
        rb_raise(rb_eArgError, &quot;invalid limit: 0 for each_line&quot;);
    while (!NIL_P(str = rb_io_getline_1(rs, limit, io))) {
        rb_yield(str);
    }
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-noecho">
            
              <a name="method-i-noecho"></a><b>io.noecho {|io| }
</b>
            
          </div>
          
          
            <div class="description">
              <p>Yields <code>self</code> with disabling echo back.</p>

<pre>STDIN.noecho(&amp;:gets)</pre>

<p>will read and return a line without echo back.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-noecho_source')" id="l_method-i-noecho_source">show</a>
                
              </p>
              <div id="method-i-noecho_source" class="dyn-source">
                <pre>static VALUE
console_noecho(VALUE io)
{
    return ttymode(io, rb_yield, set_noecho);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-nread">
            
              <a name="method-i-nread"></a><b>io.nread &rarr; int
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns number of bytes that can be read without blocking. Returns zero if
no information available.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-nread_source')" id="l_method-i-nread_source">show</a>
                
              </p>
              <div id="method-i-nread_source" class="dyn-source">
                <pre>static VALUE
io_nread(VALUE io)
{
    rb_io_t *fptr;
    int len;
    ioctl_arg n;

    GetOpenFile(io, fptr);
    rb_io_check_readable(fptr);
    len = rb_io_read_pending(fptr);
    if (len &gt; 0) return len;
    if (!FIONREAD_POSSIBLE_P(fptr-&gt;fd)) return INT2FIX(0);
    if (ioctl(fptr-&gt;fd, FIONREAD, &amp;n)) return INT2FIX(0);
    if (n &gt; 0) return ioctl_arg2num(n);
    return INT2FIX(0);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-oflush">
            
              <a name="method-i-oflush"></a><b>io.oflush
</b>
            
          </div>
          
          
            <div class="description">
              <p>Flushes output buffer in kernel.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-oflush_source')" id="l_method-i-oflush_source">show</a>
                
              </p>
              <div id="method-i-oflush_source" class="dyn-source">
                <pre>static VALUE
console_oflush(VALUE io)
{
    rb_io_t *fptr;
    int fd;

    GetOpenFile(io, fptr);
    fd = GetWriteFD(fptr);
#if defined HAVE_TERMIOS_H || defined HAVE_TERMIO_H
    if (tcflush(fd, TCOFLUSH)) rb_sys_fail(0);
#endif
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-pid">
            
              <a name="method-i-pid"></a><b>ios.pid    &rarr; fixnum
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the process ID of a child process associated with <em>ios</em>.
This will be set by <code>IO.popen</code>.</p>

<pre>pipe = IO.popen(&quot;-&quot;)
if pipe
  $stderr.puts &quot;In parent, child pid is #{pipe.pid}&quot;
else
  $stderr.puts &quot;In child, pid is #{$$}&quot;
end</pre>

<p><em>produces:</em></p>

<pre>In child, pid is 26209
In parent, child pid is 26209</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-pid_source')" id="l_method-i-pid_source">show</a>
                
              </p>
              <div id="method-i-pid_source" class="dyn-source">
                <pre>static VALUE
rb_io_pid(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (!fptr-&gt;pid)
        return Qnil;
    return PIDT2NUM(fptr-&gt;pid);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-pos">
            
              <a name="method-i-pos"></a><b>ios.pos     &rarr; integer
ios.tell    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the current offset (in bytes) of <em>ios</em>.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">pos</span>    <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">pos</span>    <span class="ruby-comment">#=&gt; 17</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-pos_source')" id="l_method-i-pos_source">show</a>
                
              </p>
              <div id="method-i-pos_source" class="dyn-source">
                <pre>static VALUE
rb_io_tell(VALUE io)
{
    rb_io_t *fptr;
    off_t pos;

    GetOpenFile(io, fptr);
    pos = io_tell(fptr);
    if (pos &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);
    pos -= fptr-&gt;rbuf.len;
    return OFFT2NUM(pos);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-pos-3D">
            
              <a name="method-i-pos-3D"></a><b>ios.pos = integer    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Seeks to the given position (in bytes) in <em>ios</em>.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">pos</span> = <span class="ruby-value">17</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>   <span class="ruby-comment">#=&gt; &quot;This is line two\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-pos-3D_source')" id="l_method-i-pos-3D_source">show</a>
                
              </p>
              <div id="method-i-pos-3D_source" class="dyn-source">
                <pre>static VALUE
rb_io_set_pos(VALUE io, VALUE offset)
{
    rb_io_t *fptr;
    off_t pos;

    pos = NUM2OFFT(offset);
    GetOpenFile(io, fptr);
    pos = io_seek(fptr, pos, SEEK_SET);
    if (pos &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);

    return OFFT2NUM(pos);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-print">
            
              <a name="method-i-print"></a><b>ios.print()             &rarr; nil
ios.print(obj, ...)     &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Writes the given object(s) to <em>ios</em>. The stream must be opened for
writing. If the output field separator (<code>$,</code>) is not
<code>nil</code>, it will be inserted between each object. If the output
record separator (<code>$\&lt;/code&gt;) is not &lt;code&gt;nil</code>, it
will be appended to the output. If no arguments are given, prints
<code>$_</code>. Objects that aren’t strings will be converted by calling
their <code>to_s</code> method. With no argument, prints the contents of
the variable <code>$_</code>. Returns <code>nil</code>.</p>

<pre>$stdout.print(&quot;This is &quot;, 100, &quot; percent.\n&quot;)</pre>

<p><em>produces:</em></p>

<pre>This is 100 percent.</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-print_source')" id="l_method-i-print_source">show</a>
                
              </p>
              <div id="method-i-print_source" class="dyn-source">
                <pre>VALUE
rb_io_print(int argc, VALUE *argv, VALUE out)
{
    int i;
    VALUE line;

    /* if no argument given, print `$_' */
    if (argc == 0) {
        argc = 1;
        line = rb_lastline_get();
        argv = &amp;line;
    }
    for (i=0; i&lt;argc; i++) {
        if (!NIL_P(rb_output_fs) &amp;&amp; i&gt;0) {
            rb_io_write(out, rb_output_fs);
        }
        rb_io_write(out, argv[i]);
    }
    if (argc &gt; 0 &amp;&amp; !NIL_P(rb_output_rs)) {
        rb_io_write(out, rb_output_rs);
    }

    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-printf">
            
              <a name="method-i-printf"></a><b>ios.printf(format_string [, obj, ...])   &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Formats and writes to <em>ios</em>, converting parameters under control of
the format string. See <code>Kernel#sprintf</code> for details.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-printf_source')" id="l_method-i-printf_source">show</a>
                
              </p>
              <div id="method-i-printf_source" class="dyn-source">
                <pre>VALUE
rb_io_printf(int argc, VALUE *argv, VALUE out)
{
    rb_io_write(out, rb_f_sprintf(argc, argv));
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-putc">
            
              <a name="method-i-putc"></a><b>ios.putc(obj)    &rarr; obj
</b>
            
          </div>
          
          
            <div class="description">
              <p>If <em>obj</em> is <code>Numeric</code>, write the character whose code is
the least-significant byte of <em>obj</em>, otherwise write the first byte
of the string representation of <em>obj</em> to <em>ios</em>. Note: This
method is not safe for use with multi-byte characters as it will truncate
them.</p>

<pre>$stdout.putc &quot;A&quot;
$stdout.putc 65</pre>

<p><em>produces:</em></p>

<pre>AA</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-putc_source')" id="l_method-i-putc_source">show</a>
                
              </p>
              <div id="method-i-putc_source" class="dyn-source">
                <pre>static VALUE
rb_io_putc(VALUE io, VALUE ch)
{
    VALUE str;
    if (TYPE(ch) == T_STRING) {
        str = rb_str_substr(ch, 0, 1);
    }
    else {
        char c = NUM2CHR(ch);
        str = rb_str_new(&amp;c, 1);
    }
    rb_io_write(io, str);
    return ch;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-puts">
            
              <a name="method-i-puts"></a><b>ios.puts(obj, ...)    &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Writes the given objects to <em>ios</em> as with <code>IO#print</code>.
Writes a record separator (typically a newline) after any that do not
already end with a newline sequence. If called with an array argument,
writes each element on a new line. If called without arguments, outputs a
single record separator.</p>

<pre>$stdout.puts(&quot;this&quot;, &quot;is&quot;, &quot;a&quot;, &quot;test&quot;)</pre>

<p><em>produces:</em></p>

<pre>this
is
a
test</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-puts_source')" id="l_method-i-puts_source">show</a>
                
              </p>
              <div id="method-i-puts_source" class="dyn-source">
                <pre>VALUE
rb_io_puts(int argc, VALUE *argv, VALUE out)
{
    int i;
    VALUE line;

    /* if no argument given, print newline. */
    if (argc == 0) {
        rb_io_write(out, rb_default_rs);
        return Qnil;
    }
    for (i=0; i&lt;argc; i++) {
        if (TYPE(argv[i]) == T_STRING) {
            line = argv[i];
            goto string;
        }
        line = rb_check_array_type(argv[i]);
        if (!NIL_P(line)) {
            rb_exec_recursive(io_puts_ary, line, out);
            continue;
        }
        line = rb_obj_as_string(argv[i]);
      string:
        rb_io_write(out, line);
        if (RSTRING_LEN(line) == 0 ||
            !str_end_with_asciichar(line, '\n')) {
            rb_io_write(out, rb_default_rs);
        }
    }

    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-raw">
            
              <a name="method-i-raw"></a><b>io.raw {|io| }
</b>
            
          </div>
          
          
            <div class="description">
              <p>Yields <code>self</code> within raw mode.</p>

<pre>STDIN.raw(&amp;:gets)</pre>

<p>will read and return a line with echo back and line editing.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-raw_source')" id="l_method-i-raw_source">show</a>
                
              </p>
              <div id="method-i-raw_source" class="dyn-source">
                <pre>static VALUE
console_raw(VALUE io)
{
    return ttymode(io, rb_yield, set_rawmode);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-raw-21">
            
              <a name="method-i-raw-21"></a><b>io.raw!
</b>
            
          </div>
          
          
            <div class="description">
              <p>Enables raw mode.</p>

<p>If the terminal mode needs to be back, use io.raw { … }.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-raw-21_source')" id="l_method-i-raw-21_source">show</a>
                
              </p>
              <div id="method-i-raw-21_source" class="dyn-source">
                <pre>static VALUE
console_set_raw(VALUE io)
{
    conmode t;
    rb_io_t *fptr;
    int fd;

    GetOpenFile(io, fptr);
    fd = GetReadFD(fptr);
    if (!getattr(fd, &amp;t)) rb_sys_fail(0);
    set_rawmode(&amp;t);
    if (!setattr(fd, &amp;t)) rb_sys_fail(0);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-read">
            
              <a name="method-i-read"></a><b>ios.read([length [, buffer]])    &rarr; string, buffer, or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads <em>length</em> bytes from the I/O stream.</p>

<p><em>length</em> must be a non-negative integer or <code>nil</code>.</p>

<p>If <em>length</em> is a positive integer, it try to read <em>length</em>
bytes without any conversion (binary mode). It returns <code>nil</code> or
a string whose length is 1 to <em>length</em> bytes. <code>nil</code> means
it met EOF at beginning. The 1 to <em>length</em>-1 bytes string means it
met EOF after reading the result. The <em>length</em> bytes string means it
doesn’t meet EOF. The resulted string is always ASCII-8BIT encoding.</p>

<p>If <em>length</em> is omitted or is <code>nil</code>, it reads until EOF
and the encoding conversion is applied. It returns a string even if EOF is
met at beginning.</p>

<p>If <em>length</em> is zero, it returns <code>&quot;&quot;</code>.</p>

<p>If the optional <em>buffer</em> argument is present, it must reference a
String, which will receive the data.</p>

<p>At end of file, it returns <code>nil</code> or <code>&quot;&quot;</code>
depend on <em>length</em>. <code><em>ios</em>.read()</code> and
<code><em>ios</em>.read(nil)</code> returns <code>&quot;&quot;</code>.
<code><em>ios</em>.read(<em>positive-integer</em>)</code> returns
<code>nil</code>.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">16</span>)   <span class="ruby-comment">#=&gt; &quot;This is line one&quot;</span>

<span class="ruby-comment"># reads whole file</span>
<span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;file&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">data</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span> <span class="ruby-comment"># This returns a string even if the file is empty.</span>
  <span class="ruby-operator">...</span>
}

<span class="ruby-comment"># iterate over fixed length records.</span>
<span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;fixed-record-file&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
  <span class="ruby-keyword">while</span> <span class="ruby-identifier">record</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">256</span>)
    <span class="ruby-operator">...</span>
  <span class="ruby-keyword">end</span>
}

<span class="ruby-comment"># iterate over variable length records.</span>
<span class="ruby-comment"># record is prefixed by 32-bit length.</span>
<span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;variable-record-file&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
  <span class="ruby-keyword">while</span> <span class="ruby-identifier">len</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">4</span>)
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">len</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&quot;N&quot;</span>)[<span class="ruby-value">0</span>] <span class="ruby-comment"># 32-bit length</span>
    <span class="ruby-identifier">record</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">len</span>) <span class="ruby-comment"># This returns a string even if len is 0.</span>
  <span class="ruby-keyword">end</span>
}
</pre>

<p>Note that this method behaves like fread() function in C. If you need the
behavior like read(2) system call, consider readpartial, <a
href="IO.html#method-i-read_nonblock">#read_nonblock</a> and sysread.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-read_source')" id="l_method-i-read_source">show</a>
                
              </p>
              <div id="method-i-read_source" class="dyn-source">
                <pre>static VALUE
io_read(int argc, VALUE *argv, VALUE io)
{
    rb_io_t *fptr;
    long n, len;
    VALUE length, str;

    rb_scan_args(argc, argv, &quot;02&quot;, &amp;length, &amp;str);

    if (NIL_P(length)) {
        GetOpenFile(io, fptr);
        rb_io_check_char_readable(fptr);
        return read_all(fptr, remain_size(fptr), str);
    }
    len = NUM2LONG(length);
    if (len &lt; 0) {
        rb_raise(rb_eArgError, &quot;negative length %ld given&quot;, len);
    }

    io_setstrbuf(&amp;str,len);

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);
    if (len == 0) return str;

    READ_CHECK(fptr);
    n = io_fread(str, 0, fptr);
    if (n == 0) {
        if (fptr-&gt;fd &lt; 0) return Qnil;
        rb_str_resize(str, 0);
        return Qnil;
    }
    rb_str_resize(str, n);
    OBJ_TAINT(str);

    return str;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-read_nonblock">
            
              <a name="method-i-read_nonblock"></a><b>ios.read_nonblock(maxlen)              &rarr; string
ios.read_nonblock(maxlen, outbuf)      &rarr; outbuf
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads at most <em>maxlen</em> bytes from <em>ios</em> using the read(2)
system call after O_NONBLOCK is set for the underlying file descriptor.</p>

<p>If the optional <em>outbuf</em> argument is present, it must reference a
String, which will receive the data.</p>

<p><a href="IO.html#method-i-read_nonblock">#read_nonblock</a> just calls the
read(2) system call. It causes all errors the read(2) system call causes:
Errno::EWOULDBLOCK, Errno::EINTR, etc. The caller should care such errors.</p>

<p>If the exception is Errno::EWOULDBLOCK or Errno::AGAIN, it is extended by
<a href="IO/WaitReadable.html">IO::WaitReadable</a>. So <a
href="IO/WaitReadable.html">IO::WaitReadable</a> can be used to rescue the
exceptions for retrying read_nonblock.</p>

<p><a href="IO.html#method-i-read_nonblock">#read_nonblock</a> causes <a
href="EOFError.html">EOFError</a> on EOF.</p>

<p>If the read byte buffer is not empty, <a
href="IO.html#method-i-read_nonblock">#read_nonblock</a> reads from the
buffer like readpartial. In this case, the read(2) system call is not
called.</p>

<p>When <a href="IO.html#method-i-read_nonblock">#read_nonblock</a> raises an
exception kind of <a href="IO/WaitReadable.html">IO::WaitReadable</a>, <a
href="IO.html#method-i-read_nonblock">#read_nonblock</a> should not be
called until io is readable for avoiding busy loop. This can be done as
follows.</p>

<pre># emulates blocking read (readpartial).
begin
  result = io.read_nonblock(maxlen)
rescue IO::WaitReadable
  IO.select([io])
  retry
end</pre>

<p>Although <a href="IO.html#method-i-read_nonblock">#read_nonblock</a>
doesn’t raise <a href="IO/WaitWritable.html">IO::WaitWritable</a>. <a
href="OpenSSL/Buffering.html#method-i-read_nonblock">OpenSSL::Buffering#read_nonblock</a>
can raise <a href="IO/WaitWritable.html">IO::WaitWritable</a>. If <a
href="IO.html">IO</a> and SSL should be used polymorphically, <a
href="IO/WaitWritable.html">IO::WaitWritable</a> should be rescued too. See
the document of <a
href="OpenSSL/Buffering.html#method-i-read_nonblock">OpenSSL::Buffering#read_nonblock</a>
for sample code.</p>

<p>Note that this method is identical to readpartial except the non-blocking
flag is set.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-read_nonblock_source')" id="l_method-i-read_nonblock_source">show</a>
                
              </p>
              <div id="method-i-read_nonblock_source" class="dyn-source">
                <pre>static VALUE
io_read_nonblock(int argc, VALUE *argv, VALUE io)
{
    VALUE ret;

    ret = io_getpartial(argc, argv, io, 1);
    if (NIL_P(ret))
        rb_eof_error();
    else
        return ret;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-readbyte">
            
              <a name="method-i-readbyte"></a><b>ios.readbyte   &rarr; fixnum
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads a byte as with <code>IO#getbyte</code>, but raises an
<code>EOFError</code> on end of file.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-readbyte_source')" id="l_method-i-readbyte_source">show</a>
                
              </p>
              <div id="method-i-readbyte_source" class="dyn-source">
                <pre>static VALUE
rb_io_readbyte(VALUE io)
{
    VALUE c = rb_io_getbyte(io);

    if (NIL_P(c)) {
        rb_eof_error();
    }
    return c;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-readchar">
            
              <a name="method-i-readchar"></a><b>ios.readchar   &rarr; string
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads a one-character string from <em>ios</em>. Raises an
<code>EOFError</code> on end of file.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readchar</span>   <span class="ruby-comment">#=&gt; &quot;h&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readchar</span>   <span class="ruby-comment">#=&gt; &quot;e&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-readchar_source')" id="l_method-i-readchar_source">show</a>
                
              </p>
              <div id="method-i-readchar_source" class="dyn-source">
                <pre>static VALUE
rb_io_readchar(VALUE io)
{
    VALUE c = rb_io_getc(io);

    if (NIL_P(c)) {
        rb_eof_error();
    }
    return c;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-readline">
            
              <a name="method-i-readline"></a><b>ios.readline(sep=$/)     &rarr; string
ios.readline(limit)      &rarr; string
ios.readline(sep, limit) &rarr; string
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads a line as with <code>IO#gets</code>, but raises an
<code>EOFError</code> on end of file.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-readline_source')" id="l_method-i-readline_source">show</a>
                
              </p>
              <div id="method-i-readline_source" class="dyn-source">
                <pre>static VALUE
rb_io_readline(int argc, VALUE *argv, VALUE io)
{
    VALUE line = rb_io_gets_m(argc, argv, io);

    if (NIL_P(line)) {
        rb_eof_error();
    }
    return line;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-readlines">
            
              <a name="method-i-readlines"></a><b>ios.readlines(sep=$/)     &rarr; array
ios.readlines(limit)      &rarr; array
ios.readlines(sep, limit) &rarr; array
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads all of the lines in <em>ios</em>, and returns them in
<em>anArray</em>. Lines are separated by the optional <em>sep</em>. If
<em>sep</em> is <code>nil</code>, the rest of the stream is returned as a
single record.  If the first argument is an integer, or optional second
argument is given, the returning string would not be longer than the given
value in bytes. The stream must be opened for reading or an
<code>IOError</code> will be raised.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readlines</span>[<span class="ruby-value">0</span>]   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-readlines_source')" id="l_method-i-readlines_source">show</a>
                
              </p>
              <div id="method-i-readlines_source" class="dyn-source">
                <pre>static VALUE
rb_io_readlines(int argc, VALUE *argv, VALUE io)
{
    VALUE line, ary, rs;
    long limit;

    prepare_getline_args(argc, argv, &amp;rs, &amp;limit, io);
    if (limit == 0)
        rb_raise(rb_eArgError, &quot;invalid limit: 0 for readlines&quot;);
    ary = rb_ary_new();
    while (!NIL_P(line = rb_io_getline_1(rs, limit, io))) {
        rb_ary_push(ary, line);
    }
    return ary;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-readpartial">
            
              <a name="method-i-readpartial"></a><b>ios.readpartial(maxlen)              &rarr; string
ios.readpartial(maxlen, outbuf)      &rarr; outbuf
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads at most <em>maxlen</em> bytes from the I/O stream. It blocks only if
<em>ios</em> has no data immediately available. It doesn’t block if some
data available. If the optional <em>outbuf</em> argument is present, it
must reference a String, which will receive the data. It raises
<code>EOFError</code> on end of file.</p>

<p>readpartial is designed for streams such as pipe, socket, tty, etc. It
blocks only when no data immediately available. This means that it blocks
only when following all conditions hold.</p>
<ul><li>
<p>the byte buffer in the <a href="IO.html">IO</a> object is empty.</p>
</li><li>
<p>the content of the stream is empty.</p>
</li><li>
<p>the stream is not reached to EOF.</p>
</li></ul>

<p>When readpartial blocks, it waits data or EOF on the stream. If some data
is reached, readpartial returns with the data. If EOF is reached,
readpartial raises <a href="EOFError.html">EOFError</a>.</p>

<p>When readpartial doesn’t blocks, it returns or raises immediately. If the
byte buffer is not empty, it returns the data in the buffer. Otherwise if
the stream has some content, it returns the data in the stream. Otherwise
if the stream is reached to EOF, it raises <a
href="EOFError.html">EOFError</a>.</p>

<pre class="ruby"><span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>           <span class="ruby-comment">#               buffer          pipe content</span>
<span class="ruby-identifier">w</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;abc&quot;</span>               <span class="ruby-comment">#               &quot;&quot;              &quot;abc&quot;.</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">readpartial</span>(<span class="ruby-value">4096</span>)      <span class="ruby-comment">#=&gt; &quot;abc&quot;       &quot;&quot;              &quot;&quot;</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">readpartial</span>(<span class="ruby-value">4096</span>)      <span class="ruby-comment"># blocks because buffer and pipe is empty.</span>

<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>           <span class="ruby-comment">#               buffer          pipe content</span>
<span class="ruby-identifier">w</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;abc&quot;</span>               <span class="ruby-comment">#               &quot;&quot;              &quot;abc&quot;</span>
<span class="ruby-identifier">w</span>.<span class="ruby-identifier">close</span>                  <span class="ruby-comment">#               &quot;&quot;              &quot;abc&quot; EOF</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">readpartial</span>(<span class="ruby-value">4096</span>)      <span class="ruby-comment">#=&gt; &quot;abc&quot;       &quot;&quot;              EOF</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">readpartial</span>(<span class="ruby-value">4096</span>)      <span class="ruby-comment"># raises EOFError</span>

<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>           <span class="ruby-comment">#               buffer          pipe content</span>
<span class="ruby-identifier">w</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;abc\ndef\n&quot;</span>        <span class="ruby-comment">#               &quot;&quot;              &quot;abc\ndef\n&quot;</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">gets</span>                   <span class="ruby-comment">#=&gt; &quot;abc\n&quot;     &quot;def\n&quot;         &quot;&quot;</span>
<span class="ruby-identifier">w</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;ghi\n&quot;</span>             <span class="ruby-comment">#               &quot;def\n&quot;         &quot;ghi\n&quot;</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">readpartial</span>(<span class="ruby-value">4096</span>)      <span class="ruby-comment">#=&gt; &quot;def\n&quot;     &quot;&quot;              &quot;ghi\n&quot;</span>
<span class="ruby-identifier">r</span>.<span class="ruby-identifier">readpartial</span>(<span class="ruby-value">4096</span>)      <span class="ruby-comment">#=&gt; &quot;ghi\n&quot;     &quot;&quot;              &quot;&quot;</span>
</pre>

<p>Note that readpartial behaves similar to sysread. The differences are:</p>
<ul><li>
<p>If the byte buffer is not empty, read from the byte buffer instead of
“sysread for buffered <a href="IO.html">IO</a> (<a
href="IOError.html">IOError</a>)”.</p>
</li><li>
<p>It doesn’t cause Errno::EWOULDBLOCK and Errno::EINTR.  When readpartial
meets EWOULDBLOCK and EINTR by read system call, readpartial retry the
system call.</p>
</li></ul>

<p>The later means that readpartial is nonblocking-flag insensitive. It blocks
on the situation <a href="IO.html#method-i-sysread">#sysread</a> causes
Errno::EWOULDBLOCK as if the fd is blocking mode.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-readpartial_source')" id="l_method-i-readpartial_source">show</a>
                
              </p>
              <div id="method-i-readpartial_source" class="dyn-source">
                <pre>static VALUE
io_readpartial(int argc, VALUE *argv, VALUE io)
{
    VALUE ret;

    ret = io_getpartial(argc, argv, io, 0);
    if (NIL_P(ret))
        rb_eof_error();
    else
        return ret;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ready-3F">
            
              <a name="method-i-ready-3F"></a><b>io.ready? &rarr; true, false or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns true if input available without blocking, or false. Returns nil if
no information available.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ready-3F_source')" id="l_method-i-ready-3F_source">show</a>
                
              </p>
              <div id="method-i-ready-3F_source" class="dyn-source">
                <pre>static VALUE
io_ready_p(VALUE io)
{
    rb_io_t *fptr;
    ioctl_arg n;

    GetOpenFile(io, fptr);
    rb_io_check_readable(fptr);
    if (rb_io_read_pending(fptr)) return Qtrue;
    if (!FIONREAD_POSSIBLE_P(fptr-&gt;fd)) return Qnil;
    if (ioctl(fptr-&gt;fd, FIONREAD, &amp;n)) return Qnil;
    if (n &gt; 0) return Qtrue;
    return Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reopen">
            
              <a name="method-i-reopen"></a><b>ios.reopen(other_IO)         &rarr; ios
ios.reopen(path, mode_str)   &rarr; ios
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reassociates <em>ios</em> with the I/O stream given in <em>other_IO</em> or
to a new stream opened on <em>path</em>. This may dynamically change the
actual class of this stream.</p>

<pre class="ruby"><span class="ruby-identifier">f1</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f2</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f2</span>.<span class="ruby-identifier">readlines</span>[<span class="ruby-value">0</span>]   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">f2</span>.<span class="ruby-identifier">reopen</span>(<span class="ruby-identifier">f1</span>)     <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
<span class="ruby-identifier">f2</span>.<span class="ruby-identifier">readlines</span>[<span class="ruby-value">0</span>]   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-reopen_source')" id="l_method-i-reopen_source">show</a>
                
              </p>
              <div id="method-i-reopen_source" class="dyn-source">
                <pre>static VALUE
rb_io_reopen(int argc, VALUE *argv, VALUE file)
{
    VALUE fname, nmode;
    int oflags;
    rb_io_t *fptr;

    rb_secure(4);
    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;fname, &amp;nmode) == 1) {
        VALUE tmp = rb_io_check_io(fname);
        if (!NIL_P(tmp)) {
            return io_reopen(file, tmp);
        }
    }

    FilePathValue(fname);
    rb_io_taint_check(file);
    fptr = RFILE(file)-&gt;fptr;
    if (!fptr) {
        fptr = RFILE(file)-&gt;fptr = ALLOC(rb_io_t);
        MEMZERO(fptr, rb_io_t, 1);
    }

    if (!NIL_P(nmode)) {
        int fmode = rb_io_modestr_fmode(StringValueCStr(nmode));
        if (IS_PREP_STDIO(fptr) &amp;&amp;
            ((fptr-&gt;mode &amp; FMODE_READWRITE) &amp; (fmode &amp; FMODE_READWRITE)) !=
            (fptr-&gt;mode &amp; FMODE_READWRITE)) {
            rb_raise(rb_eArgError,
                     &quot;%s can't change access mode from \&quot;%s\&quot; to \&quot;%s\&quot;&quot;,
                     PREP_STDIO_NAME(fptr), rb_io_fmode_modestr(fptr-&gt;mode),
                     rb_io_fmode_modestr(fmode));
        }
        fptr-&gt;mode = fmode;
        rb_io_mode_enc(fptr, StringValueCStr(nmode));
        fptr-&gt;encs.ecflags = 0;
        fptr-&gt;encs.ecopts = Qnil;
    }

    fptr-&gt;pathv = rb_str_new_frozen(fname);
    oflags = rb_io_fmode_oflags(fptr-&gt;mode);
    if (fptr-&gt;fd &lt; 0) {
        fptr-&gt;fd = rb_sysopen(fptr-&gt;pathv, oflags, 0666);
        fptr-&gt;stdio_file = 0;
        return file;
    }

    if (fptr-&gt;mode &amp; FMODE_WRITABLE) {
        if (io_fflush(fptr) &lt; 0)
            rb_sys_fail(0);
    }
    fptr-&gt;rbuf.off = fptr-&gt;rbuf.len = 0;

    if (fptr-&gt;stdio_file) {
        if (freopen(RSTRING_PTR(fptr-&gt;pathv), rb_io_oflags_modestr(oflags), fptr-&gt;stdio_file) == 0) {
            rb_sys_fail_path(fptr-&gt;pathv);
        }
        fptr-&gt;fd = fileno(fptr-&gt;stdio_file);
#ifdef USE_SETVBUF
        if (setvbuf(fptr-&gt;stdio_file, NULL, _IOFBF, 0) != 0)
            rb_warn(&quot;setvbuf() can't be honoured for %s&quot;, RSTRING_PTR(fptr-&gt;pathv));
#endif
    }
    else {
        if (close(fptr-&gt;fd) &lt; 0)
            rb_sys_fail_path(fptr-&gt;pathv);
        fptr-&gt;fd = -1;
        fptr-&gt;fd = rb_sysopen(fptr-&gt;pathv, oflags, 0666);
    }

    return file;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-rewind">
            
              <a name="method-i-rewind"></a><b>ios.rewind    &rarr; 0
</b>
            
          </div>
          
          
            <div class="description">
              <p>Positions <em>ios</em> to the beginning of input, resetting
<code>lineno</code> to zero.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readline</span>   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">rewind</span>     <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">lineno</span>     <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readline</span>   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
</pre>

<p>Note that it cannot be used with streams such as pipes, ttys, and sockets.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-rewind_source')" id="l_method-i-rewind_source">show</a>
                
              </p>
              <div id="method-i-rewind_source" class="dyn-source">
                <pre>static VALUE
rb_io_rewind(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (io_seek(fptr, 0L, 0) &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);
    if (io == ARGF.current_file) {
        ARGF.lineno -= fptr-&gt;lineno;
    }
    fptr-&gt;lineno = 0;
    if (fptr-&gt;readconv) {
        clear_readconv(fptr);
    }

    return INT2FIX(0);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-scanf">
            
              <a name="method-i-scanf"></a><b>scanf</b>(str)
            
          </div>
          
          
            <div class="description">
              <p>Scans the current string until the match is exhausted, yielding each match
as it is encountered in the string. A block is not necessary though, as the
results will simply be aggregated into the final array.</p>

<pre class="ruby"><span class="ruby-string">&quot;123 456&quot;</span>.<span class="ruby-identifier">block_scanf</span>(<span class="ruby-string">&quot;%d&quot;</span>)
<span class="ruby-comment"># =&gt; [123, 456]</span>
</pre>

<p>If a block is given, the value from that is returned from the yield is
added to an output array.</p>

<pre class="ruby"><span class="ruby-string">&quot;123 456&quot;</span>.<span class="ruby-identifier">block_scanf</span>(<span class="ruby-node">&quot;%d) do |digit,| # the ',' unpacks the Array
  digit + 100
end
# =&gt; [223, 556]
</span></pre>

<p>See <a href="Scanf.html">Scanf</a> for details on creating a format string.</p>

<p>You will need to require ‘scanf’ to use use <a
href="IO.html#method-i-scanf">#scanf</a>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-scanf_source')" id="l_method-i-scanf_source">show</a>
                
              </p>
              <div id="method-i-scanf_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/scanf.rb, line 614</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">scanf</span>(<span class="ruby-identifier">str</span>,&amp;<span class="ruby-identifier">b</span>) <span class="ruby-comment">#:yield: current_match</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">block_scanf</span>(<span class="ruby-identifier">str</span>,&amp;<span class="ruby-identifier">b</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">b</span>
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>

  <span class="ruby-identifier">start_position</span> = <span class="ruby-identifier">pos</span> <span class="ruby-keyword">rescue</span> <span class="ruby-number">0</span>
  <span class="ruby-identifier">matched_so_far</span> = <span class="ruby-number">0</span>
  <span class="ruby-identifier">source_buffer</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-identifier">result_buffer</span> = []
  <span class="ruby-identifier">final_result</span> = []

  <span class="ruby-identifier">fstr</span> = <span class="ruby-constant">Scanf</span><span class="ruby-operator">::</span><span class="ruby-constant">FormatString</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">str</span>)

  <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">eof</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">tty?</span> <span class="ruby-operator">&amp;&amp;</span><span class="ruby-operator">!</span> <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">source_buffer</span>))
      <span class="ruby-identifier">final_result</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">result_buffer</span>)
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">source_buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">gets</span>

    <span class="ruby-identifier">current_match</span> = <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">source_buffer</span>)

    <span class="ruby-identifier">spec</span> = <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">last_spec_tried</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">matched</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">mid_match?</span>
        <span class="ruby-identifier">result_buffer</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">current_match</span>)
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">matched_count</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">spec_count</span> <span class="ruby-operator">-</span> <span class="ruby-number">1</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-regexp">/\A\s*\z/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">string_left</span>)
        <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">count_space?</span>
        <span class="ruby-identifier">result_buffer</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">current_match</span>)
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">final_result</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">current_match</span>)

    <span class="ruby-identifier">matched_so_far</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">source_buffer</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-identifier">source_buffer</span>.<span class="ruby-identifier">replace</span>(<span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">string_left</span>)
    <span class="ruby-identifier">matched_so_far</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">source_buffer</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">last_spec</span>
    <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">prune</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">seek</span>(<span class="ruby-identifier">start_position</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">matched_so_far</span>, <span class="ruby-constant">IO</span><span class="ruby-operator">::</span><span class="ruby-constant">SEEK_SET</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ESPIPE</span>
  <span class="ruby-identifier">soak_up_spaces</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">last_spec</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">fstr</span>.<span class="ruby-identifier">space</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">final_result</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-seek">
            
              <a name="method-i-seek"></a><b>ios.seek(amount, whence=IO::SEEK_SET)  &rarr;  0
</b>
            
          </div>
          
          
            <div class="description">
              <p>Seeks to a given offset <em>an<a href="Integer.html">Integer</a></em> in
the stream according to the value of <em>whence</em>:</p>

<pre>IO::SEEK_CUR  | Seeks to _amount_ plus current position
--------------+----------------------------------------------------
IO::SEEK_END  | Seeks to _amount_ plus end of stream (you probably
              | want a negative value for _amount_)
--------------+----------------------------------------------------
IO::SEEK_SET  | Seeks to the absolute location given by _amount_</pre>

<p>Example:</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">seek</span>(<span class="ruby-value">-13</span>, <span class="ruby-constant">IO</span><span class="ruby-operator">::</span><span class="ruby-constant">SEEK_END</span>)   <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">readline</span>                  <span class="ruby-comment">#=&gt; &quot;And so on...\n&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-seek_source')" id="l_method-i-seek_source">show</a>
                
              </p>
              <div id="method-i-seek_source" class="dyn-source">
                <pre>static VALUE
rb_io_seek_m(int argc, VALUE *argv, VALUE io)
{
    VALUE offset, ptrname;
    int whence = SEEK_SET;

    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;offset, &amp;ptrname) == 2) {
        whence = NUM2INT(ptrname);
    }

    return rb_io_seek(io, offset, whence);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-set_encoding">
            
              <a name="method-i-set_encoding"></a><b>io.set_encoding(ext_enc)                &rarr; io
io.set_encoding("ext_enc:int_enc")      &rarr; io
io.set_encoding(ext_enc, int_enc)       &rarr; io
io.set_encoding("ext_enc:int_enc", opt) &rarr; io
io.set_encoding(ext_enc, int_enc, opt)  &rarr; io
</b>
            
          </div>
          
          
            <div class="description">
              <p>If single argument is specified, read string from io is tagged with the
encoding specified.  If encoding is a colon separated two encoding names
“A:B”, the read string is converted from encoding A (external encoding) to
encoding B (internal encoding), then tagged with B.  If two arguments are
specified, those must be encoding objects or encoding names, and the first
one is the external encoding, and the second one is the internal encoding.
If the external encoding and the internal encoding is specified, optional
hash argument specify the conversion option.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-set_encoding_source')" id="l_method-i-set_encoding_source">show</a>
                
              </p>
              <div id="method-i-set_encoding_source" class="dyn-source">
                <pre>static VALUE
rb_io_set_encoding(int argc, VALUE *argv, VALUE io)
{
    rb_io_t *fptr;
    VALUE v1, v2, opt;

    if (TYPE(io) != T_FILE) {
        return rb_funcall2(io, id_set_encoding, argc, argv);
    }

    argc = rb_scan_args(argc, argv, &quot;11:&quot;, &amp;v1, &amp;v2, &amp;opt);
    GetOpenFile(io, fptr);
    io_encoding_set(fptr, v1, v2, opt);
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-stat">
            
              <a name="method-i-stat"></a><b>ios.stat    &rarr; stat
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns status information for <em>ios</em> as an object of type
<code>File::Stat</code>.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">s</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">stat</span>
<span class="ruby-string">&quot;%o&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">mode</span>   <span class="ruby-comment">#=&gt; &quot;100644&quot;</span>
<span class="ruby-identifier">s</span>.<span class="ruby-identifier">blksize</span>       <span class="ruby-comment">#=&gt; 4096</span>
<span class="ruby-identifier">s</span>.<span class="ruby-identifier">atime</span>         <span class="ruby-comment">#=&gt; Wed Apr 09 08:53:54 CDT 2003</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-stat_source')" id="l_method-i-stat_source">show</a>
                
              </p>
              <div id="method-i-stat_source" class="dyn-source">
                <pre>static VALUE
rb_io_stat(VALUE obj)
{
    rb_io_t *fptr;
    struct stat st;

#define rb_sys_fail_path(path) rb_sys_fail(NIL_P(path) ? 0 : RSTRING_PTR(path))
    GetOpenFile(obj, fptr);
    if (fstat(fptr-&gt;fd, &amp;st) == -1) {
        rb_sys_fail_path(fptr-&gt;pathv);
    }
    return stat_new(&amp;st);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sync">
            
              <a name="method-i-sync"></a><b>ios.sync    &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the current “sync mode” of <em>ios</em>. When sync mode is true,
all output is immediately flushed to the underlying operating system and is
not buffered by Ruby internally. See also <code>IO#fsync</code>.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">sync</span>   <span class="ruby-comment">#=&gt; false</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-sync_source')" id="l_method-i-sync_source">show</a>
                
              </p>
              <div id="method-i-sync_source" class="dyn-source">
                <pre>static VALUE
rb_io_sync(VALUE io)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    return (fptr-&gt;mode &amp; FMODE_SYNC) ? Qtrue : Qfalse;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sync-3D">
            
              <a name="method-i-sync-3D"></a><b>ios.sync = boolean   &rarr; boolean
</b>
            
          </div>
          
          
            <div class="description">
              <p>Sets the “sync mode” to <code>true</code> or <code>false</code>. When sync
mode is true, all output is immediately flushed to the underlying operating
system and is not buffered internally. Returns the new state. See also
<code>IO#fsync</code>.</p>

<pre>f = File.new(&quot;testfile&quot;)
f.sync = true</pre>

<p><em>(produces no output)</em></p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-sync-3D_source')" id="l_method-i-sync-3D_source">show</a>
                
              </p>
              <div id="method-i-sync-3D_source" class="dyn-source">
                <pre>static VALUE
rb_io_set_sync(VALUE io, VALUE sync)
{
    rb_io_t *fptr;

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    if (RTEST(sync)) {
        fptr-&gt;mode |= FMODE_SYNC;
    }
    else {
        fptr-&gt;mode &amp;= ~FMODE_SYNC;
    }
    return sync;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sysread">
            
              <a name="method-i-sysread"></a><b>ios.sysread(maxlen[, outbuf])    &rarr; string
</b>
            
          </div>
          
          
            <div class="description">
              <p>Reads <em>maxlen</em> bytes from <em>ios</em> using a low-level read and
returns them as a string.  Do not mix with other methods that read from
<em>ios</em> or you may get unpredictable results. If the optional
<em>outbuf</em> argument is present, it must reference a String, which will
receive the data. Raises <code>SystemCallError</code> on error and
<code>EOFError</code> at end of file.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">sysread</span>(<span class="ruby-value">16</span>)   <span class="ruby-comment">#=&gt; &quot;This is line one&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-sysread_source')" id="l_method-i-sysread_source">show</a>
                
              </p>
              <div id="method-i-sysread_source" class="dyn-source">
                <pre>static VALUE
rb_io_sysread(int argc, VALUE *argv, VALUE io)
{
    VALUE len, str;
    rb_io_t *fptr;
    long n, ilen;

    rb_scan_args(argc, argv, &quot;11&quot;, &amp;len, &amp;str);
    ilen = NUM2LONG(len);

    io_setstrbuf(&amp;str,ilen);
    if (ilen == 0) return str;

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);

    if (READ_DATA_BUFFERED(fptr)) {
        rb_raise(rb_eIOError, &quot;sysread for buffered IO&quot;);
    }

    n = fptr-&gt;fd;
    rb_thread_wait_fd(fptr-&gt;fd);
    rb_io_check_closed(fptr);

    rb_str_locktmp(str);
    n = rb_read_internal(fptr-&gt;fd, RSTRING_PTR(str), ilen);
    rb_str_unlocktmp(str);

    if (n == -1) {
        rb_sys_fail_path(fptr-&gt;pathv);
    }
    rb_str_set_len(str, n);
    if (n == 0 &amp;&amp; ilen &gt; 0) {
        rb_eof_error();
    }
    rb_str_resize(str, n);
    OBJ_TAINT(str);

    return str;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sysseek">
            
              <a name="method-i-sysseek"></a><b>ios.sysseek(offset, whence=IO::SEEK_SET)   &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Seeks to a given <em>offset</em> in the stream according to the value of
<em>whence</em> (see <code>IO#seek</code> for values of <em>whence</em>).
Returns the new offset into the file.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">sysseek</span>(<span class="ruby-value">-13</span>, <span class="ruby-constant">IO</span><span class="ruby-operator">::</span><span class="ruby-constant">SEEK_END</span>)   <span class="ruby-comment">#=&gt; 53</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">sysread</span>(<span class="ruby-value">10</span>)                  <span class="ruby-comment">#=&gt; &quot;And so on.&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-sysseek_source')" id="l_method-i-sysseek_source">show</a>
                
              </p>
              <div id="method-i-sysseek_source" class="dyn-source">
                <pre>static VALUE
rb_io_sysseek(int argc, VALUE *argv, VALUE io)
{
    VALUE offset, ptrname;
    int whence = SEEK_SET;
    rb_io_t *fptr;
    off_t pos;

    if (rb_scan_args(argc, argv, &quot;11&quot;, &amp;offset, &amp;ptrname) == 2) {
        whence = NUM2INT(ptrname);
    }
    pos = NUM2OFFT(offset);
    GetOpenFile(io, fptr);
    if ((fptr-&gt;mode &amp; FMODE_READABLE) &amp;&amp;
        (READ_DATA_BUFFERED(fptr) || READ_CHAR_PENDING(fptr))) {
        rb_raise(rb_eIOError, &quot;sysseek for buffered IO&quot;);
    }
    if ((fptr-&gt;mode &amp; FMODE_WRITABLE) &amp;&amp; fptr-&gt;wbuf.len) {
        rb_warn(&quot;sysseek for buffered IO&quot;);
    }
    errno = 0;
    pos = lseek(fptr-&gt;fd, pos, whence);
    if (pos == -1 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);

    return OFFT2NUM(pos);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-syswrite">
            
              <a name="method-i-syswrite"></a><b>ios.syswrite(string)   &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Writes the given string to <em>ios</em> using a low-level write. Returns
the number of bytes written. Do not mix with other methods that write to
<em>ios</em> or you may get unpredictable results. Raises
<code>SystemCallError</code> on error.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;out&quot;</span>, <span class="ruby-string">&quot;w&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">syswrite</span>(<span class="ruby-string">&quot;ABCDEF&quot;</span>)   <span class="ruby-comment">#=&gt; 6</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-syswrite_source')" id="l_method-i-syswrite_source">show</a>
                
              </p>
              <div id="method-i-syswrite_source" class="dyn-source">
                <pre>static VALUE
rb_io_syswrite(VALUE io, VALUE str)
{
    rb_io_t *fptr;
    long n;

    rb_secure(4);
    if (TYPE(str) != T_STRING)
        str = rb_obj_as_string(str);

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    rb_io_check_writable(fptr);

    if (fptr-&gt;wbuf.len) {
        rb_warn(&quot;syswrite for buffered IO&quot;);
    }
    if (!rb_thread_fd_writable(fptr-&gt;fd)) {
        rb_io_check_closed(fptr);
    }

    n = rb_write_internal(fptr-&gt;fd, RSTRING_PTR(str), RSTRING_LEN(str));

    if (n == -1) rb_sys_fail_path(fptr-&gt;pathv);

    return LONG2FIX(n);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-tell">
            
              <a name="method-i-tell"></a><b>ios.pos     &rarr; integer
ios.tell    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns the current offset (in bytes) of <em>ios</em>.</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">pos</span>    <span class="ruby-comment">#=&gt; 0</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>   <span class="ruby-comment">#=&gt; &quot;This is line one\n&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">pos</span>    <span class="ruby-comment">#=&gt; 17</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-tell_source')" id="l_method-i-tell_source">show</a>
                
              </p>
              <div id="method-i-tell_source" class="dyn-source">
                <pre>static VALUE
rb_io_tell(VALUE io)
{
    rb_io_t *fptr;
    off_t pos;

    GetOpenFile(io, fptr);
    pos = io_tell(fptr);
    if (pos &lt; 0 &amp;&amp; errno) rb_sys_fail_path(fptr-&gt;pathv);
    pos -= fptr-&gt;rbuf.len;
    return OFFT2NUM(pos);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_i">
            
              <a name="method-i-to_i"></a><b>to_i</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_io">
            
              <a name="method-i-to_io"></a><b>ios.to_io  &rarr;  ios
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <em>ios</em>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_io_source')" id="l_method-i-to_io_source">show</a>
                
              </p>
              <div id="method-i-to_io_source" class="dyn-source">
                <pre>static VALUE
rb_io_to_io(VALUE io)
{
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-tty-3F">
            
              <a name="method-i-tty-3F"></a><b>ios.isatty   &rarr; true or false
ios.tty?     &rarr; true or false
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns <code>true</code> if <em>ios</em> is associated with a terminal
device (tty), <code>false</code> otherwise.</p>

<pre class="ruby"><span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>).<span class="ruby-identifier">isatty</span>   <span class="ruby-comment">#=&gt; false</span>
<span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;/dev/tty&quot;</span>).<span class="ruby-identifier">isatty</span>   <span class="ruby-comment">#=&gt; true</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-tty-3F_source')" id="l_method-i-tty-3F_source">show</a>
                
              </p>
              <div id="method-i-tty-3F_source" class="dyn-source">
                <pre>static VALUE
rb_io_isatty(VALUE io)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    if (isatty(fptr-&gt;fd) == 0)
        return Qfalse;
    return Qtrue;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ungetbyte">
            
              <a name="method-i-ungetbyte"></a><b>ios.ungetbyte(string)   &rarr; nil
ios.ungetbyte(integer)   &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Pushes back bytes (passed as a parameter) onto <em>ios</em>, such that a
subsequent buffered read will return it. Only one byte may be pushed back
before a subsequent read operation (that is, you will be able to read only
the last of several bytes that have been pushed back). Has no effect with
unbuffered reads (such as <code>IO#sysread</code>).</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)   <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
<span class="ruby-identifier">b</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">getbyte</span>              <span class="ruby-comment">#=&gt; 0x38</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">ungetbyte</span>(<span class="ruby-identifier">b</span>)             <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">getbyte</span>                  <span class="ruby-comment">#=&gt; 0x38</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ungetbyte_source')" id="l_method-i-ungetbyte_source">show</a>
                
              </p>
              <div id="method-i-ungetbyte_source" class="dyn-source">
                <pre>VALUE
rb_io_ungetbyte(VALUE io, VALUE b)
{
    rb_io_t *fptr;

    GetOpenFile(io, fptr);
    rb_io_check_byte_readable(fptr);
    if (NIL_P(b)) return Qnil;
    if (FIXNUM_P(b)) {
        char cc = FIX2INT(b);
        b = rb_str_new(&amp;cc, 1);
    }
    else {
        SafeStringValue(b);
    }
    io_ungetbyte(b, fptr);
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ungetc">
            
              <a name="method-i-ungetc"></a><b>ios.ungetc(string)   &rarr; nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Pushes back one character (passed as a parameter) onto <em>ios</em>, such
that a subsequent buffered character read will return it. Only one
character may be pushed back before a subsequent read operation (that is,
you will be able to read only the last of several characters that have been
pushed back). Has no effect with unbuffered reads (such as
<code>IO#sysread</code>).</p>

<pre class="ruby"><span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;testfile&quot;</span>)   <span class="ruby-comment">#=&gt; #&lt;File:testfile&gt;</span>
<span class="ruby-identifier">c</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">getc</span>                 <span class="ruby-comment">#=&gt; &quot;8&quot;</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">ungetc</span>(<span class="ruby-identifier">c</span>)                <span class="ruby-comment">#=&gt; nil</span>
<span class="ruby-identifier">f</span>.<span class="ruby-identifier">getc</span>                     <span class="ruby-comment">#=&gt; &quot;8&quot;</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ungetc_source')" id="l_method-i-ungetc_source">show</a>
                
              </p>
              <div id="method-i-ungetc_source" class="dyn-source">
                <pre>VALUE
rb_io_ungetc(VALUE io, VALUE c)
{
    rb_io_t *fptr;
    long len;

    GetOpenFile(io, fptr);
    rb_io_check_char_readable(fptr);
    if (NIL_P(c)) return Qnil;
    if (FIXNUM_P(c)) {
        c = rb_enc_uint_chr(FIX2UINT(c), io_read_encoding(fptr));
    }
    else if (TYPE(c) == T_BIGNUM) {
        c = rb_enc_uint_chr(NUM2UINT(c), io_read_encoding(fptr));
    }
    else {
        SafeStringValue(c);
    }
    if (NEED_READCONV(fptr)) {
        len = RSTRING_LEN(c);
#if SIZEOF_LONG &gt; SIZEOF_INT
        if (len &gt; INT_MAX)
            rb_raise(rb_eIOError, &quot;ungetc failed&quot;);
#endif
        make_readconv(fptr, (int)len);
        if (fptr-&gt;cbuf.capa - fptr-&gt;cbuf.len &lt; len)
            rb_raise(rb_eIOError, &quot;ungetc failed&quot;);
        if (fptr-&gt;cbuf.off &lt; len) {
            MEMMOVE(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.capa-fptr-&gt;cbuf.len,
                    fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off,
                    char, fptr-&gt;cbuf.len);
            fptr-&gt;cbuf.off = fptr-&gt;cbuf.capa-fptr-&gt;cbuf.len;
        }
        fptr-&gt;cbuf.off -= (int)len;
        fptr-&gt;cbuf.len += (int)len;
        MEMMOVE(fptr-&gt;cbuf.ptr+fptr-&gt;cbuf.off, RSTRING_PTR(c), char, len);
    }
    else {
        io_ungetbyte(c, fptr);
    }
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-wait">
            
              <a name="method-i-wait"></a><b>io.wait          &rarr; IO, true, false or nil
io.wait(timeout) &rarr; IO, true, false or nil
</b>
            
          </div>
          
          
            <div class="description">
              <p>Waits until input is available or times out and returns self or nil when
EOF is reached.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-wait_source')" id="l_method-i-wait_source">show</a>
                
              </p>
              <div id="method-i-wait_source" class="dyn-source">
                <pre>static VALUE
io_wait(int argc, VALUE *argv, VALUE io)
{
    rb_io_t *fptr;
    int i;
    ioctl_arg n;
    VALUE timeout;
    struct timeval timerec;
    struct timeval *tv;

    GetOpenFile(io, fptr);
    rb_io_check_readable(fptr);
    rb_scan_args(argc, argv, &quot;01&quot;, &amp;timeout);
    if (NIL_P(timeout)) {
        tv = NULL;
    }
    else {
        timerec = rb_time_interval(timeout);
        tv = &amp;timerec;
    }

    if (rb_io_read_pending(fptr)) return Qtrue;
    if (!FIONREAD_POSSIBLE_P(fptr-&gt;fd)) return Qfalse;
    i = rb_wait_for_single_fd(fptr-&gt;fd, RB_WAITFD_IN, tv);
    if (i &lt; 0)
        rb_sys_fail(0);
    rb_io_check_closed(fptr);
    if (ioctl(fptr-&gt;fd, FIONREAD, &amp;n)) rb_sys_fail(0);
    if (n &gt; 0) return io;
    return Qnil;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-winsize">
            
              <a name="method-i-winsize"></a><b>io.winsize     &rarr; [rows, columns]
</b>
            
          </div>
          
          
            <div class="description">
              <p>Returns console size.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-winsize_source')" id="l_method-i-winsize_source">show</a>
                
              </p>
              <div id="method-i-winsize_source" class="dyn-source">
                <pre>static VALUE
console_winsize(VALUE io)
{
    rb_io_t *fptr;
    int fd;
    rb_console_size_t ws;

    GetOpenFile(io, fptr);
    fd = GetWriteFD(fptr);
    if (!getwinsize(fd, &amp;ws)) rb_sys_fail(0);
    return rb_assoc_new(INT2NUM(winsize_row(&amp;ws)), INT2NUM(winsize_col(&amp;ws)));
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-winsize-3D">
            
              <a name="method-i-winsize-3D"></a><b>io.winsize = [rows, columns]
</b>
            
          </div>
          
          
            <div class="description">
              <p>Tries to set console size.  The effect depends on the platform and the
running environment.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-winsize-3D_source')" id="l_method-i-winsize-3D_source">show</a>
                
              </p>
              <div id="method-i-winsize-3D_source" class="dyn-source">
                <pre>static VALUE
console_set_winsize(VALUE io, VALUE size)
{
    rb_io_t *fptr;
    rb_console_size_t ws;
#if defined _WIN32
    HANDLE wh;
    int newrow, newcol;
#endif
    VALUE row, col, xpixel, ypixel;
    int fd;

    GetOpenFile(io, fptr);
    size = rb_Array(size);
    rb_scan_args((int)RARRAY_LEN(size), RARRAY_PTR(size), &quot;22&quot;,
                &amp;row, &amp;col, &amp;xpixel, &amp;ypixel);
#if defined TIOCSWINSZ
    fd = GetWriteFD(fptr);
    ws.ws_row = ws.ws_col = ws.ws_xpixel = ws.ws_ypixel = 0;
#define SET(m) ws.ws_##m = NIL_P(m) ? 0 : (unsigned short)NUM2UINT(m)
    SET(row);
    SET(col);
    SET(xpixel);
    SET(ypixel);
#undef SET
    if (!setwinsize(fd, &amp;ws)) rb_sys_fail(0);
#elif defined _WIN32
    wh = (HANDLE)rb_w32_get_osfhandle(GetReadFD(fptr));
    newrow = (SHORT)NUM2UINT(row);
    newcol = (SHORT)NUM2UINT(col);
    if (!getwinsize(GetReadFD(fptr), &amp;ws)) {
        rb_sys_fail(&quot;GetConsoleScreenBufferInfo&quot;);
    }
    if ((ws.dwSize.X &lt; newcol &amp;&amp; (ws.dwSize.X = newcol, 1)) ||
        (ws.dwSize.Y &lt; newrow &amp;&amp; (ws.dwSize.Y = newrow, 1))) {
        if (!(SetConsoleScreenBufferSize(wh, ws.dwSize) || SET_LAST_ERROR)) {
            rb_sys_fail(&quot;SetConsoleScreenBufferInfo&quot;);
        }
    }
    ws.srWindow.Left = 0;
    ws.srWindow.Top = 0;
    ws.srWindow.Right = newcol;
    ws.srWindow.Bottom = newrow;
    if (!(SetConsoleWindowInfo(wh, FALSE, &amp;ws.srWindow) || SET_LAST_ERROR)) {
        rb_sys_fail(&quot;SetConsoleWindowInfo&quot;);
    }
#endif
    return io;
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-write">
            
              <a name="method-i-write"></a><b>ios.write(string)    &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Writes the given string to <em>ios</em>. The stream must be opened for
writing. If the argument is not a string, it will be converted to a string
using <code>to_s</code>. Returns the number of bytes written.</p>

<pre>count = $stdout.write(&quot;This is a test\n&quot;)
puts &quot;That was #{count} bytes of data&quot;</pre>

<p><em>produces:</em></p>

<pre>This is a test
That was 15 bytes of data</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-write_source')" id="l_method-i-write_source">show</a>
                
              </p>
              <div id="method-i-write_source" class="dyn-source">
                <pre>static VALUE
io_write_m(VALUE io, VALUE str)
{
    return io_write(io, str, 0);
}</pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-write_nonblock">
            
              <a name="method-i-write_nonblock"></a><b>ios.write_nonblock(string)   &rarr; integer
</b>
            
          </div>
          
          
            <div class="description">
              <p>Writes the given string to <em>ios</em> using the write(2) system call
after O_NONBLOCK is set for the underlying file descriptor.</p>

<p>It returns the number of bytes written.</p>

<p><a href="IO.html#method-i-write_nonblock">#write_nonblock</a> just calls
the write(2) system call. It causes all errors the write(2) system call
causes: Errno::EWOULDBLOCK, Errno::EINTR, etc. The result may also be
smaller than string.length (partial write). The caller should care such
errors and partial write.</p>

<p>If the exception is Errno::EWOULDBLOCK or Errno::AGAIN, it is extended by
<a href="IO/WaitWritable.html">IO::WaitWritable</a>. So <a
href="IO/WaitWritable.html">IO::WaitWritable</a> can be used to rescue the
exceptions for retrying write_nonblock.</p>

<pre class="ruby"><span class="ruby-comment"># Creates a pipe.</span>
<span class="ruby-identifier">r</span>, <span class="ruby-identifier">w</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">pipe</span>

<span class="ruby-comment"># write_nonblock writes only 65536 bytes and return 65536.</span>
<span class="ruby-comment"># (The pipe size is 65536 bytes on this environment.)</span>
<span class="ruby-identifier">s</span> = <span class="ruby-string">&quot;a&quot;</span> * <span class="ruby-value">100000</span>
<span class="ruby-identifier">p</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">write_nonblock</span>(<span class="ruby-identifier">s</span>)     <span class="ruby-comment">#=&gt; 65536</span>

<span class="ruby-comment"># write_nonblock cannot write a byte and raise EWOULDBLOCK (EAGAIN).</span>
<span class="ruby-identifier">p</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">write_nonblock</span>(<span class="ruby-string">&quot;b&quot;</span>)   <span class="ruby-comment"># Resource temporarily unavailable (Errno::EAGAIN)</span>
</pre>

<p>If the write buffer is not empty, it is flushed at first.</p>

<p>When <a href="IO.html#method-i-write_nonblock">#write_nonblock</a> raises
an exception kind of <a href="IO/WaitWritable.html">IO::WaitWritable</a>,
<a href="IO.html#method-i-write_nonblock">#write_nonblock</a> should not be
called until io is writable for avoiding busy loop. This can be done as
follows.</p>

<pre>begin
  result = io.write_nonblock(string)
rescue IO::WaitWritable, Errno::EINTR
  IO.select(nil, [io])
  retry
end</pre>

<p>Note that this doesn’t guarantee to write all data in string. The length
written is reported as result and it should be checked later.</p>

<p>On some platforms such as Windows, <a
href="IO.html#method-i-write_nonblock">#write_nonblock</a> is not supported
according to the kind of the <a href="IO.html">IO</a> object. In such
cases, <a href="IO.html#method-i-write_nonblock">#write_nonblock</a> raises
<code>Errno::EBADF</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-write_nonblock_source')" id="l_method-i-write_nonblock_source">show</a>
                
              </p>
              <div id="method-i-write_nonblock_source" class="dyn-source">
                <pre>static VALUE
rb_io_write_nonblock(VALUE io, VALUE str)
{
    rb_io_t *fptr;
    long n;

    rb_secure(4);
    if (TYPE(str) != T_STRING)
        str = rb_obj_as_string(str);

    io = GetWriteIO(io);
    GetOpenFile(io, fptr);
    rb_io_check_writable(fptr);

    if (io_fflush(fptr) &lt; 0)
        rb_sys_fail(0);

    rb_io_set_nonblock(fptr);
    n = write(fptr-&gt;fd, RSTRING_PTR(str), RSTRING_LEN(str));

    if (n == -1) {
        if (errno == EWOULDBLOCK || errno == EAGAIN)
            rb_mod_sys_fail(rb_mWaitWritable, &quot;write would block&quot;);
        rb_sys_fail_path(fptr-&gt;pathv);
    }

    return LONG2FIX(n);
}</pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    