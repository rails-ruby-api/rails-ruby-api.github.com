<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Gem::Installer</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Gem::Installer 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/rubygems/installer_rb.html">lib/rubygems/installer.rb</a></li>
            
            <li><a href="../../files/lib/rubygems/installer_test_case_rb.html">lib/rubygems/installer_test_case.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>The installer class processes RubyGem .gem files and installs the files
contained in the .gem into the <a
href="../Gem.html#method-c-path">Gem.path</a>.</p>

<p><a href="Installer.html">Gem::Installer</a> does the work of putting files
in all the right places on the filesystem including unpacking the gem into
its gem dir, installing the gemspec in the specifications dir, storing the
cached gem in the cache dir, and installing either wrappers or symlinks for
executables.</p>

<p>The installer invokes pre and post install hooks.  Hooks can be added
either through a rubygems_plugin.rb file in an installed gem or via a
rubygems/defaults/#{RUBY_ENGINE}.rb or
rubygems/defaults/operating_system.rb file.  See <a
href="../Gem.html#method-c-pre_install">Gem.pre_install</a> and <a
href="../Gem.html#method-c-post_install">Gem.post_install</a> for details.</p>

    </div>
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">CLASS</span>
          <a href="Installer/ExtensionBuildError.html">Gem::Installer::ExtensionBuildError</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-app_script_text">app_script_text</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-build_extensions">build_extensions</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-check_that_user_bin_dir_is_in_path">check_that_user_bin_dir_is_in_path</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-dir">dir</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ensure_dependencies_met">ensure_dependencies_met</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ensure_dependency">ensure_dependency</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ensure_required_ruby_version_met">ensure_required_ruby_version_met</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ensure_required_rubygems_version_met">ensure_required_rubygems_version_met</a>,
              </li>
            
              
              <li>
                <a href="#method-c-exec_format">exec_format</a>,
              </li>
            
              
              <li>
                <a href="#method-i-extract_files">extract_files</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-format">format</a>,
              </li>
            
              
              <li>
                <a href="#method-i-formatted_program_filename">formatted_program_filename</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-gem_dir">gem_dir</a>,
              </li>
            
              
              <li>
                <a href="#method-i-generate_bin">generate_bin</a>,
              </li>
            
              
              <li>
                <a href="#method-i-generate_bin_script">generate_bin_script</a>,
              </li>
            
              
              <li>
                <a href="#method-i-generate_bin_symlink">generate_bin_symlink</a>,
              </li>
            
              
              <li>
                <a href="#method-i-generate_windows_script">generate_windows_script</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-install">install</a>,
              </li>
            
              
              <li>
                <a href="#method-i-installation_satisfies_dependency-3F">installation_satisfies_dependency?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-process_options">process_options</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-shebang">shebang</a>,
              </li>
            
              
              <li>
                <a href="#method-i-spec">spec</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-unpack">unpack</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>V</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-verify_gem_home">verify_gem_home</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>W</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-windows_stub_script">windows_stub_script</a>,
              </li>
            
              
              <li>
                <a href="#method-i-write_spec">write_spec</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="UserInteraction.html">
              Gem::UserInteraction
            </a>
          
        </li>
      
        <li>
          
            <a href="RequirePathsBuilder.html">
              Gem::RequirePathsBuilder
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">ENV_PATHS</td>
            <td>=</td>
            <td class="attr-value">%w[/usr/bin/env /bin/env]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"><p>Paths where env(1) might live.  Some systems are broken and have it in /bin</p></td>
            </tr>
          
        
      </table>
    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>exec_format</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>path_warning</td>
            <td class='attr-desc'><p>True if we’ve warned about PATH not including <a
href="../Gem.html#method-c-bindir">Gem.bindir</a></p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>bin_dir</td>
            <td class='attr-desc'><p>The directory a gem’s executables will be installed into</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>env_shebang</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>format</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>format_executable</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>gem</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>gem_dir</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>gem_home</td>
            <td class='attr-desc'><p>The gem repository the gem will be installed into</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>ignore_dependencies</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>options</td>
            <td class='attr-desc'><p>The options passed when the <a href="Installer.html">Gem::Installer</a> was
instantiated.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>security_policy</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>spec</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>wrappers</td>
            <td class='attr-desc'><p>Available through requiring rubygems/installer_test_case</p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-exec_format">
            
              <a name="method-c-exec_format"></a><b>exec_format</b>()
            
          </div>
          
          
            <div class="description">
              <p>Defaults to use Ruby’s program prefix and suffix.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-exec_format_source')" id="l_method-c-exec_format_source">show</a>
                
              </p>
              <div id="method-c-exec_format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 73</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">exec_format</span>
  <span class="ruby-ivar">@exec_format</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">default_exec_format</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(gem, options={})
            
          </div>
          
          
            <div class="description">
              <p>Constructs an <a href="Installer.html">Installer</a> instance that will
install the gem located at <code>gem</code>.  <code>options</code> is a <a
href="../Hash.html">Hash</a> with the following keys:</p>
<dl class="rdoc-list note-list"><dt>:<a href="Installer.html#attribute-i-env_shebang">#env_shebang</a>
<dd>
<p>Use /usr/bin/env in bin wrappers.</p>
</dd><dt>:force
<dd>
<p>Overrides all version checks and security policy checks, except for a
signed-gems-only policy.</p>
</dd><dt>:<a href="Installer.html#attribute-i-ignore_dependencies">#ignore_dependencies</a>
<dd>
<p>Don’t raise if a dependency is missing.</p>
</dd><dt>:install_dir
<dd>
<p>The directory to install the gem into.</p>
</dd><dt>:<a href="Installer.html#attribute-i-format_executable">#format_executable</a>
<dd>
<p><a href="Format.html">Format</a> the executable the same as the ruby
executable. If your ruby is ruby18, foo_exec will be installed as
foo_exec18.</p>
</dd><dt>:<a href="Installer.html#attribute-i-security_policy">#security_policy</a>
<dd>
<p>Use the specified security policy.  See <a
href="Security.html">Gem::Security</a></p>
</dd><dt>:wrappers
<dd>
<p>Install wrappers if true, symlinks if false.</p>
</dd></dl>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>(<span class="ruby-identifier">gem</span>, <span class="ruby-identifier">options</span>={})
  <span class="ruby-identifier">require</span> <span class="ruby-string">'fileutils'</span>

  <span class="ruby-ivar">@gem</span> = <span class="ruby-identifier">gem</span>
  <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
  <span class="ruby-identifier">process_options</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:user_install</span>] <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:unpack</span>] <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@gem_home</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">user_dir</span>
    <span class="ruby-identifier">check_that_user_bin_dir_is_in_path</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-app_script_text">
            
              <a name="method-i-app_script_text"></a><b>app_script_text</b>(bin_file_name)
            
          </div>
          
          
            <div class="description">
              <p>Return the text for an application file.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-app_script_text_source')" id="l_method-i-app_script_text_source">show</a>
                
              </p>
              <div id="method-i-app_script_text_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 455</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">app_script_text</span>(<span class="ruby-identifier">bin_file_name</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;#{shebang bin_file_name}
#
# This file was generated by RubyGems.
#
# The application '#{spec.name}' is installed as part of a gem, and
# this file is here to facilitate running it.
#

require 'rubygems'

version = &quot;#{Gem::Requirement.default}&quot;

if ARGV.first =~ /^_(.*)_$/ and Gem::Version.correct? $1 then
  version = $1
  ARGV.shift
end

gem '#{spec.name}', version
load Gem.bin_path('#{spec.name}', '#{bin_file_name}', version)
&quot;</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-build_extensions">
            
              <a name="method-i-build_extensions"></a><b>build_extensions</b>()
            
          </div>
          
          
            <div class="description">
              <p>Builds extensions.  Valid types of extensions are extconf.rb files,
configure scripts and rakefiles or mkrf_conf files.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-build_extensions_source')" id="l_method-i-build_extensions_source">show</a>
                
              </p>
              <div id="method-i-build_extensions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 499</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">build_extensions</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">say</span> <span class="ruby-string">&quot;Building native extensions.  This could take a while...&quot;</span>
    <span class="ruby-identifier">dest_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">gem_dir</span>, <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">require_paths</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">ran_rake</span> = <span class="ruby-keyword">false</span> <span class="ruby-comment"># only run rake once</span>

    <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">extension</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ran_rake</span>
      <span class="ruby-identifier">results</span> = []

      <span class="ruby-identifier">builder</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">extension</span>
                <span class="ruby-keyword">when</span> <span class="ruby-regexp">/extconf/</span> <span class="ruby-keyword">then</span>
                  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Ext</span><span class="ruby-operator">::</span><span class="ruby-constant">ExtConfBuilder</span>
                <span class="ruby-keyword">when</span> <span class="ruby-regexp">/configure/</span> <span class="ruby-keyword">then</span>
                  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Ext</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigureBuilder</span>
                <span class="ruby-keyword">when</span> <span class="ruby-regexp">/rakefile/</span>, <span class="ruby-regexp">/mkrf_conf/</span> <span class="ruby-keyword">then</span>
                  <span class="ruby-identifier">ran_rake</span> = <span class="ruby-keyword">true</span>
                  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Ext</span><span class="ruby-operator">::</span><span class="ruby-constant">RakeBuilder</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-identifier">results</span> = [<span class="ruby-node">&quot;No builder for extension '#{extension}'&quot;</span>]
                  <span class="ruby-keyword">nil</span>
                <span class="ruby-keyword">end</span>


      <span class="ruby-identifier">extension_dir</span> = <span class="ruby-keyword">begin</span>
                        <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">gem_dir</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">extension</span>)
                      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">TypeError</span> <span class="ruby-comment"># extension == nil</span>
                        <span class="ruby-identifier">gem_dir</span>
                      <span class="ruby-keyword">end</span>


      <span class="ruby-keyword">begin</span>
        <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-identifier">extension_dir</span> <span class="ruby-keyword">do</span>
          <span class="ruby-identifier">results</span> = <span class="ruby-identifier">builder</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">extension</span>, <span class="ruby-identifier">gem_dir</span>, <span class="ruby-identifier">dest_path</span>, <span class="ruby-identifier">results</span>)

          <span class="ruby-identifier">say</span> <span class="ruby-identifier">results</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span>
        <span class="ruby-identifier">results</span> = <span class="ruby-identifier">results</span>.<span class="ruby-identifier">join</span> <span class="ruby-string">&quot;\n&quot;</span>

        <span class="ruby-identifier">gem_make_out</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">extension_dir</span>, <span class="ruby-string">'gem_make.out'</span>

        <span class="ruby-identifier">open</span> <span class="ruby-identifier">gem_make_out</span>, <span class="ruby-string">'wb'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">results</span> <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">message</span> = <span class="ruby-string">&quot;ERROR: Failed to build gem native extension.

        #{results}

Gem files will remain installed in #{gem_dir} for inspection.
Results logged to #{gem_make_out}
&quot;</span>

        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ExtensionBuildError</span>, <span class="ruby-identifier">message</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-check_that_user_bin_dir_is_in_path">
            
              <a name="method-i-check_that_user_bin_dir_is_in_path"></a><b>check_that_user_bin_dir_is_in_path</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-check_that_user_bin_dir_is_in_path_source')" id="l_method-i-check_that_user_bin_dir_is_in_path_source">show</a>
                
              </p>
              <div id="method-i-check_that_user_bin_dir_is_in_path_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 435</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">check_that_user_bin_dir_is_in_path</span>
  <span class="ruby-identifier">user_bin_dir</span> = <span class="ruby-ivar">@bin_dir</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">bindir</span>(<span class="ruby-identifier">gem_home</span>)
  <span class="ruby-identifier">user_bin_dir</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>, <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">ALT_SEPARATOR</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">ALT_SEPARATOR</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">'PATH'</span>].<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>).<span class="ruby-identifier">include?</span> <span class="ruby-identifier">user_bin_dir</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">path_warning</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">alert_warning</span> <span class="ruby-node">&quot;You don't have #{user_bin_dir} in your PATH,\n\t  gem executables will not run.&quot;</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">path_warning</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dir">
            
              <a name="method-i-dir"></a><b>dir</b>()
            
          </div>
          
          
            <div class="description">
              <p>Return the target directory where the gem is to be installed. This
directory is not guaranteed to be populated.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dir_source')" id="l_method-i-dir_source">show</a>
                
              </p>
              <div id="method-i-dir_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 612</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dir</span>
  <span class="ruby-identifier">gem_dir</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ensure_dependencies_met">
            
              <a name="method-i-ensure_dependencies_met"></a><b>ensure_dependencies_met</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ensure_dependencies_met_source')" id="l_method-i-ensure_dependencies_met_source">show</a>
                
              </p>
              <div id="method-i-ensure_dependencies_met_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 403</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ensure_dependencies_met</span>
  <span class="ruby-identifier">deps</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">runtime_dependencies</span>
  <span class="ruby-identifier">deps</span> <span class="ruby-operator">|=</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">development_dependencies</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@development</span>

  <span class="ruby-identifier">deps</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dep_gem</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ensure_dependency</span> <span class="ruby-identifier">spec</span>, <span class="ruby-identifier">dep_gem</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ensure_dependency">
            
              <a name="method-i-ensure_dependency"></a><b>ensure_dependency</b>(spec, dependency)
            
          </div>
          
          
            <div class="description">
              <p>Ensure that the dependency is satisfied by the current installation of gem.
If it is not an exception is raised.</p>
<dl class="rdoc-list note-list"><dt>spec       
<dd>
<p><a href="Specification.html">Gem::Specification</a></p>
</dd><dt>dependency 
<dd>
<p><a href="Dependency.html">Gem::Dependency</a></p>
</dd></dl>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ensure_dependency_source')" id="l_method-i-ensure_dependency_source">show</a>
                
              </p>
              <div id="method-i-ensure_dependency_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 230</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ensure_dependency</span>(<span class="ruby-identifier">spec</span>, <span class="ruby-identifier">dependency</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">installation_satisfies_dependency?</span> <span class="ruby-identifier">dependency</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-node">&quot;#{spec.name} requires #{dependency}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ensure_required_ruby_version_met">
            
              <a name="method-i-ensure_required_ruby_version_met"></a><b>ensure_required_ruby_version_met</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ensure_required_ruby_version_met_source')" id="l_method-i-ensure_required_ruby_version_met_source">show</a>
                
              </p>
              <div id="method-i-ensure_required_ruby_version_met_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 385</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ensure_required_ruby_version_met</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rrv</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">required_ruby_version</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">rrv</span>.<span class="ruby-identifier">satisfied_by?</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ruby_version</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-node">&quot;#{spec.name} requires Ruby version #{rrv}.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ensure_required_rubygems_version_met">
            
              <a name="method-i-ensure_required_rubygems_version_met"></a><b>ensure_required_rubygems_version_met</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ensure_required_rubygems_version_met_source')" id="l_method-i-ensure_required_rubygems_version_met_source">show</a>
                
              </p>
              <div id="method-i-ensure_required_rubygems_version_met_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 393</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ensure_required_rubygems_version_met</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">rrgv</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">required_rubygems_version</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">rrgv</span>.<span class="ruby-identifier">satisfied_by?</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">VERSION</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>,
        <span class="ruby-node">&quot;#{spec.name} requires RubyGems version #{rrgv}. &quot;</span> <span class="ruby-operator">+</span>
        <span class="ruby-string">&quot;Try 'gem update --system' to update RubyGems itself.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-extract_files">
            
              <a name="method-i-extract_files"></a><b>extract_files</b>()
            
          </div>
          
          
            <div class="description">
              <p>Reads the file index and extracts each file into the gem directory.</p>

<p>Ensures that files can’t be installed outside the gem directory.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-extract_files_source')" id="l_method-i-extract_files_source">show</a>
                
              </p>
              <div id="method-i-extract_files_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 562</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">extract_files</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;format required to extract from&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-ivar">@format</span>.<span class="ruby-identifier">file_entries</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry</span>, <span class="ruby-identifier">file_data</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-identifier">entry</span>[<span class="ruby-string">'path'</span>].<span class="ruby-identifier">untaint</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">start_with?</span> <span class="ruby-string">&quot;/&quot;</span> <span class="ruby-keyword">then</span> <span class="ruby-comment"># for extra sanity</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-node">&quot;attempt to install file into #{entry['path']}&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">gem_dir</span>, <span class="ruby-identifier">path</span>)

    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">start_with?</span> <span class="ruby-identifier">gem_dir</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">msg</span> = <span class="ruby-string">&quot;attempt to install file into %p under %s&quot;</span> <span class="ruby-operator">%</span>
              [<span class="ruby-identifier">entry</span>[<span class="ruby-string">'path'</span>], <span class="ruby-identifier">gem_dir</span>]
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-identifier">msg</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">path</span>

    <span class="ruby-identifier">dir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span> <span class="ruby-identifier">path</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dir</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">dir</span>

    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&quot;wb&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">out</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">out</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">file_data</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">chmod</span> <span class="ruby-identifier">entry</span>[<span class="ruby-string">'mode'</span>], <span class="ruby-identifier">path</span>

    <span class="ruby-identifier">say</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-format">
            
              <a name="method-i-format"></a><b>format</b>()
            
          </div>
          
          
            <div class="description">
              <p>Lazy accessor for the installer’s <a href="Format.html">Gem::Format</a>
instance.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-format_source')" id="l_method-i-format_source">show</a>
                
              </p>
              <div id="method-i-format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">format</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-ivar">@format</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Format</span>.<span class="ruby-identifier">from_file_by_path</span> <span class="ruby-identifier">gem</span>, <span class="ruby-ivar">@security_policy</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Package</span><span class="ruby-operator">::</span><span class="ruby-constant">FormatError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-node">&quot;invalid gem format for #{gem}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-formatted_program_filename">
            
              <a name="method-i-formatted_program_filename"></a><b>formatted_program_filename</b>(filename)
            
          </div>
          
          
            <div class="description">
              <p>Prefix and suffix the program filename the same as ruby.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-formatted_program_filename_source')" id="l_method-i-formatted_program_filename_source">show</a>
                
              </p>
              <div id="method-i-formatted_program_filename_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 598</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">formatted_program_filename</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@format_executable</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">exec_format</span> <span class="ruby-operator">%</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">filename</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-gem_dir">
            
              <a name="method-i-gem_dir"></a><b>gem_dir</b>()
            
          </div>
          
          
            <div class="description">
              <p>Lazy accessor for the spec’s gem directory.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-gem_dir_source')" id="l_method-i-gem_dir_source">show</a>
                
              </p>
              <div id="method-i-gem_dir_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">gem_dir</span>
  <span class="ruby-ivar">@gem_dir</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">gem_dir</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">untaint</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-generate_bin">
            
              <a name="method-i-generate_bin"></a><b>generate_bin</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-generate_bin_source')" id="l_method-i-generate_bin_source">show</a>
                
              </p>
              <div id="method-i-generate_bin_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 280</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">generate_bin</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">executables</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">executables</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-comment"># If the user has asked for the gem to be installed in a directory that is</span>
  <span class="ruby-comment"># the system gem directory, then use the system bin directory, else create</span>
  <span class="ruby-comment"># (or use) a new bin dir under the gem_home.</span>
  <span class="ruby-identifier">bindir</span> = <span class="ruby-ivar">@bin_dir</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">bindir</span>(<span class="ruby-identifier">gem_home</span>)

  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">mkdir</span> <span class="ruby-identifier">bindir</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">bindir</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">FilePermissionError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">bindir</span>) <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">writable?</span> <span class="ruby-identifier">bindir</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">executables</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">untaint</span>
    <span class="ruby-identifier">bin_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">gem_dir</span>, <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">bindir</span>, <span class="ruby-identifier">filename</span>)

    <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">bin_path</span>
      <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Hey?!?! Where did #{bin_path} go??&quot;</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">mode</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">bin_path</span>).<span class="ruby-identifier">mode</span> <span class="ruby-operator">|</span> <span class="ruby-number">0111</span>
    <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">chmod</span> <span class="ruby-identifier">mode</span>, <span class="ruby-identifier">bin_path</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@wrappers</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">generate_bin_script</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">generate_bin_symlink</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-generate_bin_script">
            
              <a name="method-i-generate_bin_script"></a><b>generate_bin_script</b>(filename, bindir)
            
          </div>
          
          
            <div class="description">
              <p>Creates the scripts to run the applications in the gem.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-generate_bin_script_source')" id="l_method-i-generate_bin_script_source">show</a>
                
              </p>
              <div id="method-i-generate_bin_script_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 318</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">generate_bin_script</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>)
  <span class="ruby-identifier">bin_script_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">bindir</span>, <span class="ruby-identifier">formatted_program_filename</span>(<span class="ruby-identifier">filename</span>)

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_f</span> <span class="ruby-identifier">bin_script_path</span> <span class="ruby-comment"># prior install may have been --no-wrappers</span>

  <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span> <span class="ruby-identifier">bin_script_path</span>, <span class="ruby-string">'wb'</span>, <span class="ruby-number">0755</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">file</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">app_script_text</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">say</span> <span class="ruby-identifier">bin_script_path</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>

  <span class="ruby-identifier">generate_windows_script</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-generate_bin_symlink">
            
              <a name="method-i-generate_bin_symlink"></a><b>generate_bin_symlink</b>(filename, bindir)
            
          </div>
          
          
            <div class="description">
              <p>Creates the symlinks to run the applications in the gem.  Moves the symlink
if the gem being installed has a newer version.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-generate_bin_symlink_source')" id="l_method-i-generate_bin_symlink_source">show</a>
                
              </p>
              <div id="method-i-generate_bin_symlink_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 336</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">generate_bin_symlink</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">win_platform?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">alert_warning</span> <span class="ruby-string">&quot;Unable to use symlinks on Windows, installing wrapper&quot;</span>
    <span class="ruby-identifier">generate_bin_script</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">src</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">gem_dir</span>, <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">bindir</span>, <span class="ruby-identifier">filename</span>
  <span class="ruby-identifier">dst</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">bindir</span>, <span class="ruby-identifier">formatted_program_filename</span>(<span class="ruby-identifier">filename</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">dst</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">symlink?</span> <span class="ruby-identifier">dst</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">link</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">readlink</span>(<span class="ruby-identifier">dst</span>).<span class="ruby-identifier">split</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>
      <span class="ruby-identifier">cur_version</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">link</span>[<span class="ruby-number">-3</span>].<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/^.*-/</span>, <span class="ruby-string">''</span>))
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">version</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">cur_version</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span> <span class="ruby-identifier">dst</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">symlink</span> <span class="ruby-identifier">src</span>, <span class="ruby-identifier">dst</span>, <span class="ruby-value">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-generate_windows_script">
            
              <a name="method-i-generate_windows_script"></a><b>generate_windows_script</b>(filename, bindir)
            
          </div>
          
          
            <div class="description">
              <p>Creates windows .bat files for easy running of commands</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-generate_windows_script_source')" id="l_method-i-generate_windows_script_source">show</a>
                
              </p>
              <div id="method-i-generate_windows_script_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 268</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">generate_windows_script</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">bindir</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">win_platform?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">script_name</span> = <span class="ruby-identifier">filename</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;.bat&quot;</span>
    <span class="ruby-identifier">script_path</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">bindir</span>, <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">script_name</span>)
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span> <span class="ruby-identifier">script_path</span>, <span class="ruby-string">'w'</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">windows_stub_script</span>(<span class="ruby-identifier">bindir</span>, <span class="ruby-identifier">filename</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">say</span> <span class="ruby-identifier">script_path</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">really_verbose</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-install">
            
              <a name="method-i-install"></a><b>install</b>()
            
          </div>
          
          
            <div class="description">
              <p>Installs the gem and returns a loaded <a
href="Specification.html">Gem::Specification</a> for the installed gem.</p>

<p>The gem will be installed with the following structure:</p>

<pre class="ruby"><span class="ruby-ivar">@gem_home</span><span class="ruby-operator">/</span>
  <span class="ruby-identifier">cache</span><span class="ruby-operator">/</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">gem</span><span class="ruby-operator">-</span><span class="ruby-identifier">version</span><span class="ruby-operator">&gt;</span>.<span class="ruby-identifier">gem</span> <span class="ruby-comment">#=&gt; a cached copy of the installed gem</span>
  <span class="ruby-identifier">gems</span><span class="ruby-operator">/</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">gem</span><span class="ruby-operator">-</span><span class="ruby-identifier">version</span><span class="ruby-operator">&gt;</span><span class="ruby-node">/... #=&gt; extracted files
  specifications/</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">gem</span><span class="ruby-operator">-</span><span class="ruby-identifier">version</span><span class="ruby-operator">&gt;</span>.<span class="ruby-identifier">gemspec</span> <span class="ruby-comment">#=&gt; the Gem::Specification</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-install_source')" id="l_method-i-install_source">show</a>
                
              </p>
              <div id="method-i-install_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 143</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">install</span>
  <span class="ruby-identifier">current_home</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">dir</span>
  <span class="ruby-identifier">current_path</span> = <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">paths</span>.<span class="ruby-identifier">path</span>

  <span class="ruby-identifier">verify_gem_home</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:unpack</span>])
  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">use_paths</span> <span class="ruby-identifier">gem_home</span>, <span class="ruby-identifier">current_path</span> <span class="ruby-comment"># HACK: shouldn't need Gem.paths.path</span>

  <span class="ruby-comment"># If we're forcing the install then disable security unless the security</span>
  <span class="ruby-comment"># policy says that we only install signed gems.</span>
  <span class="ruby-ivar">@security_policy</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@force</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@security_policy</span> <span class="ruby-keyword">and</span>
                            <span class="ruby-keyword">not</span> <span class="ruby-ivar">@security_policy</span>.<span class="ruby-identifier">only_signed</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@force</span>
    <span class="ruby-identifier">ensure_required_ruby_version_met</span>
    <span class="ruby-identifier">ensure_required_rubygems_version_met</span>
    <span class="ruby-identifier">ensure_dependencies_met</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@ignore_dependencies</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">pre_install_hooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hook</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">hook</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword">self</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">location</span> = <span class="ruby-node">&quot; at #{$1}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">hook</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/@(.*:\d+)/</span>

      <span class="ruby-identifier">message</span> = <span class="ruby-node">&quot;pre-install hook#{location} failed for #{spec.full_name}&quot;</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-identifier">message</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ensure_gem_subdirectories</span> <span class="ruby-identifier">gem_home</span>

  <span class="ruby-comment"># Completely remove any previous gem files</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span>(<span class="ruby-identifier">gem_dir</span>) <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">gem_dir</span>

  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">gem_dir</span>

  <span class="ruby-identifier">extract_files</span>
  <span class="ruby-identifier">build_extensions</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_build_hooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hook</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">hook</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword">self</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">then</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-identifier">gem_dir</span>

      <span class="ruby-identifier">location</span> = <span class="ruby-node">&quot; at #{$1}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">hook</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/@(.*:\d+)/</span>

      <span class="ruby-identifier">message</span> = <span class="ruby-node">&quot;post-build hook#{location} failed for #{spec.full_name}&quot;</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-identifier">message</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">generate_bin</span>
  <span class="ruby-identifier">write_spec</span>

  <span class="ruby-identifier">write_require_paths_file_if_needed</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">QUICKLOADER_SUCKAGE</span>

  <span class="ruby-identifier">cache_file</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">cache_file</span>
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">cp</span> <span class="ruby-identifier">gem</span>, <span class="ruby-identifier">cache_file</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">cache_file</span>

  <span class="ruby-identifier">say</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">post_install_message</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">post_install_message</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">loaded_from</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>

  <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">add_spec</span> <span class="ruby-identifier">spec</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Specification</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">spec</span>

  <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">post_install_hooks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hook</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">hook</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">spec</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">Zlib</span><span class="ruby-operator">::</span><span class="ruby-constant">GzipFile</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">InstallError</span>, <span class="ruby-node">&quot;gzip error installing #{gem}&quot;</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-comment"># conditional since we might be here because we're erroring out early.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_path</span>
    <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">use_paths</span> <span class="ruby-identifier">current_home</span>, <span class="ruby-identifier">current_path</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-installation_satisfies_dependency-3F">
            
              <a name="method-i-installation_satisfies_dependency-3F"></a><b>installation_satisfies_dependency?</b>(dependency)
            
          </div>
          
          
            <div class="description">
              <p>True if the gems in the source_index satisfy <code>dependency</code>.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-installation_satisfies_dependency-3F_source')" id="l_method-i-installation_satisfies_dependency-3F_source">show</a>
                
              </p>
              <div id="method-i-installation_satisfies_dependency-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">installation_satisfies_dependency?</span>(<span class="ruby-identifier">dependency</span>)
  <span class="ruby-keyword">not</span> <span class="ruby-identifier">dependency</span>.<span class="ruby-identifier">matching_specs</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-process_options">
            
              <a name="method-i-process_options"></a><b>process_options</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-process_options_source')" id="l_method-i-process_options_source">show</a>
                
              </p>
              <div id="method-i-process_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 412</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">process_options</span>
  <span class="ruby-ivar">@options</span> = {
    <span class="ruby-value">:bin_dir</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:env_shebang</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-value">:exec_format</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-value">:force</span>        =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>,
    <span class="ruby-value">:install_dir</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">dir</span>,
  }.<span class="ruby-identifier">merge</span> <span class="ruby-identifier">options</span>

  <span class="ruby-ivar">@env_shebang</span>         = <span class="ruby-identifier">options</span>[<span class="ruby-value">:env_shebang</span>]
  <span class="ruby-ivar">@force</span>               = <span class="ruby-identifier">options</span>[<span class="ruby-value">:force</span>]
  <span class="ruby-ivar">@gem_home</span>            = <span class="ruby-identifier">options</span>[<span class="ruby-value">:install_dir</span>]
  <span class="ruby-ivar">@ignore_dependencies</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:ignore_dependencies</span>]
  <span class="ruby-ivar">@format_executable</span>   = <span class="ruby-identifier">options</span>[<span class="ruby-value">:format_executable</span>]
  <span class="ruby-ivar">@security_policy</span>     = <span class="ruby-identifier">options</span>[<span class="ruby-value">:security_policy</span>]
  <span class="ruby-ivar">@wrappers</span>            = <span class="ruby-identifier">options</span>[<span class="ruby-value">:wrappers</span>]
  <span class="ruby-ivar">@bin_dir</span>             = <span class="ruby-identifier">options</span>[<span class="ruby-value">:bin_dir</span>]
  <span class="ruby-ivar">@development</span>         = <span class="ruby-identifier">options</span>[<span class="ruby-value">:development</span>]

  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;NOTE: Installer option :source_index is dead&quot;</span> <span class="ruby-keyword">if</span>
    <span class="ruby-identifier">options</span>[<span class="ruby-value">:source_index</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-shebang">
            
              <a name="method-i-shebang"></a><b>shebang</b>(bin_file_name)
            
          </div>
          
          
            <div class="description">
              <p>Generates a #! line for <code>bin_file_name</code>‘s wrapper copying
arguments if necessary.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-shebang_source')" id="l_method-i-shebang_source">show</a>
                
              </p>
              <div id="method-i-shebang_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 362</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">shebang</span>(<span class="ruby-identifier">bin_file_name</span>)
  <span class="ruby-identifier">ruby_name</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">ConfigMap</span>[<span class="ruby-value">:ruby_install_name</span>] <span class="ruby-keyword">if</span> <span class="ruby-ivar">@env_shebang</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">bin_file</span> <span class="ruby-identifier">bin_file_name</span>
  <span class="ruby-identifier">first_line</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-string">&quot;rb&quot;</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span> <span class="ruby-identifier">file</span>.<span class="ruby-identifier">gets</span>}

  <span class="ruby-keyword">if</span> <span class="ruby-node">/\A#!/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">first_line</span> <span class="ruby-keyword">then</span>
    <span class="ruby-comment"># Preserve extra words on shebang line, like &quot;-w&quot;.  Thanks RPA.</span>
    <span class="ruby-identifier">shebang</span> = <span class="ruby-identifier">first_line</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\A\#!.*?ruby\S*(?=(\s+\S+))/</span>, <span class="ruby-node">&quot;#!#{Gem.ruby}&quot;</span>)
    <span class="ruby-identifier">opts</span> = <span class="ruby-node">$1</span>
    <span class="ruby-identifier">shebang</span>.<span class="ruby-identifier">strip!</span> <span class="ruby-comment"># Avoid nasty ^M issues.</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">ruby_name</span> <span class="ruby-keyword">then</span>
    <span class="ruby-node">&quot;#!#{Gem.ruby}#{opts}&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">opts</span> <span class="ruby-keyword">then</span>
    <span class="ruby-node">&quot;#!/bin/sh\n'exec' #{ruby_name.dump} '-x' \&quot;$0\&quot; \&quot;$@\&quot;\n#{shebang}&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Create a plain shebang line.</span>
    <span class="ruby-ivar">@env_path</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">ENV_PATHS</span>.<span class="ruby-identifier">find</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">env_path</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span> <span class="ruby-identifier">env_path</span> }
    <span class="ruby-node">&quot;#!#{@env_path} #{ruby_name}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-spec">
            
              <a name="method-i-spec"></a><b>spec</b>()
            
          </div>
          
          
            <div class="description">
              <p>Lazy accessor for the installer’s spec.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-spec_source')" id="l_method-i-spec_source">show</a>
                
              </p>
              <div id="method-i-spec_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 128</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">spec</span>
  <span class="ruby-ivar">@spec</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">format</span>.<span class="ruby-identifier">spec</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-unpack">
            
              <a name="method-i-unpack"></a><b>unpack</b>(directory)
            
          </div>
          
          
            <div class="description">
              <p>Unpacks the gem into the given directory.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-unpack_source')" id="l_method-i-unpack_source">show</a>
                
              </p>
              <div id="method-i-unpack_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 247</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">unpack</span>(<span class="ruby-identifier">directory</span>)
  <span class="ruby-ivar">@gem_dir</span> = <span class="ruby-identifier">directory</span>
  <span class="ruby-ivar">@format</span> = <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">Format</span>.<span class="ruby-identifier">from_file_by_path</span> <span class="ruby-identifier">gem</span>, <span class="ruby-ivar">@security_policy</span>
  <span class="ruby-identifier">extract_files</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-verify_gem_home">
            
              <a name="method-i-verify_gem_home"></a><b>verify_gem_home</b>(unpack = false)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-verify_gem_home_source')" id="l_method-i-verify_gem_home_source">show</a>
                
              </p>
              <div id="method-i-verify_gem_home_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 446</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">verify_gem_home</span>(<span class="ruby-identifier">unpack</span> = <span class="ruby-keyword">false</span>)
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">gem_home</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Gem</span><span class="ruby-operator">::</span><span class="ruby-constant">FilePermissionError</span>, <span class="ruby-identifier">gem_home</span> <span class="ruby-keyword">unless</span>
    <span class="ruby-identifier">unpack</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">writable?</span>(<span class="ruby-identifier">gem_home</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-windows_stub_script">
            
              <a name="method-i-windows_stub_script"></a><b>windows_stub_script</b>(bindir, bin_file_name)
            
          </div>
          
          
            <div class="description">
              <p>return the stub script text used to launch the true ruby script</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-windows_stub_script_source')" id="l_method-i-windows_stub_script_source">show</a>
                
              </p>
              <div id="method-i-windows_stub_script_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 482</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">windows_stub_script</span>(<span class="ruby-identifier">bindir</span>, <span class="ruby-identifier">bin_file_name</span>)
    <span class="ruby-identifier">ruby</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-constant">Gem</span>.<span class="ruby-identifier">ruby</span>).<span class="ruby-identifier">chomp</span>(<span class="ruby-string">'&quot;'</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-string">&quot;@ECHO OFF
IF NOT &quot;%~f0&quot; == &quot;~f0&quot; GOTO :WinNT
@&quot;#{ruby}&quot; &quot;#{File.join(bindir, bin_file_name)}&quot; %1 %2 %3 %4 %5 %6 %7 %8 %9
GOTO :EOF
:WinNT
@&quot;#{ruby}&quot; &quot;%~dpn0&quot; %*
&quot;</span>

  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-write_spec">
            
              <a name="method-i-write_spec"></a><b>write_spec</b>()
            
          </div>
          
          
            <div class="description">
              <p>Writes the .gemspec specification (in Ruby) to the gem home’s
specifications directory.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-write_spec_source')" id="l_method-i-write_spec_source">show</a>
                
              </p>
              <div id="method-i-write_spec_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/rubygems/installer.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">write_spec</span>
  <span class="ruby-identifier">file_name</span> = <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">spec_file</span>.<span class="ruby-identifier">untaint</span>

  <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file_name</span>, <span class="ruby-string">&quot;w&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">file</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">to_ruby_for_cache</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    