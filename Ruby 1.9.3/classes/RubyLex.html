<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>RubyLex</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            RubyLex 
            
                <span class="parent">&lt; 
                    
                    <a href="Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/lib/irb/ruby-lex_rb.html">lib/irb/ruby-lex.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-debug-3F">debug?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-each_top_level_statement">each_top_level_statement</a>,
              </li>
            
              
              <li>
                <a href="#method-i-eof-3F">eof?</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-get_readed">get_readed</a>,
              </li>
            
              
              <li>
                <a href="#method-i-getc">getc</a>,
              </li>
            
              
              <li>
                <a href="#method-i-getc_of_rests">getc_of_rests</a>,
              </li>
            
              
              <li>
                <a href="#method-i-gets">gets</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-identify_comment">identify_comment</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_gvar">identify_gvar</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_here_document">identify_here_document</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_identifier">identify_identifier</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_number">identify_number</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_quotation">identify_quotation</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_string">identify_string</a>,
              </li>
            
              
              <li>
                <a href="#method-i-identify_string_dvar">identify_string_dvar</a>,
              </li>
            
              
              <li>
                <a href="#method-i-initialize_input">initialize_input</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-lex">lex</a>,
              </li>
            
              
              <li>
                <a href="#method-i-lex_init">lex_init</a>,
              </li>
            
              
              <li>
                <a href="#method-i-lex_int2">lex_int2</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-peek">peek</a>,
              </li>
            
              
              <li>
                <a href="#method-i-peek_equal-3F">peek_equal?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-peek_match-3F">peek_match?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-prompt">prompt</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-read_escape">read_escape</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-set_input">set_input</a>,
              </li>
            
              
              <li>
                <a href="#method-i-set_prompt">set_prompt</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-token">token</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ungetc">ungetc</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="RubyToken.html">
              RubyToken
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">ENINDENT_CLAUSE</td>
            <td>=</td>
            <td class="attr-value">[
&quot;case&quot;, &quot;class&quot;, &quot;def&quot;, &quot;do&quot;, &quot;for&quot;, &quot;if&quot;,
&quot;module&quot;, &quot;unless&quot;, &quot;until&quot;, &quot;while&quot;, &quot;begin&quot; #, &quot;when&quot;
]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">DEINDENT_CLAUSE</td>
            <td>=</td>
            <td class="attr-value">[&quot;end&quot; #, &quot;when&quot;
]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">PERCENT_LTYPE</td>
            <td>=</td>
            <td class="attr-value">{
&quot;q&quot; =&gt; &quot;\'&quot;,
&quot;Q&quot; =&gt; &quot;\&quot;&quot;,
&quot;x&quot; =&gt; &quot;\`&quot;,
&quot;r&quot; =&gt; &quot;/&quot;,
&quot;w&quot; =&gt; &quot;]&quot;,
&quot;W&quot; =&gt; &quot;]&quot;,
&quot;s&quot; =&gt; &quot;:&quot;
}</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">PERCENT_PAREN</td>
            <td>=</td>
            <td class="attr-value">{
&quot;{&quot; =&gt; &quot;}&quot;,
&quot;[&quot; =&gt; &quot;]&quot;,
&quot;&lt;&quot; =&gt; &quot;&gt;&quot;,
&quot;(&quot; =&gt; &quot;)&quot;
}</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">Ltype2Token</td>
            <td>=</td>
            <td class="attr-value">{
&quot;\'&quot; =&gt; TkSTRING,
&quot;\&quot;&quot; =&gt; TkSTRING,
&quot;\`&quot; =&gt; TkXSTRING,
&quot;/&quot; =&gt; TkREGEXP,
&quot;]&quot; =&gt; TkDSTRING,
&quot;:&quot; =&gt; TkSYMBOL
}</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">DLtype2Token</td>
            <td>=</td>
            <td class="attr-value">{
&quot;\&quot;&quot; =&gt; TkDSTRING,
&quot;\`&quot; =&gt; TkDXSTRING,
&quot;/&quot; =&gt; TkDREGEXP,
}</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>debug_level</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>char_no</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>exception_on_syntax_error</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>indent</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>line_no</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>readed_auto_clean_up</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>seek</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>skip_space</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-debug-3F">
            
              <a name="method-c-debug-3F"></a><b>debug?</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-debug-3F_source')" id="l_method-c-debug-3F_source">show</a>
                
              </p>
              <div id="method-c-debug-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">debug?</span>
  <span class="ruby-ivar">@debug_level</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 39</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>
  <span class="ruby-identifier">lex_init</span>
  <span class="ruby-identifier">set_input</span>(<span class="ruby-constant">STDIN</span>)

  <span class="ruby-ivar">@seek</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@exp_line_no</span> = <span class="ruby-ivar">@line_no</span> = <span class="ruby-number">1</span>
  <span class="ruby-ivar">@base_char_no</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@char_no</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@rests</span> = []
  <span class="ruby-ivar">@readed</span> = []
  <span class="ruby-ivar">@here_readed</span> = []

  <span class="ruby-ivar">@indent</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@indent_stack</span> = []
  <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
  <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@line</span> = <span class="ruby-string">&quot;&quot;</span>

  <span class="ruby-ivar">@skip_space</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@readed_auto_clean_up</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@exception_on_syntax_error</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-ivar">@prompt</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-each_top_level_statement">
            
              <a name="method-i-each_top_level_statement"></a><b>each_top_level_statement</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-each_top_level_statement_source')" id="l_method-i-each_top_level_statement_source">show</a>
                
              </p>
              <div id="method-i-each_top_level_statement_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 226</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">each_top_level_statement</span>
  <span class="ruby-identifier">initialize_input</span>
  <span class="ruby-identifier">catch</span>(<span class="ruby-value">:TERM_INPUT</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-identifier">prompt</span>
        <span class="ruby-keyword">unless</span> <span class="ruby-identifier">l</span> = <span class="ruby-identifier">lex</span>
          <span class="ruby-identifier">throw</span> <span class="ruby-value">:TERM_INPUT</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@line</span> <span class="ruby-operator">==</span> <span class="ruby-string">''</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@line</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">l</span>
          <span class="ruby-keyword">if</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-keyword">or</span> <span class="ruby-ivar">@continue</span> <span class="ruby-keyword">or</span> <span class="ruby-ivar">@indent</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
            <span class="ruby-keyword">next</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@line</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;\n&quot;</span>
          <span class="ruby-ivar">@line</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@io</span>.<span class="ruby-identifier">encoding</span>)
          <span class="ruby-keyword">yield</span> <span class="ruby-ivar">@line</span>, <span class="ruby-ivar">@exp_line_no</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">break</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">l</span>
        <span class="ruby-ivar">@line</span> = <span class="ruby-string">''</span>
        <span class="ruby-ivar">@exp_line_no</span> = <span class="ruby-ivar">@line_no</span>

        <span class="ruby-ivar">@indent</span> = <span class="ruby-number">0</span>
        <span class="ruby-ivar">@indent_stack</span> = []
        <span class="ruby-identifier">prompt</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">TerminateLineInput</span>
        <span class="ruby-identifier">initialize_input</span>
        <span class="ruby-identifier">prompt</span>
        <span class="ruby-identifier">get_readed</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-eof-3F">
            
              <a name="method-i-eof-3F"></a><b>eof?</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-eof-3F_source')" id="l_method-i-eof-3F_source">show</a>
                
              </p>
              <div id="method-i-eof-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">eof?</span>
  <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">eof?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-get_readed">
            
              <a name="method-i-get_readed"></a><b>get_readed</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-get_readed_source')" id="l_method-i-get_readed_source">show</a>
                
              </p>
              <div id="method-i-get_readed_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 88</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">get_readed</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">index</span>(<span class="ruby-string">&quot;\n&quot;</span>)
    <span class="ruby-ivar">@base_char_no</span> = <span class="ruby-identifier">idx</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@base_char_no</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">readed</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-ivar">@readed</span> = []
  <span class="ruby-identifier">readed</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-getc">
            
              <a name="method-i-getc"></a><b>getc</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-getc_source')" id="l_method-i-getc_source">show</a>
                
              </p>
              <div id="method-i-getc_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 100</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">getc</span>
    <span class="ruby-keyword">while</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-comment">#      return nil unless buf_input</span>
      <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">push</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">buf_input</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@here_header</span>
      <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">c</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">c</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@seek</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>
      <span class="ruby-ivar">@line_no</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
      <span class="ruby-ivar">@char_no</span> = <span class="ruby-number">0</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@char_no</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">c</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-getc_of_rests">
            
              <a name="method-i-getc_of_rests"></a><b>getc_of_rests</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-getc_of_rests_source')" id="l_method-i-getc_of_rests_source">show</a>
                
              </p>
              <div id="method-i-getc_of_rests_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">getc_of_rests</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">getc</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-gets">
            
              <a name="method-i-gets"></a><b>gets</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-gets_source')" id="l_method-i-gets_source">show</a>
                
              </p>
              <div id="method-i-gets_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">gets</span>
  <span class="ruby-identifier">l</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">while</span> <span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>
    <span class="ruby-identifier">l</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">l</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">l</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_comment">
            
              <a name="method-i-identify_comment"></a><b>identify_comment</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_comment_source')" id="l_method-i-identify_comment_source">show</a>
                
              </p>
              <div id="method-i-identify_comment_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 1123</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_comment</span>
    <span class="ruby-ivar">@ltype</span> = <span class="ruby-node">&quot;#&quot;</span>

    <span class="ruby-keyword">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
<span class="ruby-comment">#      if ch == &quot;\\&quot; #&quot;</span>
<span class="ruby-comment">#       read_escape</span>
<span class="ruby-comment">#      end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>
        <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOMMENT</span>)
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_gvar">
            
              <a name="method-i-identify_gvar"></a><b>identify_gvar</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_gvar_source')" id="l_method-i-identify_gvar_source">show</a>
                
              </p>
              <div id="method-i-identify_gvar_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 740</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_gvar</span>
  <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[~_*$?!@\/\\;,=:&lt;&gt;&quot;.]/</span>   <span class="ruby-comment">#&quot;</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkGVAR</span>, <span class="ruby-string">&quot;$&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ch</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;-&quot;</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkGVAR</span>, <span class="ruby-string">&quot;$-&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">getc</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;&amp;&quot;</span>, <span class="ruby-string">&quot;`&quot;</span>, <span class="ruby-string">&quot;'&quot;</span>, <span class="ruby-string">&quot;+&quot;</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkBACK_REF</span>, <span class="ruby-string">&quot;$&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">ch</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[1-9]/</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[0-9]/</span>; <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">ungetc</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkNTH_REF</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\w/</span>
    <span class="ruby-identifier">ungetc</span>
    <span class="ruby-identifier">ungetc</span>
    <span class="ruby-identifier">identify_identifier</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ungetc</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;$&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_here_document">
            
              <a name="method-i-identify_here_document"></a><b>identify_here_document</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_here_document_source')" id="l_method-i-identify_here_document_source">show</a>
                
              </p>
              <div id="method-i-identify_here_document_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 873</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_here_document</span>
    <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
<span class="ruby-comment">#    if lt = PERCENT_LTYPE[ch]</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;-&quot;</span>
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-identifier">indent</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-regexp">/['&quot;`]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">ch</span>
      <span class="ruby-identifier">lt</span> = <span class="ruby-identifier">ch</span>
      <span class="ruby-identifier">quoted</span> = <span class="ruby-string">&quot;&quot;</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">lt</span>
        <span class="ruby-identifier">quoted</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">c</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">lt</span> = <span class="ruby-string">'&quot;'</span>
      <span class="ruby-identifier">quoted</span> = <span class="ruby-identifier">ch</span>.<span class="ruby-identifier">dup</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\w/</span>
        <span class="ruby-identifier">quoted</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">c</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">ungetc</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">ltback</span>, <span class="ruby-ivar">@ltype</span> = <span class="ruby-ivar">@ltype</span>, <span class="ruby-identifier">lt</span>
    <span class="ruby-identifier">reserve</span> = []
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-identifier">reserve</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">ch</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\\&quot;</span>
        <span class="ruby-identifier">reserve</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">l</span> = <span class="ruby-identifier">gets</span>
      <span class="ruby-identifier">l</span> = <span class="ruby-identifier">l</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/(:?\r)?\n\z/</span>, <span class="ruby-string">''</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">indent</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">l</span>.<span class="ruby-identifier">strip</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">l</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">quoted</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">reserve</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">reserve</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-identifier">ungetc</span> <span class="ruby-identifier">ch</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@ltype</span> = <span class="ruby-identifier">ltback</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">Ltype2Token</span>[<span class="ruby-identifier">lt</span>])
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_identifier">
            
              <a name="method-i-identify_identifier"></a><b>identify_identifier</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_identifier_source')" id="l_method-i-identify_identifier_source">show</a>
                
              </p>
              <div id="method-i-identify_identifier_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 764</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_identifier</span>
    <span class="ruby-identifier">token</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[$@]/</span>
      <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">c</span> = <span class="ruby-identifier">getc</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;@&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&quot;@&quot;</span>
        <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[^\x00-\/:-@\[-^`{-\x7F]/</span>
      <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;:&quot;</span>, <span class="ruby-identifier">ch</span>, <span class="ruby-string">&quot;:&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
      <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">ch</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">ungetc</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;!&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;?&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">token</span>[<span class="ruby-number">0</span>,<span class="ruby-number">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\w/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;=&quot;</span>
      <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">getc</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># almost fix token</span>

    <span class="ruby-keyword">case</span> <span class="ruby-identifier">token</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^\$/</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkGVAR</span>, <span class="ruby-identifier">token</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^\@\@/</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
      <span class="ruby-comment"># p Token(TkCVAR, token)</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCVAR</span>, <span class="ruby-identifier">token</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^\@/</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkIVAR</span>, <span class="ruby-identifier">token</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_DOT</span>
      <span class="ruby-identifier">print</span> <span class="ruby-identifier">token</span>, <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>

      <span class="ruby-identifier">token_c</span>, *<span class="ruby-identifier">trans</span> = <span class="ruby-constant">TkReading2Token</span>[<span class="ruby-identifier">token</span>]
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">token_c</span>
        <span class="ruby-comment"># reserved word?</span>

        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_FNAME</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-identifier">trans</span>[<span class="ruby-number">1</span>])
          <span class="ruby-comment"># modifiers</span>
          <span class="ruby-identifier">token_c</span> = <span class="ruby-constant">TkSymbol2Token</span>[<span class="ruby-identifier">trans</span>[<span class="ruby-number">1</span>]]
          <span class="ruby-ivar">@lex_state</span> = <span class="ruby-identifier">trans</span>[<span class="ruby-number">0</span>]
        <span class="ruby-keyword">else</span>
          <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_FNAME</span>
            <span class="ruby-keyword">if</span> <span class="ruby-constant">ENINDENT_CLAUSE</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">token</span>)
              <span class="ruby-comment"># check for ``class = val'' etc.</span>
              <span class="ruby-identifier">valid</span> = <span class="ruby-keyword">true</span>
              <span class="ruby-keyword">case</span> <span class="ruby-identifier">token</span>
              <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;class&quot;</span>
                <span class="ruby-identifier">valid</span> = <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp">/^\s*(&lt;&lt;|\w|::)/</span>)
              <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;def&quot;</span>
                <span class="ruby-identifier">valid</span> = <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp">/^\s*(([+\-\/*&amp;\|^]|&lt;&lt;|&gt;&gt;|\|\||\&amp;\&amp;)=|\&amp;\&amp;|\|\|)/</span>)
              <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;do&quot;</span>
                <span class="ruby-identifier">valid</span> = <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp">/^\s*([+\-\/*]?=|\*|&lt;|&gt;|\&amp;)/</span>)
              <span class="ruby-keyword">when</span> *<span class="ruby-constant">ENINDENT_CLAUSE</span>
                <span class="ruby-identifier">valid</span> = <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek_match?</span>(<span class="ruby-regexp">/^\s*([+\-\/*]?=|\*|&lt;|&gt;|\&amp;|\|)/</span>)
              <span class="ruby-keyword">else</span>
                <span class="ruby-comment"># no nothing</span>
              <span class="ruby-keyword">end</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">valid</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">token</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;do&quot;</span>
                  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">TkFOR</span>, <span class="ruby-constant">TkWHILE</span>, <span class="ruby-constant">TkUNTIL</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>)
                    <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
                    <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">token_c</span>
                  <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
                  <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">token_c</span>
                <span class="ruby-keyword">end</span>
<span class="ruby-comment">#               p @indent_stack</span>
              <span class="ruby-keyword">end</span>

            <span class="ruby-keyword">elsif</span> <span class="ruby-constant">DEINDENT_CLAUSE</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">token</span>)
              <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-number">1</span>
              <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
            <span class="ruby-keyword">end</span>
            <span class="ruby-ivar">@lex_state</span> = <span class="ruby-identifier">trans</span>[<span class="ruby-number">0</span>]
          <span class="ruby-keyword">else</span>
            <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-identifier">token_c</span>, <span class="ruby-identifier">token</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">==</span> <span class="ruby-string">'='</span>
        <span class="ruby-identifier">token</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_DOT</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">token</span>[<span class="ruby-number">0</span>, <span class="ruby-number">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[A-Z]/</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCONSTANT</span>, <span class="ruby-identifier">token</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">token</span>[<span class="ruby-identifier">token</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-number">1</span>, <span class="ruby-number">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[!?]/</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkFID</span>, <span class="ruby-identifier">token</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkIDENTIFIER</span>, <span class="ruby-identifier">token</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_number">
            
              <a name="method-i-identify_number"></a><b>identify_number</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_number_source')" id="l_method-i-identify_number_source">show</a>
                
              </p>
              <div id="method-i-identify_number_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 943</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_number</span>
  <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&quot;0&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">1</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp">/[.eE]/</span>
    <span class="ruby-identifier">getc</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[xX]/</span>
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-identifier">match</span> = <span class="ruby-regexp">/[0-9a-fA-F_]/</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[bB]/</span>
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-identifier">match</span> = <span class="ruby-regexp">/[01_]/</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[oO]/</span>
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-identifier">match</span> = <span class="ruby-regexp">/[0-7_]/</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[dD]/</span>
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-identifier">match</span> = <span class="ruby-regexp">/[0-9_]/</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[0-7]/</span>
      <span class="ruby-identifier">match</span> = <span class="ruby-regexp">/[0-7_]/</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[89]/</span>
      <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-string">&quot;Invalid octal digit&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkINTEGER</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">len0</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">match</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">ch</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;_&quot;</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">non_digit</span>
            <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{ch}' in number&quot;</span>
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">non_digit</span> = <span class="ruby-identifier">ch</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword">false</span>
          <span class="ruby-identifier">len0</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">len0</span>
          <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-string">&quot;numeric literal without digits&quot;</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">non_digit</span>
          <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkINTEGER</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkINTEGER</span>
  <span class="ruby-identifier">allow_point</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">allow_e</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">ch</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[0-9]/</span>
      <span class="ruby-identifier">non_digit</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;_&quot;</span>
      <span class="ruby-identifier">non_digit</span> = <span class="ruby-identifier">ch</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">allow_point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-string">&quot;.&quot;</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">non_digit</span>
        <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkFLOAT</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp">/[0-9]/</span>
        <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkINTEGER</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">allow_point</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">allow_e</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-string">&quot;e&quot;</span>, <span class="ruby-identifier">allow_e</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-string">&quot;E&quot;</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">non_digit</span>
        <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">type</span> = <span class="ruby-constant">TkFLOAT</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[+-]/</span>
        <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">allow_e</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">allow_point</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">non_digit</span> = <span class="ruby-identifier">ch</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">non_digit</span>
        <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-node">&quot;trailing `#{non_digit}' in number&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">ungetc</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Token</span>(<span class="ruby-identifier">type</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_quotation">
            
              <a name="method-i-identify_quotation"></a><b>identify_quotation</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_quotation_source')" id="l_method-i-identify_quotation_source">show</a>
                
              </p>
              <div id="method-i-identify_quotation_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 925</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_quotation</span>
    <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">lt</span> = <span class="ruby-constant">PERCENT_LTYPE</span>[<span class="ruby-identifier">ch</span>]
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\W/</span>
      <span class="ruby-identifier">lt</span> = <span class="ruby-string">&quot;\&quot;&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">fail</span> <span class="ruby-constant">SyntaxError</span>, <span class="ruby-string">&quot;unknown type of %string&quot;</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-comment">#     if ch !~ /\W/</span>
<span class="ruby-comment">#       ungetc</span>
<span class="ruby-comment">#       next</span>
<span class="ruby-comment">#     end</span>
    <span class="ruby-comment">#@ltype = lt</span>
    <span class="ruby-ivar">@quoted</span> = <span class="ruby-identifier">ch</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@quoted</span> = <span class="ruby-constant">PERCENT_PAREN</span>[<span class="ruby-identifier">ch</span>]
    <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">lt</span>, <span class="ruby-ivar">@quoted</span>)
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_string">
            
              <a name="method-i-identify_string"></a><b>identify_string</b>(ltype, quoted = ltype)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_string_source')" id="l_method-i-identify_string_source">show</a>
                
              </p>
              <div id="method-i-identify_string_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 1040</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_string</span>(<span class="ruby-identifier">ltype</span>, <span class="ruby-identifier">quoted</span> = <span class="ruby-identifier">ltype</span>)
  <span class="ruby-ivar">@ltype</span> = <span class="ruby-identifier">ltype</span>
  <span class="ruby-ivar">@quoted</span> = <span class="ruby-identifier">quoted</span>
  <span class="ruby-identifier">subtype</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">nest</span> = <span class="ruby-number">0</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@quoted</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">ch</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">nest</span> <span class="ruby-operator">==</span> <span class="ruby-number">0</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;'&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-node">&quot;#&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&quot;{&quot;</span>
        <span class="ruby-identifier">identify_string_dvar</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;'&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;]&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;:&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-node">&quot;#&quot;</span>
        <span class="ruby-identifier">subtype</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">'\'</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;'&quot;</span> <span class="ruby-comment">#'</span>
        <span class="ruby-keyword">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
        <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\\&quot;</span>, <span class="ruby-string">&quot;\n&quot;</span>, <span class="ruby-string">&quot;'&quot;</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">ungetc</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">'\'</span> <span class="ruby-comment">#'</span>
        <span class="ruby-identifier">read_escape</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-constant">PERCENT_PAREN</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@quoted</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-constant">PERCENT_PAREN</span>[<span class="ruby-identifier">ch</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@quoted</span>
          <span class="ruby-identifier">nest</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@quoted</span>
          <span class="ruby-identifier">nest</span> <span class="ruby-operator">-=</span> <span class="ruby-number">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;/&quot;</span>
      <span class="ruby-keyword">while</span> <span class="ruby-regexp">/[imxoesun]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>)
        <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">subtype</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-constant">DLtype2Token</span>[<span class="ruby-identifier">ltype</span>])
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-constant">Ltype2Token</span>[<span class="ruby-identifier">ltype</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@quoted</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identify_string_dvar">
            
              <a name="method-i-identify_string_dvar"></a><b>identify_string_dvar</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identify_string_dvar_source')" id="l_method-i-identify_string_dvar_source">show</a>
                
              </p>
              <div id="method-i-identify_string_dvar_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 1087</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identify_string_dvar</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">getc</span>

    <span class="ruby-identifier">reserve_continue</span> = <span class="ruby-ivar">@continue</span>
    <span class="ruby-identifier">reserve_ltype</span> = <span class="ruby-ivar">@ltype</span>
    <span class="ruby-identifier">reserve_indent</span> = <span class="ruby-ivar">@indent</span>
    <span class="ruby-identifier">reserve_indent_stack</span> = <span class="ruby-ivar">@indent_stack</span>
    <span class="ruby-identifier">reserve_state</span> = <span class="ruby-ivar">@lex_state</span>
    <span class="ruby-identifier">reserve_quoted</span> = <span class="ruby-ivar">@quoted</span>

    <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@quoted</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@indent</span> = <span class="ruby-number">0</span>
    <span class="ruby-ivar">@indent_stack</span> = []
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>

    <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
      <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">prompt</span>
      <span class="ruby-identifier">tk</span> = <span class="ruby-identifier">token</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@ltype</span> <span class="ruby-keyword">or</span> <span class="ruby-ivar">@continue</span> <span class="ruby-keyword">or</span> <span class="ruby-ivar">@indent</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkRBRACE</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-ivar">@continue</span> = <span class="ruby-identifier">reserve_continue</span>
    <span class="ruby-ivar">@ltype</span> = <span class="ruby-identifier">reserve_ltype</span>
    <span class="ruby-ivar">@indent</span> = <span class="ruby-identifier">reserve_indent</span>
    <span class="ruby-ivar">@indent_stack</span> = <span class="ruby-identifier">reserve_indent_stack</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-identifier">reserve_state</span>
    <span class="ruby-ivar">@quoted</span> = <span class="ruby-identifier">reserve_quoted</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-initialize_input">
            
              <a name="method-i-initialize_input"></a><b>initialize_input</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-initialize_input_source')" id="l_method-i-initialize_input_source">show</a>
                
              </p>
              <div id="method-i-initialize_input_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 210</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize_input</span>
  <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@quoted</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@indent</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@indent_stack</span> = []
  <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
  <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">prompt</span>

  <span class="ruby-ivar">@line</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-ivar">@exp_line_no</span> = <span class="ruby-ivar">@line_no</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lex">
            
              <a name="method-i-lex"></a><b>lex</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lex_source')" id="l_method-i-lex_source">show</a>
                
              </p>
              <div id="method-i-lex_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 261</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">lex</span>
  <span class="ruby-keyword">until</span> (((<span class="ruby-identifier">tk</span> = <span class="ruby-identifier">token</span>).<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkNL</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkEND_OF_SCRIPT</span>)) <span class="ruby-operator">&amp;&amp;</span>
           <span class="ruby-operator">!</span><span class="ruby-ivar">@continue</span> <span class="ruby-keyword">or</span>
           <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-comment">#p tk</span>
    <span class="ruby-comment">#p @lex_state</span>
    <span class="ruby-comment">#p self</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">line</span> = <span class="ruby-identifier">get_readed</span>
  <span class="ruby-comment">#      print self.inspect</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkEND_OF_SCRIPT</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">line</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lex_init">
            
              <a name="method-i-lex_init"></a><b>lex_init</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lex_init_source')" id="l_method-i-lex_init_source">show</a>
                
              </p>
              <div id="method-i-lex_init_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 338</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">lex_init</span>()
  <span class="ruby-ivar">@OP</span> = <span class="ruby-constant">IRB</span><span class="ruby-operator">::</span><span class="ruby-constant">SLex</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;\00&quot;&quot;</span>, <span class="ruby-string">&quot;\0004&quot;</span>, <span class="ruby-string">&quot;\0032&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkEND_OF_SCRIPT</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot; &quot;</span>, <span class="ruby-string">&quot;\t&quot;</span>, <span class="ruby-string">&quot;\f&quot;</span>, <span class="ruby-string">&quot;\r&quot;</span>, <span class="ruby-string">&quot;\113&quot;&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[ \t\f\r\113]]/</span>; <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">ungetc</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSPACE</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-node">&quot;#&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">identify_comment</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;=begin&quot;</span>,
               <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@prev_char_no</span> <span class="ruby-operator">==</span> <span class="ruby-number">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\s/</span>}) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@ltype</span> = <span class="ruby-string">&quot;=&quot;</span>
    <span class="ruby-keyword">until</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>; <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">until</span> <span class="ruby-identifier">peek_equal?</span>(<span class="ruby-string">&quot;=end&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">4</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\s/</span>
      <span class="ruby-keyword">until</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>; <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">gets</span>
    <span class="ruby-ivar">@ltype</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkRD_COMMENT</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;\n&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;\\n\n&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
    <span class="ruby-keyword">case</span> <span class="ruby-ivar">@lex_state</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">EXPR_BEG</span>, <span class="ruby-constant">EXPR_FNAME</span>, <span class="ruby-constant">EXPR_DOT</span>
      <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-keyword">until</span> (<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span>
             [<span class="ruby-constant">TkLPAREN</span>, <span class="ruby-constant">TkLBRACK</span>, <span class="ruby-constant">TkLBRACE</span>,
               <span class="ruby-constant">TkfLPAREN</span>, <span class="ruby-constant">TkfLBRACK</span>, <span class="ruby-constant">TkfLBRACE</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>))
        <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@here_header</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-ivar">@here_readed</span> = []
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkNL</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;*&quot;</span>, <span class="ruby-string">&quot;**&quot;</span>,
                <span class="ruby-string">&quot;=&quot;</span>, <span class="ruby-string">&quot;==&quot;</span>, <span class="ruby-string">&quot;===&quot;</span>,
                <span class="ruby-string">&quot;=~&quot;</span>, <span class="ruby-string">&quot;&lt;=&gt;&quot;</span>,
                <span class="ruby-string">&quot;&lt;&quot;</span>, <span class="ruby-string">&quot;&lt;=&quot;</span>,
                <span class="ruby-string">&quot;&gt;&quot;</span>, <span class="ruby-string">&quot;&gt;=&quot;</span>, <span class="ruby-string">&quot;&gt;&gt;&quot;</span>,
                <span class="ruby-string">&quot;!&quot;</span>, <span class="ruby-string">&quot;!=&quot;</span>, <span class="ruby-string">&quot;!~&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span> <span class="ruby-ivar">@lex_state</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">EXPR_FNAME</span>, <span class="ruby-constant">EXPR_DOT</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;&lt;&lt;&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">tk</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_CLASS</span> <span class="ruby-operator">&amp;&amp;</span>
        (<span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@space_seen</span>)
      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-regexp">/\S/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-regexp">/[&quot;'`]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">||</span> <span class="ruby-regexp">/\w/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;-&quot;</span>)
        <span class="ruby-identifier">tk</span> = <span class="ruby-identifier">identify_here_document</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">tk</span>
      <span class="ruby-identifier">tk</span> = <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
      <span class="ruby-keyword">case</span> <span class="ruby-ivar">@lex_state</span>
      <span class="ruby-keyword">when</span> <span class="ruby-constant">EXPR_FNAME</span>, <span class="ruby-constant">EXPR_DOT</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">tk</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;'&quot;</span>, <span class="ruby-string">'&quot;'</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;`&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">'?'</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_END</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkQUESTION</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\s/</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>;
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkQUESTION</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">'\'</span>)
          <span class="ruby-identifier">read_escape</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkINTEGER</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;&amp;&quot;</span>, <span class="ruby-string">&quot;&amp;&amp;&quot;</span>, <span class="ruby-string">&quot;|&quot;</span>, <span class="ruby-string">&quot;||&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;+=&quot;</span>, <span class="ruby-string">&quot;-=&quot;</span>, <span class="ruby-string">&quot;*=&quot;</span>, <span class="ruby-string">&quot;**=&quot;</span>,
                <span class="ruby-string">&quot;&amp;=&quot;</span>, <span class="ruby-string">&quot;|=&quot;</span>, <span class="ruby-string">&quot;^=&quot;</span>, <span class="ruby-string">&quot;&lt;&lt;=&quot;</span>, <span class="ruby-string">&quot;&gt;&gt;=&quot;</span>, <span class="ruby-string">&quot;||=&quot;</span>, <span class="ruby-string">&quot;&amp;&amp;=&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
    <span class="ruby-identifier">op</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^(.*)=$/</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-node">$1</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;+@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;-@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;+&quot;</span>, <span class="ruby-string">&quot;-&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">catch</span>(<span class="ruby-value">:RET</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span>
        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[0-9]/</span>
          <span class="ruby-identifier">throw</span> <span class="ruby-value">:RET</span>, <span class="ruby-identifier">identify_number</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[0-9]/</span>
        <span class="ruby-identifier">throw</span> <span class="ruby-value">:RET</span>, <span class="ruby-identifier">identify_number</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;.&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[0-9]/</span>
      <span class="ruby-identifier">ungetc</span>
      <span class="ruby-identifier">identify_number</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># for &quot;obj.if&quot; etc.</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_DOT</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkDOT</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;..&quot;</span>, <span class="ruby-string">&quot;...&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
    <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">lex_int2</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-lex_int2">
            
              <a name="method-i-lex_int2"></a><b>lex_int2</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-lex_int2_source')" id="l_method-i-lex_int2_source">show</a>
                
              </p>
              <div id="method-i-lex_int2_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 527</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">lex_int2</span>
    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;]&quot;</span>, <span class="ruby-string">&quot;}&quot;</span>, <span class="ruby-string">&quot;)&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_END</span>
      <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-number">1</span>
      <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;:&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\s/</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_FNAME</span>;
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSYMBEG</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;::&quot;</span>) <span class="ruby-keyword">do</span>
       <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
<span class="ruby-comment">#      p @lex_state.id2name, @space_seen</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-keyword">or</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@space_seen</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON3</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_DOT</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkCOLON2</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;/&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
        <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">==</span> <span class="ruby-string">'='</span>
        <span class="ruby-identifier">getc</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-string">&quot;/&quot;</span>) <span class="ruby-comment">#/)</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp">/\s/</span>
        <span class="ruby-identifier">identify_string</span>(<span class="ruby-identifier">op</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;/&quot;</span>) <span class="ruby-comment">#/)</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;^&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;^&quot;</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment">#       @OP.def_rules(&quot;^=&quot;) do</span>
    <span class="ruby-comment">#   @lex_state = EXPR_BEG</span>
    <span class="ruby-comment">#   Token(OP_ASGN, :^)</span>
    <span class="ruby-comment">#       end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;,&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rules</span>(<span class="ruby-string">&quot;;&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-keyword">until</span> (<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span>
             [<span class="ruby-constant">TkLPAREN</span>, <span class="ruby-constant">TkLBRACK</span>, <span class="ruby-constant">TkLBRACE</span>,
               <span class="ruby-constant">TkfLPAREN</span>, <span class="ruby-constant">TkfLBRACK</span>, <span class="ruby-constant">TkfLBRACE</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">last</span>))
        <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">op</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;~&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;~&quot;</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;~@&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;~&quot;</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;(&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLPAREN</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLPAREN</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;[]&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;[]&quot;</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;[]=&quot;</span>, <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>}) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_ARG</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;[]=&quot;</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;[&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_FNAME</span>
        <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACK</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
          <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACK</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@space_seen</span>
          <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACK</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACK</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;{&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-number">1</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_END</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">EXPR_ARG</span>
        <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkLBRACE</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">tk_c</span> = <span class="ruby-constant">TkfLBRACE</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
      <span class="ruby-ivar">@indent_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">tk_c</span>
      <span class="ruby-constant">Token</span>(<span class="ruby-identifier">tk_c</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">'\'</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">getc</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>
        <span class="ruby-ivar">@space_seen</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-ivar">@continue</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkSPACE</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">read_escape</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;\\&quot;</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">'%'</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_BEG</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_MID</span>
        <span class="ruby-identifier">identify_quotation</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">==</span> <span class="ruby-string">'='</span>
        <span class="ruby-identifier">getc</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-constant">TkOPASGN</span>, <span class="ruby-value">:%</span>)
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@lex_state</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EXPR_ARG</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@space_seen</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">!~</span> <span class="ruby-regexp">/\s/</span>
        <span class="ruby-identifier">identify_quotation</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@lex_state</span> = <span class="ruby-constant">EXPR_BEG</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;%&quot;</span>) <span class="ruby-comment">#))</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">'$'</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">identify_gvar</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">'@'</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[\w@]/</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-identifier">identify_identifier</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-constant">Token</span>(<span class="ruby-string">&quot;@&quot;</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment">#       @OP.def_rule(&quot;def&quot;, proc{|op, io| /\s/ =~ io.peek(0)}) do</span>
    <span class="ruby-comment">#   |op, io|</span>
    <span class="ruby-comment">#   @indent += 1</span>
    <span class="ruby-comment">#   @lex_state = EXPR_FNAME</span>
    <span class="ruby-comment"># # @lex_state = EXPR_END</span>
    <span class="ruby-comment"># # until @rests[0] == &quot;\n&quot; or @rests[0] == &quot;;&quot;</span>
    <span class="ruby-comment"># #   rests.shift</span>
    <span class="ruby-comment"># # end</span>
    <span class="ruby-comment">#       end</span>

    <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">def_rule</span>(<span class="ruby-string">&quot;&quot;</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-operator">|</span><span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;MATCH: start %s: %s\n&quot;</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[0-9]/</span>
        <span class="ruby-identifier">t</span> = <span class="ruby-identifier">identify_number</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">peek</span>(<span class="ruby-number">0</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">/[^\x00-\/:-@\[-^`{-\x7F]/</span>
        <span class="ruby-identifier">t</span> = <span class="ruby-identifier">identify_identifier</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;MATCH: end %s: %s\n&quot;</span>, <span class="ruby-identifier">op</span>, <span class="ruby-identifier">io</span>.<span class="ruby-identifier">inspect</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
      <span class="ruby-identifier">t</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">p</span> <span class="ruby-ivar">@OP</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RubyLex</span>.<span class="ruby-identifier">debug?</span>
  <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-peek">
            
              <a name="method-i-peek"></a><b>peek</b>(i = 0)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-peek_source')" id="l_method-i-peek_source">show</a>
                
              </p>
              <div id="method-i-peek_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">peek</span>(<span class="ruby-identifier">i</span> = <span class="ruby-number">0</span>)
  <span class="ruby-keyword">while</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">i</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">buf_input</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rests</span>[<span class="ruby-identifier">i</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-peek_equal-3F">
            
              <a name="method-i-peek_equal-3F"></a><b>peek_equal?</b>(str)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-peek_equal-3F_source')" id="l_method-i-peek_equal-3F_source">show</a>
                
              </p>
              <div id="method-i-peek_equal-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 164</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">peek_equal?</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-identifier">chrs</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">//</span>)
  <span class="ruby-keyword">until</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">chrs</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">buf_input</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rests</span>[<span class="ruby-number">0</span>, <span class="ruby-identifier">chrs</span>.<span class="ruby-identifier">size</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">chrs</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-peek_match-3F">
            
              <a name="method-i-peek_match-3F"></a><b>peek_match?</b>(regexp)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-peek_match-3F_source')" id="l_method-i-peek_match-3F_source">show</a>
                
              </p>
              <div id="method-i-peek_match-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 172</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">peek_match?</span>(<span class="ruby-identifier">regexp</span>)
  <span class="ruby-keyword">while</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">buf_input</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">regexp</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;&quot;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-prompt">
            
              <a name="method-i-prompt"></a><b>prompt</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-prompt_source')" id="l_method-i-prompt_source">show</a>
                
              </p>
              <div id="method-i-prompt_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 204</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">prompt</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@prompt</span>
    <span class="ruby-ivar">@prompt</span>.<span class="ruby-identifier">call</span>(<span class="ruby-ivar">@ltype</span>, <span class="ruby-ivar">@indent</span>, <span class="ruby-ivar">@continue</span>, <span class="ruby-ivar">@line_no</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-read_escape">
            
              <a name="method-i-read_escape"></a><b>read_escape</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-read_escape_source')" id="l_method-i-read_escape_source">show</a>
                
              </p>
              <div id="method-i-read_escape_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 1139</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">read_escape</span>
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\n&quot;</span>, <span class="ruby-string">&quot;\r&quot;</span>, <span class="ruby-string">&quot;\f&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\\&quot;</span>, <span class="ruby-string">&quot;n&quot;</span>, <span class="ruby-string">&quot;t&quot;</span>, <span class="ruby-string">&quot;r&quot;</span>, <span class="ruby-string">&quot;f&quot;</span>, <span class="ruby-string">&quot;v&quot;</span>, <span class="ruby-string">&quot;a&quot;</span>, <span class="ruby-string">&quot;e&quot;</span>, <span class="ruby-string">&quot;b&quot;</span>, <span class="ruby-string">&quot;s&quot;</span> <span class="ruby-comment">#&quot;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[0-7]/</span>
    <span class="ruby-identifier">ungetc</span> <span class="ruby-identifier">ch</span>
    <span class="ruby-number">3</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
      <span class="ruby-keyword">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[0-7]/</span>
      <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;x&quot;</span>
    <span class="ruby-number">2</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
      <span class="ruby-keyword">case</span> <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>
      <span class="ruby-keyword">when</span> <span class="ruby-regexp">/[0-9a-fA-F]/</span>
      <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ungetc</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;M&quot;</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">!=</span> <span class="ruby-string">'-'</span>
      <span class="ruby-identifier">ungetc</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\\&quot;</span> <span class="ruby-comment">#&quot;</span>
        <span class="ruby-identifier">read_escape</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;C&quot;</span>, <span class="ruby-string">&quot;c&quot;</span> <span class="ruby-comment">#, &quot;^&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ch</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;C&quot;</span> <span class="ruby-keyword">and</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;-&quot;</span>
      <span class="ruby-identifier">ungetc</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">ch</span> = <span class="ruby-identifier">getc</span>) <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\\&quot;</span> <span class="ruby-comment">#&quot;</span>
      <span class="ruby-identifier">read_escape</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># other characters</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-set_input">
            
              <a name="method-i-set_input"></a><b>set_input</b>(io, p = nil, &amp;block)
            
          </div>
          
          
            <div class="description">
              <p>io functions</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-set_input_source')" id="l_method-i-set_input_source">show</a>
                
              </p>
              <div id="method-i-set_input_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">set_input</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">p</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@io</span> = <span class="ruby-identifier">io</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:call</span>)
    <span class="ruby-ivar">@input</span> = <span class="ruby-identifier">p</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-ivar">@input</span> = <span class="ruby-identifier">block</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@input</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{<span class="ruby-ivar">@io</span>.<span class="ruby-identifier">gets</span>}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-set_prompt">
            
              <a name="method-i-set_prompt"></a><b>set_prompt</b>(p = nil, &amp;block)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-set_prompt_source')" id="l_method-i-set_prompt_source">show</a>
                
              </p>
              <div id="method-i-set_prompt_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 195</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">set_prompt</span>(<span class="ruby-identifier">p</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">p</span> = <span class="ruby-identifier">block</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:call</span>)
    <span class="ruby-ivar">@prompt</span> = <span class="ruby-identifier">p</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@prompt</span> = <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{<span class="ruby-identifier">print</span> <span class="ruby-identifier">p</span>}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-token">
            
              <a name="method-i-token"></a><b>token</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-token_source')" id="l_method-i-token_source">show</a>
                
              </p>
              <div id="method-i-token_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 278</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">token</span>
  <span class="ruby-comment">#      require &quot;tracer&quot;</span>
  <span class="ruby-comment">#      Tracer.on</span>
  <span class="ruby-ivar">@prev_seek</span> = <span class="ruby-ivar">@seek</span>
  <span class="ruby-ivar">@prev_line_no</span> = <span class="ruby-ivar">@line_no</span>
  <span class="ruby-ivar">@prev_char_no</span> = <span class="ruby-ivar">@char_no</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">tk</span> = <span class="ruby-ivar">@OP</span>.<span class="ruby-identifier">match</span>(<span class="ruby-keyword">self</span>)
      <span class="ruby-ivar">@space_seen</span> = <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkSPACE</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">SyntaxError</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@exception_on_syntax_error</span>
      <span class="ruby-identifier">tk</span> = <span class="ruby-constant">TkError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@seek</span>, <span class="ruby-ivar">@line_no</span>, <span class="ruby-ivar">@char_no</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span> <span class="ruby-ivar">@skip_space</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">tk</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">TkSPACE</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@readed_auto_clean_up</span>
    <span class="ruby-identifier">get_readed</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment">#      Tracer.off</span>
  <span class="ruby-identifier">tk</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ungetc">
            
              <a name="method-i-ungetc"></a><b>ungetc</b>(c = nil)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ungetc_source')" id="l_method-i-ungetc_source">show</a>
                
              </p>
              <div id="method-i-ungetc_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/irb/ruby-lex.rb, line 143</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ungetc</span>(<span class="ruby-identifier">c</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">c2</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">pop</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">c2</span> = <span class="ruby-ivar">@here_readed</span>.<span class="ruby-identifier">pop</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">c2</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">c</span>
  <span class="ruby-ivar">@rests</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">c</span> <span class="ruby-comment">#c =</span>
  <span class="ruby-ivar">@seek</span> <span class="ruby-operator">-=</span> <span class="ruby-number">1</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span>
    <span class="ruby-ivar">@line_no</span> <span class="ruby-operator">-=</span> <span class="ruby-number">1</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">idx</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">index</span>(<span class="ruby-string">&quot;\n&quot;</span>)
      <span class="ruby-ivar">@char_no</span> = <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">idx</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@char_no</span> = <span class="ruby-ivar">@base_char_no</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@readed</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@char_no</span> <span class="ruby-operator">-=</span> <span class="ruby-number">1</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    