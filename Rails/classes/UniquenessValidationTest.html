<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>UniquenessValidationTest</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            UniquenessValidationTest 
            
                <span class="parent">&lt; 
                    
                    ActiveRecord::TestCase
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/rails/activerecord/test/cases/validations/uniqueness_validation_test_rb.html">rails/activerecord/test/cases/validations/uniqueness_validation_test.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-test_validate_case_insensitive_uniqueness">test_validate_case_insensitive_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars">test_validate_case_insensitive_uniqueness_with_special_sql_like_chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_sensitive_uniqueness">test_validate_case_sensitive_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars">test_validate_case_sensitive_uniqueness_with_special_sql_like_chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_straight_inheritance_uniqueness">test_validate_straight_inheritance_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness">test_validate_uniqueness</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_scoped_to_defining_class">test_validate_uniqueness_scoped_to_defining_class</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords">test_validate_uniqueness_with_columns_which_are_sql_keywords</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_limit">test_validate_uniqueness_with_limit</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_limit_and_utf8">test_validate_uniqueness_with_limit_and_utf8</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_non_standard_table_names">test_validate_uniqueness_with_non_standard_table_names</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_scope">test_validate_uniqueness_with_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validate_uniqueness_with_scope_array">test_validate_uniqueness_with_scope_array</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_inside_with_scope">test_validates_uniqueness_inside_with_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_with_newline_chars">test_validates_uniqueness_with_newline_chars</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_validates_uniqueness_with_validates">test_validates_uniqueness_with_validates</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
        
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_insensitive_uniqueness">
            
              <a name="method-i-test_validate_case_insensitive_uniqueness"></a><b>test_validate_case_insensitive_uniqueness</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_insensitive_uniqueness_source')" id="l_method-i-test_validate_case_insensitive_uniqueness_source">show</a>
                
              </p>
              <div id="method-i-test_validate_case_insensitive_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_insensitive_uniqueness</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:parent_id</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>, <span class="ruby-value">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;Remaining unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should still save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm UNIQUE!&quot;</span>, <span class="ruby-value">:parent_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn't save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">any?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">any?</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-string">&quot;I'm truly UNIQUE!&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn't save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">any?</span>

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-number">4</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should now save t2 as unique&quot;</span>

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">parent_id</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;should validate with nil&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;should save with nil&quot;</span>

  <span class="ruby-identifier">with_kcode</span>(<span class="ruby-string">'UTF8'</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">t_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Я тоже уникальный!&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t_utf8 as unique&quot;</span>

    <span class="ruby-comment"># If database hasn't UTF-8 character set, this test fails</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">t_utf8</span>, <span class="ruby-value">:select</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'LOWER(title) AS title'</span>).<span class="ruby-identifier">title</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;я тоже уникальный!&quot;</span>
      <span class="ruby-identifier">t2_utf8</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;я тоже УНИКАЛЬНЫЙ!&quot;</span>)
      <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn't be valid&quot;</span>
      <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2_utf8</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn't save t2_utf8 as unique&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars">
            
              <a name="method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars"></a><b>test_validate_case_insensitive_uniqueness_with_special_sql_like_chars</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars_source')" id="l_method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars_source">show</a>
                
              </p>
              <div id="method-i-test_validate_case_insensitive_uniqueness_with_special_sql_like_chars_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 177</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_insensitive_uniqueness_with_special_sql_like_chars</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm %&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm uniqu_!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t3 as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_sensitive_uniqueness">
            
              <a name="method-i-test_validate_case_sensitive_uniqueness"></a><b>test_validate_case_sensitive_uniqueness</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_sensitive_uniqueness_source')" id="l_method-i-test_validate_case_sensitive_uniqueness_source">show</a>
                
              </p>
              <div id="method-i-test_validate_case_sensitive_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_sensitive_uniqueness</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;Remaining unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should still save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'M UNIQUE!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Should be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert_not_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'M uNiQUe!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Should be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:parent_id</span>].<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert_not_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer">
            
              <a name="method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer"></a><b>test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer_source')" id="l_method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer_source">show</a>
                
              </p>
              <div id="method-i-test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_sensitive_uniqueness_with_attribute_passed_as_integer</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitve</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-string">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">101</span>)

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">101</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars">
            
              <a name="method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars"></a><b>test_validate_case_sensitive_uniqueness_with_special_sql_like_chars</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars_source')" id="l_method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars_source">show</a>
                
              </p>
              <div id="method-i-test_validate_case_sensitive_uniqueness_with_special_sql_like_chars_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 164</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_case_sensitive_uniqueness_with_special_sql_like_chars</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm %&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t2 as unique&quot;</span>

  <span class="ruby-identifier">t3</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm uniqu_!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t3 as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_straight_inheritance_uniqueness">
            
              <a name="method-i-test_validate_straight_inheritance_uniqueness"></a><b>test_validate_straight_inheritance_uniqueness</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_straight_inheritance_uniqueness_source')" id="l_method-i-test_validate_straight_inheritance_uniqueness_source">show</a>
                
              </p>
              <div id="method-i-test_validate_straight_inheritance_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 267</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_straight_inheritance_uniqueness</span>
  <span class="ruby-identifier">w1</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Rincewind&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ankh-Morpork&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving w1&quot;</span>

  <span class="ruby-comment"># Should use validation from base class (which is abstract)</span>
  <span class="ruby-identifier">w2</span> = <span class="ruby-constant">IneptWizard</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Rincewind&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w2 shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for name&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>], <span class="ruby-string">&quot;Should have uniqueness message for name&quot;</span>

  <span class="ruby-identifier">w3</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Rincewind&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w3 shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for name&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w3</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>], <span class="ruby-string">&quot;Should have uniqueness message for name&quot;</span>

  <span class="ruby-identifier">w4</span> = <span class="ruby-constant">Conjurer</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w4</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving w4&quot;</span>

  <span class="ruby-identifier">w5</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;The Amazing Bonko&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Lancre&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w5</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w5 shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for name&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w5</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:name</span>], <span class="ruby-string">&quot;Should have uniqueness message for name&quot;</span>

  <span class="ruby-identifier">w6</span> = <span class="ruby-constant">Thaumaturgist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Mustrum Ridcully&quot;</span>, <span class="ruby-value">:city</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Quirm&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">w6</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;w6 shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:city</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should have errors for city&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">w6</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:city</span>], <span class="ruby-string">&quot;Should have uniqueness message for city&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness">
            
              <a name="method-i-test_validate_uniqueness"></a><b>test_validate_uniqueness</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_source')" id="l_method-i-test_validate_uniqueness_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 29</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm uniqué!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>

  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;Remaining unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should still save t as unique&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm uniqué!&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Shouldn't be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Shouldn't save t2 as unique&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;has already been taken&quot;</span>], <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]

  <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">title</span> = <span class="ruby-string">&quot;Now Im really also unique&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should now save t2 as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_scoped_to_defining_class">
            
              <a name="method-i-test_validate_uniqueness_scoped_to_defining_class"></a><b>test_validate_uniqueness_scoped_to_defining_class</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_scoped_to_defining_class_source')" id="l_method-i-test_validate_uniqueness_scoped_to_defining_class_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_scoped_to_defining_class_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_scoped_to_defining_class</span>
  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;What, me worry?&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a barrel of fun&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">silly_unique_replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a barrel of fun&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2&quot;</span>

  <span class="ruby-comment"># Should succeed as validates_uniqueness_of only applies to</span>
  <span class="ruby-comment"># UniqueReply and its subclasses</span>
  <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;a barrel of fun&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r3&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords">
            
              <a name="method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords"></a><b>test_validate_uniqueness_with_columns_which_are_sql_keywords</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords_source')" id="l_method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_columns_which_are_sql_keywords_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_columns_which_are_sql_keywords</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Guid</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-value">:key</span>
    <span class="ruby-identifier">g</span> = <span class="ruby-constant">Guid</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-identifier">g</span>.<span class="ruby-identifier">key</span> = <span class="ruby-string">&quot;foo&quot;</span>
    <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-operator">!</span><span class="ruby-identifier">g</span>.<span class="ruby-identifier">valid?</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_limit">
            
              <a name="method-i-test_validate_uniqueness_with_limit"></a><b>test_validate_uniqueness_with_limit</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_limit_source')" id="l_method-i-test_validate_uniqueness_with_limit_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_limit_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_limit</span>
  <span class="ruby-comment"># Event.title is limited to 5 characters</span>
  <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;abcde&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Could not create an event with a unique, 5 character title&quot;</span>
  <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;abcdefgh&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_limit_and_utf8">
            
              <a name="method-i-test_validate_uniqueness_with_limit_and_utf8"></a><b>test_validate_uniqueness_with_limit_and_utf8</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_limit_and_utf8_source')" id="l_method-i-test_validate_uniqueness_with_limit_and_utf8_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_limit_and_utf8_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_limit_and_utf8</span>
  <span class="ruby-identifier">with_kcode</span>(<span class="ruby-string">'UTF8'</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># Event.title is limited to 5 characters</span>
    <span class="ruby-identifier">e1</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;一二三四五&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">e1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Could not create an event with a unique, 5 character title&quot;</span>
    <span class="ruby-identifier">e2</span> = <span class="ruby-constant">Event</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;一二三四五六七八&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Created an event whose title, with limit taken into account, is not unique&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_non_standard_table_names">
            
              <a name="method-i-test_validate_uniqueness_with_non_standard_table_names"></a><b>test_validate_uniqueness_with_non_standard_table_names</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_non_standard_table_names_source')" id="l_method-i-test_validate_uniqueness_with_non_standard_table_names_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_non_standard_table_names_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 223</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_non_standard_table_names</span>
  <span class="ruby-identifier">i1</span> = <span class="ruby-constant">WarehouseThing</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:value</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1000</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">i1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;i1 should not be valid&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">i1</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:value</span>].<span class="ruby-identifier">any?</span>, <span class="ruby-string">&quot;Should not be empty&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_scope">
            
              <a name="method-i-test_validate_uniqueness_with_scope"></a><b>test_validate_uniqueness_with_scope</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_scope_source')" id="l_method-i-test_validate_uniqueness_with_scope_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_scope</span>
  <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:content</span>, <span class="ruby-value">:scope</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;parent_id&quot;</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r1&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r2&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2 first time&quot;</span>

  <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">content</span> = <span class="ruby-string">&quot;something else&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r2 second time&quot;</span>

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique too!&quot;</span>)
  <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;r3&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;hello world&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r3&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validate_uniqueness_with_scope_array">
            
              <a name="method-i-test_validate_uniqueness_with_scope_array"></a><b>test_validate_uniqueness_with_scope_array</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validate_uniqueness_with_scope_array_source')" id="l_method-i-test_validate_uniqueness_with_scope_array_source">show</a>
                
              </p>
              <div id="method-i-test_validate_uniqueness_with_scope_array_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validate_uniqueness_with_scope_array</span>
  <span class="ruby-constant">Reply</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:author_name</span>, <span class="ruby-value">:scope</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value">:author_email_address</span>, <span class="ruby-value">:parent_id</span>])

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;The earth is actually flat!&quot;</span>)

  <span class="ruby-identifier">r1</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy&quot;</span>, <span class="ruby-string">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You're crazy!&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Crazy reply&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r1</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r1&quot;</span>

  <span class="ruby-identifier">r2</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy&quot;</span>, <span class="ruby-string">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy@rubyonrails.com&quot;</span>, <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You're crazy!&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Crazy reply again...&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r2</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r2. Double reply by same author.&quot;</span>

  <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">author_email_address</span> = <span class="ruby-string">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r2</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r2 the second time.&quot;</span>

  <span class="ruby-identifier">r3</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">replies</span>.<span class="ruby-identifier">create</span> <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy&quot;</span>, <span class="ruby-string">&quot;author_email_address&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;jeremy_alt_email@rubyonrails.com&quot;</span>, <span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;You're wrong&quot;</span>, <span class="ruby-string">&quot;content&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;It's cubic&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">valid?</span>, <span class="ruby-string">&quot;Saving r3&quot;</span>

  <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-string">&quot;jj&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r3 the second time.&quot;</span>

  <span class="ruby-identifier">r3</span>.<span class="ruby-identifier">author_name</span> = <span class="ruby-string">&quot;jeremy&quot;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">r3</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Saving r3 the third time.&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_inside_with_scope">
            
              <a name="method-i-test_validates_uniqueness_inside_with_scope"></a><b>test_validates_uniqueness_inside_with_scope</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_inside_with_scope_source')" id="l_method-i-test_validates_uniqueness_inside_with_scope_source">show</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_inside_with_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_inside_with_scope</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>)

  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:with_scope</span>, <span class="ruby-value">:find</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-value">:author_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span> } }) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">t1</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>, <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Mary&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t1</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I'm unique!&quot;</span>, <span class="ruby-string">&quot;author_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_with_newline_chars">
            
              <a name="method-i-test_validates_uniqueness_with_newline_chars"></a><b>test_validates_uniqueness_with_newline_chars</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_with_newline_chars_source')" id="l_method-i-test_validates_uniqueness_with_newline_chars_source">show</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_with_newline_chars_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_with_newline_chars</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates_uniqueness_of</span>(<span class="ruby-value">:title</span>, <span class="ruby-value">:case_sensitive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;title&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;new\nline&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">save</span>, <span class="ruby-string">&quot;Should save t as unique&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_validates_uniqueness_with_validates">
            
              <a name="method-i-test_validates_uniqueness_with_validates"></a><b>test_validates_uniqueness_with_validates</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_validates_uniqueness_with_validates_source')" id="l_method-i-test_validates_uniqueness_with_validates_source">show</a>
                
              </p>
              <div id="method-i-test_validates_uniqueness_with_validates_source" class="dyn-source">
                <pre><span class="ruby-comment"># File rails/activerecord/test/cases/validations/uniqueness_validation_test.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_validates_uniqueness_with_validates</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">validates</span> <span class="ruby-value">:title</span>, <span class="ruby-value">:uniqueness</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
  <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-string">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'abc'</span>)

  <span class="ruby-identifier">t2</span> = <span class="ruby-constant">Topic</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'abc'</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">t2</span>.<span class="ruby-identifier">valid?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">t2</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:title</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    